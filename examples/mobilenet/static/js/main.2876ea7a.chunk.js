(this.webpackJsonpstyle=this.webpackJsonpstyle||[]).push([[0],{23:function(t,e,n){},25:function(t,e,n){},42:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"CPUTensor",(function(){return Y}));var o={};n.r(o),n.d(o,"GPUTensor",(function(){return Fe})),n.d(o,"gpuConstructor",(function(){return Ue}));var i={};n.r(i),n.d(i,"wasmLoaded",(function(){return jn})),n.d(i,"WASMTensor",(function(){return Tn}));var a={};n.r(a),n.d(a,"cpu",(function(){return r})),n.d(a,"gpu",(function(){return o})),n.d(a,"wasm",(function(){return i}));var u={};n.r(u),n.d(u,"OnnxModel",(function(){return Oi}));var s={};n.r(s),n.d(s,"model",(function(){return u}));var p=n(0),c=n(5),l=n.n(c),h=n(10),f=n.n(h),y=(n(23),n(2)),d=n.n(y),m=n(3),g=n(15),v=n(6),w=n(11),b=n(12),x=n(17),_=n(16);n(25);function O(t){if(0===t.length)return 0;for(var e=1,n=0;n<t.length;n+=1)e*=t[n];return e}function k(t){var e=t.length;if(0===e)return[];if(1===e)return 1===t[0]?[0]:[1];var n=new Array(e);n[e-1]=1,1===t[e-1]&&(n[e-1]=0);for(var r=1,o=e-2;o>=0;o-=1)r=t[o+1]*r,1===t[o]?n[o]=0:n[o]=r;return n}function A(t,e,n){for(var r=0,o=0;o<t.length;o+=1){if(n&&(t[o]<0||t[o]>=n[o]&&1!==n[o]))throw new Error("Invalid index");r+=t[o]*e[o]}return r}function S(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0}function P(t,e){for(var n=t.length-1;n>=0&&(t[n]+=1,t[n]>=e[n]);n--)t[n]=0}var j=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},T=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},I=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},C=function(){function t(){}return t.prototype.compare=function(t,e){return j(this,void 0,void 0,(function(){var n,r,o;return T(this,(function(i){switch(i.label){case 0:return S(this.getShape(),t.getShape())?[4,this.getValues()]:[2,!1];case 1:return n=i.sent(),[4,t.getValues()];case 2:if(r=i.sent(),void 0!==e){for(o=0;o<n.length;o+=1)if(Math.abs(n[o]-r[o])>e)return[2,!1]}else for(o=0;o<n.length;o+=1)if(n[o]!==r[o])return[2,!1];return[2,!0]}}))}))},t.prototype.getAxes=function(t){var e,n=this.getShape();if(void 0===t){e=[];for(var r=0;r<n.length;r++)e.push(r)}else e=t instanceof Array?t:[t];return e},t.prototype.sum=function(t,e){var n=this.getAxes(t);return e=e||!1,this.sum_impl(n,e)},t.prototype.sumSquare=function(t,e){var n=this.getAxes(t);return e=e||!1,this.sumSquare_impl(n,e)},t.prototype.product=function(t,e){var n=this.getAxes(t);return e=e||!1,this.product_impl(n,e)},t.prototype.max=function(t,e){var n=this.getAxes(t);return e=e||!1,this.max_impl(n,e)},t.prototype.min=function(t,e){var n=this.getAxes(t);return e=e||!1,this.min_impl(n,e)},t.prototype.reduceMean=function(t,e){var n=this.getAxes(t);return e=e||!1,this.reduceMean_impl(n,e)},t.prototype.reduceMeanSquare=function(t,e){var n=this.getAxes(t);return e=e||!1,this.reduceMeanSquare_impl(n,e)},t.prototype.conv=function(t,e,n,r,o,i,a){var u=this.getShape().length-2;return n=n||new Array(u).fill(1),r=r||1,o=o||new Array(2*u).fill(0),i=i||new Array(u).fill(1),void 0===a&&(a="id"),this.conv_impl(t,n,r,o,i,e,a)},t.prototype.pad=function(t,e,n){return void 0===e&&(e="constant"),void 0===n&&(n=0),this.pad_impl(t,e,n)},t.prototype.averagePool=function(t,e,n,r){var o=this.getShape().length-2;return e=e||new Array(2*o).fill(0),n=n||new Array(o).fill(1),r=r||!1,this.averagePool_impl(t,e,n,r)},t.prototype.reshape=function(t,e){for(var n=1,r=-1,o=0;o<t.length;o++)-1===t[o]?r=o:n*=t[o];if(void 0===e&&(e=!0),-1!==r){var i=O(this.getShape()),a=I(t);return a[r]=i/n,this.reshape_impl(a,e)}return this.reshape_impl(t,e)},t.prototype.alignShapes=function(t,e){var n,r;if(S(t,e))return[t,e,t];if(t.length<e.length){t=I(t);var o=e.length-t.length;(n=t).unshift.apply(n,new Array(o).fill(1))}else if(e.length<t.length){e=I(e);o=t.length-e.length;(r=e).unshift.apply(r,new Array(o).fill(1))}for(var i=new Array(t.length).fill(1),a=0;a<t.length;a++)i[a]=Math.max(t[a],e[a]);return[t,e,i]},t.prototype.alignTensor=function(t){var e,n,r=this.getShape(),o=t.getShape();if(S(r,o))return[this,t,r];var i=this;if(r.length<o.length){r=I(r);var a=o.length-r.length;(e=r).unshift.apply(e,new Array(a).fill(1)),i=this.reshape(r,!1)}else if(o.length<r.length){o=I(o);a=r.length-o.length;(n=o).unshift.apply(n,new Array(a).fill(1)),t=t.reshape(o,!1)}for(var u=new Array(r.length).fill(1),s=0;s<r.length;s++)u[s]=Math.max(r[s],o[s]);return[i,t,u]},t.prototype.add=function(t){var e=this.alignTensor(t),n=e[0],r=e[1],o=e[2];return this.add_impl(n,r,o)},t.prototype.subtract=function(t){var e=this.alignTensor(t),n=e[0],r=e[1],o=e[2];return this.subtract_impl(n,r,o)},t.prototype.multiply=function(t){var e=this.alignTensor(t),n=e[0],r=e[1],o=e[2];return this.multiply_impl(n,r,o)},t.prototype.divide=function(t){var e=this.alignTensor(t),n=e[0],r=e[1],o=e[2];return this.divide_impl(n,r,o)},t.prototype.power=function(t){var e=this.alignTensor(t),n=e[0],r=e[1],o=e[2];return this.power_impl(n,r,o)},t.prototype.transpose=function(t){if(void 0===t){var e=this.getShape().length;t=[];for(var n=0;n<e;n++)t.push(e-n-1)}return this.transpose_impl(t)},t.prototype.softmax=function(t){var e=this.max(t,!0),n=this.subtract(e),r=n.exp(),o=r.sum(t,!0),i=r.divide(o);return e.delete(),n.delete(),r.delete(),o.delete(),i},t.prototype.gemm=function(t,e,n,r,o,i){if(e=e||!1,n=n||!1,r=void 0!==r?r:1,i=void 0!==i?i:1,void 0!==o){var a=this.getShape(),u=o.getShape(),s=a.length,p=u.length;u=I(new Array(s-p).fill(1),u),o=o.reshape(u,!1)}return this.gemm_impl(t,e,n,r,i,o)},t.prototype.slice=function(t,e,n){var r=this.getShape(),o=r.length;if(void 0===n){n=[];for(var i=0;i<o;i++)n.push(i)}t=I(t),e=I(e);for(i=0;i<n.length;i++){var a=r[n[i]];t[i]<0?t[i]+=a:t[i]>=a&&(t[i]=a),e[i]<0?e[i]+=a:e[i]>=a&&(e[i]=a)}return this.slice_impl(t,e,n)},t}();function M(t,e,n,r,o,i){var a=o*(e-1)+1;return Math.floor((t+n+r-a)/i+1)}function B(t,e,n,r,o,i){for(var a=[],u=0;u<t.length;u++)a.push(M(t[u],e[u],n[u],r[u],o[u],i[u]));return a}function X(t,e){for(var n=new Y(t.shape),r=0;r<n.size;r+=1)n.set(r,e(t.get(r)));return n}function R(t,e,n,r){if(!function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n]&&1!==t[n]&&1!==e[n])return!1;return!0}(t.shape,e.shape))throw new Error("The shapes of the two tensors should be the same for a binary operation");for(var o=new Y(r),i=new Array(r.length).fill(0),a=0;a<o.size;a+=1)o.set(i,n(t.get(i),e.get(i))),P(i,r);return o}var V=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var D=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var E=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function z(t,e,n){for(var r=[],o=[],i=[],a=0;a<t.length;a++)e.includes(a)?(n&&(r.push(1),i.push(a)),o.push(t[a])):(r.push(t[a]),i.push(a));return 0===r.length&&r.push(1),[r,i]}function G(t,e,n,r,o){for(var i=t.getShape(),a=O(i),u=z(i,e,r),s=u[0],p=u[1],c=O(s),l=k(s),h=new Y(s),f=new Array(c).fill(!1),y=new Array(i.length).fill(0),d=new Array(s.length).fill(0),m=0;m<a;m++){for(var g=0;g<p.length;g++)d[g]=y[p[g]];var v=A(d,l);f[v]?h.set(d,n(t.get(m),h.get(d))):(f[v]=!0,h.set(d,n(t.get(m)))),P(y,i)}if(o)for(m=0;m<h.size;m++)h.set(m,o(h.get(m)));return h}var F=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var U=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function W(t,e,n,r,o){if(o)return t.get(e);var i=t.shape.length;if("constant"===n)return r;if("edge"===n)for(var a=0;a<i;a++)e[a]<0?e[a]=0:e[a]>=t.shape[a]&&(e[a]=t.shape[a]-1);else for(a=0;a<i;a++)e[a]<0?e[a]=-e[a]:e[a]>=t.shape[a]&&(e[a]=2*t.shape[a]-e[a]-2);return t.get(e)}var N=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var L=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var H=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),q=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},J=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},K=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Y=function(t){function e(e,n,r){var o=t.call(this)||this;return o.deleted=!1,o.shape=e,o.strides=k(e),o.size=O(e),void 0!==n?n instanceof Float32Array||n instanceof Int32Array?(o.values=n,o.type=n instanceof Float32Array?"float":"int"):"int"===r?(o.values=Int32Array.from(n),o.type="int"):null===n?o.values=null:(o.values=Float32Array.from(n),o.type="float"):"int"===r?(o.values=new Int32Array(o.size),o.type="int"):(o.values=new Float32Array(o.size),o.type="float"),o}return H(e,t),e.prototype.getValues=function(){return Promise.resolve(this.values)},e.prototype.getShape=function(){return this.shape},e.prototype.cpu=function(){return q(this,void 0,void 0,(function(){return J(this,(function(t){return[2,this]}))}))},e.prototype.delete=function(){this.values=void 0,this.deleted=!0},e.prototype.copy=function(t){void 0===t&&(t=K(this.shape));for(var n=new Float32Array(this.size),r=0;r<this.size;r++)n[r]=this.values[r];return new e(t,n)},e.prototype.get=function(t){var e;return e=Array.isArray(t)?A(t,this.strides,this.shape):t,this.values[e]},e.prototype.set=function(t,e){var n;n=Array.isArray(t)?A(t,this.strides):t,this.values[n]=e},e.prototype.exp=function(){return X(this,(function(t){return Math.exp(t)}))},e.prototype.log=function(){return X(this,(function(t){return Math.log(t)}))},e.prototype.sqrt=function(){return X(this,(function(t){return Math.sqrt(t)}))},e.prototype.abs=function(){return X(this,(function(t){return Math.abs(t)}))},e.prototype.floor=function(){return X(this,(function(t){return Math.floor(t)}))},e.prototype.ceil=function(){return X(this,(function(t){return Math.ceil(t)}))},e.prototype.clip=function(t,e){return function(t,e,n){var r=function(t){return t};return void 0!==e&&void 0!==n?r=function(t){return Math.min(n,Math.max(e,t))}:void 0!==n?r=function(t){return Math.min(n,t)}:void 0!==e&&(r=function(t){return Math.max(e,t)}),X(t,r)}(this,t,e)},e.prototype.add_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,e,n){return R(t,e,(function(t,e){return t+e}),n)}(t,n,r)},e.prototype.subtract_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only subtract CPU tensor to CPU tensor");return function(t,e,n){return R(t,e,(function(t,e){return t-e}),n)}(t,n,r)},e.prototype.multiply_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,e,n){return R(t,e,(function(t,e){return t*e}),n)}(t,n,r)},e.prototype.divide_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,e,n){return R(t,e,(function(t,e){return t/e}),n)}(t,n,r)},e.prototype.power_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only take CPU tensor to power of CPU tensor");return function(t,e,n){return R(t,e,(function(t,e){return Math.pow(t,e)}),n)}(t,n,r)},e.prototype.matMul=function(t){if(!(t instanceof e))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,e){if(2!==t.shape.length||2!==e.shape.length)throw new Error("Matmul expects both operands to have rank 2");if(t.shape[1]!==e.shape[0])throw new Error("Matmul expects dimension 1 of operand 1 to equal dimension 0 of operand 2");for(var n=t.shape[0],r=t.shape[1],o=e.shape[1],i=new Y([n,o]),a=0;a<n;a+=1)for(var u=0;u<o;u+=1){for(var s=0,p=0;p<r;p+=1)s+=t.get([a,p])*e.get([p,u]);i.set([a,u],s)}return i}(this,t)},e.prototype.gemm_impl=function(t,n,r,o,i,a){if(!(t instanceof e&&(void 0===a||a instanceof e)))throw new Error("Can only do gemm with CPU tensors");return function(t,e,n,r,o,i,a){var u=t.shape.length,s=n?t.shape[u-1]:t.shape[u-2],p=n?t.shape[u-2]:t.shape[u-1],c=r?e.shape[u-2]:e.shape[u-1],l=s*p,h=p*c,f=s*c,y=n?s:1,d=n?1:p,m=r?1:c,g=r?p:1,v=0,w=0,b=0;void 0!==a&&(v=a.strides[u-2],w=a.strides[u-1],O(a.shape.slice(0,u-2))>1?1===(b=a.shape[u-2]*a.shape[u-1])&&(b=0):b=0);var x=t.shape.slice(0,u-2),_=O(x);0===_&&(_=1);for(var k=E(x,[s,c]),A=new Y(k),S=0;S<_;S++)for(var P=S*l,j=S*h,T=S*f,I=S*b,C=0;C<s;C++)for(var M=0;M<c;M++){for(var B=0,X=0;X<p;X++)B+=t.get(P+C*d+X*y)*e.get(j+X*m+M*g);B*=o,void 0!==a&&(B+=i*a.get(I+C*v+M*w)),A.set(T+C*c+M,B)}return A}(this,t,n,r,o,i,a)},e.prototype.sum_impl=function(t,e){return function(t,e,n){return G(t,e,(function(t,e){return t+(void 0!==e?e:0)}),n)}(this,t,e)},e.prototype.sumSquare_impl=function(t,e){return function(t,e,n){return G(t,e,(function(t,e){return t*t+(void 0!==e?e:0)}),n)}(this,t,e)},e.prototype.product_impl=function(t,e){return function(t,e,n){return G(t,e,(function(t,e){return t*(void 0!==e?e:1)}),n)}(this,t,e)},e.prototype.max_impl=function(t,e){return function(t,e,n){return G(t,e,(function(t,e){return Math.max(t,void 0!==e?e:t)}),n)}(this,t,e)},e.prototype.min_impl=function(t,e){return function(t,e,n){return G(t,e,(function(t,e){return Math.min(t,void 0!==e?e:t)}),n)}(this,t,e)},e.prototype.reduceMean_impl=function(t,e){return function(t,e,n){for(var r=1,o=0;o<e.length;o++)r*=t.shape[e[o]];return G(t,e,(function(t,e){return t+(void 0!==e?e:0)}),n,(function(t){return t/r}))}(this,t,e)},e.prototype.reduceMeanSquare_impl=function(t,e){return function(t,e,n){for(var r=1,o=0;o<e.length;o++)r*=t.shape[e[o]];return G(t,e,(function(t,e){return t*t+(void 0!==e?e:0)}),n,(function(t){return t/r}))}(this,t,e)},e.prototype.conv_impl=function(t,n,r,o,i,a){if(!(t instanceof e)||void 0!==a&&!(a instanceof e))throw new Error("Can only do convolution of CPU tensor with CPU tensor");return function(t,e,n,r,o,i,a){var u=t.shape[0],s=t.shape[1],p=t.shape.slice(2),c=e.shape.slice(2),l=e.shape[0],h=s/r,f=O(c),y=B(p,c,o.slice(0,o.length/2),o.slice(o.length/2),n,i),d=O(y),m=[u,l];m=m.concat(y);for(var g=new Y(m),v=y.length,w=0;w<u;w++)for(var b=0;b<l;b++){if(a){var x=a?a.get([b]):0;(A=new Array(y.length).fill(0)).unshift(w,b);for(var _=0;_<d;_++)g.set(A,x),P(A,g.shape)}for(var k=0;k<h;k++){var A,S=(b*h+k)%s;for((A=new Array(y.length).fill(0)).unshift(w,b),_=0;_<d;_++){var j=g.get(A),T=new Array(y.length).fill(0);T.unshift(b,k);for(var I=0;I<f;I++){for(var C=[w,S],M=!1,X=0;X<v;X++){var R=0===i.length?1:i[X],V=0===o.length?0:o[X],D=0===n.length?1:n[X],E=A[X+2]*R-V+T[X+2]*D;if(E<0||E>=p[X]){M=!0;break}C.push(E)}M||(j+=e.get(T)*t.get(C)),P(T,e.shape)}g.set(A,j),P(A,g.shape)}}}return g}(this,t,n,r,o,i,a)},e.prototype.pad_impl=function(t,e,n){return function(t,e,n,r){for(var o=t.shape.length,i=U(t.shape),a=0;a<o;a++)i[a]+=e[a]+e[a+o];var u=new Y(i),s=new Array(o).fill(0),p=new Array(o).fill(0);for(a=0;a<u.size;a++){for(var c=!0,l=0;l<o;l++)p[l]=s[l]-e[l],(p[l]<0||p[l]>=t.shape[l])&&(c=!1);u.set(a,W(t,p,n,r,c)),P(s,i)}return u}(this,t,e,n)},e.prototype.averagePool_impl=function(t,e,n,r){return function(t,e,n,r,o){var i=t.shape[0],a=t.shape[1],u=t.shape.slice(2),s=u.length,p=O(e),c=B(u,e,n.slice(0,n.length/2),n.slice(n.length/2),new Array(s).fill(1),r),l=O(c),h=[i,a];h=h.concat(c);for(var f=new Y(h),y=0;y<i;y++)for(var d=0;d<a;d++){var m=new Array(c.length).fill(0);m.unshift(y,d);for(var g=0;g<l;g++){for(var v=0,w=new Array(c.length).fill(0),b=0,x=0;x<p;x++){for(var _=[y,d],k=!1,A=0;A<s;A++){var S=0===r.length?1:r[A],j=0===n.length?0:n[A],T=m[A+2]*S-j+w[A];if(T<0||T>=u[A]){k=!0;break}_.push(T)}k||(v+=t.get(_)),k&&!o||(b+=1),P(w,e)}v/=b,f.set(m,v),P(m,f.shape)}}return f}(this,t,e,n,r)},e.prototype.reshape_impl=function(t,n){return n?this.copy(t):new e(t,this.values,this.type)},e.prototype.concat=function(t,n){if(!(t instanceof e))throw new Error("Can only concat CPU tensor to CPU tensor");return function(t,e,n){var r=V(t.shape);r[n]+=e.shape[n];for(var o=new Y(r),i=0,a=0,u=0,s=o.strides[n]*t.shape[n],p=o.strides[n]*e.shape[n],c=o.size/(n>0?o.strides[n-1]:o.size),l=0;l<c;l++){for(var h=0;h<s;h++)o.set(u,t.get(i)),u++,i++;for(h=0;h<p;h++)o.set(u,e.get(a)),u++,a++}return o}(this,t,n)},e.prototype.transpose_impl=function(t){return function(t,e){for(var n=t.shape.length,r=new Array(n),o=new Array(n),i=0;i<n;i++)r[i]=t.shape[e[i]],o[e[i]]=i;var a=new Y(r),u=a.strides,s=new Array(n);for(i=0;i<n;i++)s[i]=u[o[i]];var p=new Array(n).fill(0);for(i=0;i<t.size;i++){for(var c=0,l=0;l<n;l++)c+=p[l]*s[l];a.set(c,t.get(i)),P(p,t.shape)}return a}(this,t)},e.prototype.repeat=function(t){return function(t,e){for(var n=t.shape.length,r=new Array(n),o=0;o<n;o++)r[o]=t.shape[o]*e[o];var i=new Y(r),a=new Array(n).fill(0);for(o=0;o<i.size;o++){for(var u=new Array(n),s=0;s<n;s++)u[s]=a[s]%t.shape[s];i.set(o,t.get(u)),P(a,i.shape)}return i}(this,t)},e.prototype.expand=function(t){var e=this.alignShapes(this.shape,t),n=e[0],r=(e[1],e[2]);return S(this.shape,r)?this.copy():function(t,e){for(var n=t.shape.length,r=new Y(e),o=new Array(n).fill(0),i=0;i<r.size;i++)r.set(i,t.get(o)),P(o,r.shape);return r}(this.reshape(n,!1),r)},e.prototype.gather=function(t,e){return function(t,e,n){for(var r=t.shape.length,o=n.shape.length,i=r+o-1,a=new Array(i),u=0;u<e;u++)a[u]=t.shape[u];for(u=0;u<o;u++)a[u+e]=n.shape[u];for(u=e+1;u<r;u++)a[u+o-1]=t.shape[u];var s,p,c=new Y(a,void 0,t.type),l=new Array(i).fill(0);for(u=0;u<c.size;u++){s=l.slice(e,e+o);var h=n.get(s);p=D(l.slice(0,e),[h],l.slice(e+o)),c.set(u,t.get(p)),P(l,a)}return c}(this,t,e)},e.prototype.slice_impl=function(t,e,n){return function(t,e,n,r){for(var o=t.shape.length,i=N(t.shape),a=0,u=0;u<o&&a<r.length;u++)u==r[a]&&(i[u]=n[a]-e[a],a++);var s,p=new Y(i,void 0,t.type),c=new Array(o).fill(0);for(u=0;u<p.size;u++){s=N(c);for(var l=0;l<r.length;l++)s[r[l]]+=e[l];p.set(u,t.get(s)),P(c,i)}return p}(this,t,e,n)},e.prototype.upsample=function(t){return function(t,e){for(var n=t.shape.length,r=L(t.shape),o=0;o<n;o++)r[o]=Math.floor(r[o]*e[o]);var i=new Y(r,void 0,t.type),a=new Array(n).fill(0),u=new Array(n);for(o=0;o<i.size;o++){for(var s=0;s<n;s++)u[s]=Math.floor(a[s]/e[s]);i.set(o,t.get(u)),P(a,r)}return i}(this,t)},e.prototype.normalize=function(t,n,r,o,i){if(!(t instanceof e)||!(n instanceof e)||!(o instanceof e)||!(i instanceof e))throw new Error("Can only normalize with CPU tensors");return function(t,e,n,r,o,i){for(var a=t.shape.length,u=F(t.shape),s=new Y(u,void 0,t.type),p=new Array(a).fill(0),c=0;c<s.size;c++){var l=(t.get(p)-e.get(p))/Math.sqrt(n.get(p)+r);l=l*o.get(p)+i.get(p),s.set(c,l),P(p,u)}return s}(this,t,n,r,o,i)},e}(C),Q=n(13),Z=n.n(Q),$=function(){function t(t){this.toNumber=t,this.dict={}}return t.prototype.betweenBoundsFirst=function(t){if(void 0!==t.gte){var e=this.toNumber(t.gte);return void 0!==this.dict[e]&&this.dict[e].length>0?[{key:t.gte,value:this.dict[e][this.dict[e].length-1]}]:[]}if(void 0!==t.lte){e=this.toNumber(t.lte);return void 0!==this.dict[e]&&this.dict[e].length>0?[{key:t.lte,value:this.dict[e][this.dict[e].length-1]}]:[]}return[]},t.prototype.deleteFirst=function(t){var e=this.toNumber(t);void 0!==this.dict[e]&&this.dict[e].pop()},t.prototype.insert=function(t,e){var n=this.toNumber(t);void 0===this.dict[n]&&(this.dict[n]=[]),this.dict[n].push(e)},t}();function tt(t){return et(t)}function et(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!0),!Number.isInteger(t))return e;var r=Math.abs(t);if(r<2)return e;var o=Math.sqrt(r),i=2;if(r%i&&r%(i=3)){i=5;for(var a=2;r%i&&i<o;)i+=a,a=6-a}(i=i<=o?i:r,n)?e.push(i):e.indexOf(i)<0&&e.push(i);return i===r?e:et(r/i,e,n)}var nt,rt,ot,it=function(){function t(t,e,n){this.trees={16:e(),32:e()},this.regl=t,this.entryId=0,this.maxSizeFactor=n||2}return t.prototype.allocate=function(t,e){var n=t*this.maxSizeFactor,r=4*Math.ceil(t/4);r<n&&(n=r);var o=this.trees[e].betweenBoundsFirst({gte:t,lte:n});if(0===o.length){var i=Math.ceil(t/4),a=this.getTextureDims(i),u=a.width,s=a.height;return{width:u,height:s,size:u*s*4,frameBuffer:this.regl.framebuffer({width:u,height:s,depthStencil:!1,colorFormat:"rgba",colorType:32===e?"float":"half float"}),id:this.entryId++,precision:e}}var p=o[0];return this.trees[e].deleteFirst(p.key),p.value},t.prototype.getAllocationDimensions=function(t,e){var n=t*this.maxSizeFactor,r=4*Math.ceil(t/4);r<n&&(n=r);var o=this.trees[e].betweenBoundsFirst({gte:t,lte:n});if(0===o.length){var i=Math.ceil(t/4);return this.getTextureDims(i)}var a=o[0];return{width:a.value.width,height:a.value.height}},t.prototype.deallocate=function(t){this.trees[t.precision].insert(t.size,t)},t.prototype.allocateTexture=function(t,e){for(var n=Math.ceil(t.length/4),r=this.getTextureDims(n),o=r.width,i=r.height,a=o*i*4,u=new Float32Array(a),s=0;s<t.length;s++)u[s]=t[s];for(s=t.length;s<a;s++)u[s]=0;var p=this.regl.texture({width:o,height:i,format:"rgba",type:32===e?"float":"half float",data:32===e?u:Array.from(u)});return{width:o,height:i,size:a,frameBuffer:this.regl.framebuffer({color:p,width:o,height:i,depthStencil:!1}),id:this.entryId++,precision:e}},t.prototype.allocateOfDimensions=function(t,e,n){var r=t*e*4,o=this.regl.texture({width:t,height:e,format:"rgba",type:32===n?"float":"half float"});return{width:t,height:e,size:r,frameBuffer:this.regl.framebuffer({color:o,width:t,height:e,depthStencil:!1}),id:this.entryId++,precision:n}},t.prototype.allocateFramebuffer=function(t,e){var n=this.regl.framebuffer({color:t,width:t.width,height:t.height,depthStencil:!1});return{width:t.width,height:t.height,size:t.width*t.height*4,frameBuffer:n,id:this.entryId++,precision:e}},t.prototype.getTextureDims=function(t){for(var e=tt(t),n=1,r=1,o=0;o<e.length;o+=2)n*=e[o],o+1<e.length&&(r*=e[o+1]);return{width:n,height:r}},t}(),at=document.createElement("canvas");nt=at.getContext("webgl",{failIfMajorPerformanceCaveat:!1}),rt=Z()({gl:nt,extensions:["OES_texture_float","WEBGL_color_buffer_float","OES_texture_half_float"]}),ot=new it(rt,(function(){return new $((function(t){return t}))}));var ut,st=function(){return(st=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},pt=function(){function t(t,e,n){this.statics=new Set,this.copyCounter=0,this.fullyStatic=!1,void 0===e&&(e=ot),void 0===n&&(n=10),this.allocator=e,this.maxRank=n,this.gpuTensorConstructor=t}return t.prototype.registerStatics=function(t){var e=0,n=0;for(var r in t)if(r.startsWith("shape")){var o=r.slice("shape".length);this.statics.add("shape"+o),this.statics.add("size"+o),this.statics.add("rank"+o),this.statics.add("strides"+o),e++}else this.statics.add(r),r.startsWith("width")||r.startsWith("height")||n++;e-1===this.getTextureNames().length&&n===this.getUniformAttrs().length&&(this.fullyStatic=!0,this.outputShape=t.shapeOutput)},t.prototype.getVarModifier=function(t){return this.statics.has(t)?"":"uniform"},t.prototype.pad=function(t,e){for(void 0===e&&(e=this.maxRank);t.length<e;)t.push(-1);return t},t.prototype.copyPad=function(t,e){void 0===e&&(e=this.maxRank);for(var n=Array.from(t);n.length<e;)n.push(-1);return n},t.prototype.getVariables=function(){return""},t.prototype.getVariableDeclarations=function(t){var e=this,n=this.getTextureNames();return n.push("Output"),"\n      "+n.map((function(t){return"\n        "+("Output"===t?"":"uniform sampler2D "+t+";")+"\n        "+e.getVarModifier("size"+t)+" int size"+t+";\n        "+e.getVarModifier("width"+t)+" int width"+t+";\n        "+e.getVarModifier("height"+t)+" int height"+t+";\n        "+e.getVarModifier("strides"+t)+" int strides"+t+"["+e.maxRank+"];\n        "+e.getVarModifier("shape"+t)+" int shape"+t+"["+e.maxRank+"];\n        "+e.getVarModifier("rank"+t)+" int rank"+t+";\n        "})).join("\n")+"\n      varying vec2 uv;\n\n      "+this.getVariables()},t.prototype.getVariableInitializations=function(t){var e=this.getTextureNames();e.push("Output");for(var n="",r=0,o=e;r<o.length;r++){var i=o[r];if("shape"+i in t){var a=t["shape"+i],u=k(a),s=O(a),p=a.length;n+=this.getArrayInit("shape"+i,a),n+=this.getArrayInit("strides"+i,u),n+="\nsize"+i+" = "+s+";",n+="\nrank"+i+" = "+p+";"}}for(var c in t){if(!c.startsWith("shape"))if(Array.isArray(t[c]))n+=this.getArrayInit(c,t[c]);else n+="int"===this.getVarType(c)?"\n"+c+" = "+t[c]+";":"\n"+c+" = "+t[c].toPrecision(20)+";"}return n},t.prototype.getVarType=function(t){var e=this.getUniformAttrs().find((function(e){return e.name===t}));return void 0!==e&&e.type?e.type:"int"},t.prototype.getArrayInit=function(t,e,n,r){void 0===n&&(n=this.maxRank);var o=this.getVarType(t);void 0===r&&("int"===o?r="-1":"float"===o&&(r="-1.0"));for(var i="",a=0;a<n;a++)a<e.length?"int"===o?i+="\n "+t+"["+a+"] = "+e[a]+";":"float"===o&&(i+="\n "+t+"["+a+"] = "+e[a].toPrecision(20)+";"):i+="\n "+t+"["+a+"] = "+r+";";return i},t.prototype.getUtilFunctions=function(){return"\n    int fromFloat(float f) {\n      return int(floor(f+0.5));\n    }\n\n    int coordinateToPos(vec2 coordinate, int textureWidth, int textureHeight) {\n      int x = (fromFloat(coordinate.x*float(textureWidth*2))-1)/2;\n      int y = (fromFloat(coordinate.y*float(textureHeight*2))-1)/2;\n\n      int pos = x + y*textureWidth;\n\n      return pos*4;\n    }\n\n    vec2 posToCoordinate(int pos, int textureWidth, int textureHeight) {\n      // 4 positions map to the same coordinate\n      pos = pos/4;\n\n      int y = pos/textureWidth;\n      int x = pos - y*textureWidth;\n\n      return vec2(float(x*2+1)/float(textureWidth*2), float(y*2+1)/float(textureHeight*2));\n    }\n\n    int indexToPos(int index["+this.maxRank+"], int strides["+this.maxRank+"]) {\n      int pos = 0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (strides[i] == -1) {\n          break;\n        }\n        pos += index[i]*strides[i];\n      }\n      return pos;\n    }\n\n    float getValueAtPos(int pos, int textureWidth, int textureHeight, sampler2D tex) {\n      vec2 coord = posToCoordinate(pos, textureWidth, textureHeight);\n      int res = pos - (pos/4)*4;\n      vec4 val = texture2D(tex, coord);\n      if (res == 0) {\n        return val.r;\n      } else if (res == 1) {\n        return val.g;\n      } else if (res == 2) {\n        return val.b;\n      } else {\n        return val.a;\n      }\n    }\n\n    float getValueAt(int index["+this.maxRank+"], int strides["+this.maxRank+"], int textureWidth, int textureHeight, sampler2D tex) {\n      int pos = indexToPos(index, strides);\n      return getValueAtPos(pos, textureWidth, textureHeight, tex);\n    }"},t.prototype.getTextureFunctions=function(){var t=this;return this.getTextureNames().map((function(e){return"\n      float _"+e+"(int indices["+t.maxRank+"]) {\n        return getValueAt(indices, strides"+e+", width"+e+", height"+e+", "+e+");\n      }\n      "})).join("\n")},t.prototype.getCompleteFragmentShader=function(t,e){var n=this.getFragmentShader(t),r=this.getVariableDeclarations(t),o=this.getVariableInitializations(t),i=this.getUtilFunctions(),a=this.getTextureFunctions();return"\n    precision "+this.precisionString(e)+" float;\n\n    "+r+"\n\n    "+i+"\n    "+a+"\n\n    void initVars() {\n      "+o+"\n    }\n\n    "+n},t.prototype.getUniforms=function(t){for(var e=[],n=0,r=this.getUniformAttrs();n<r.length;n++){var o=r[n];void 0===t[o.name]&&e.push(o)}var i=this.getTextureNames();i.push("Output");for(var a=0,u=i;a<u.length;a++){var s=u[a];e.push({name:s}),void 0===t["shape"+s]&&(e.push({name:"size"+s}),e.push({name:"strides"+s,length:this.maxRank}),e.push({name:"shape"+s,length:this.maxRank}),e.push({name:"rank"+s})),void 0===t["width"+s]&&e.push({name:"width"+s}),void 0===t["height"+s]&&e.push({name:"height"+s})}for(var p={},c=0,l=e;c<l.length;c++){var h=l[c];if(void 0===t[h.name])if(void 0!==h.length)for(var f=0;f<h.length;f++){var y=h.name+"["+f+"]";p[y]=rt.prop(y)}else p[h.name]=rt.prop(h.name)}return p},t.prototype.posToIndex=function(t,e,n){var r=n+"_"+this.copyCounter++;return"\n    int "+r+" = "+n+";\n    for (int i = 0; i < "+this.maxRank+"; i++) {\n      if ("+t+"[i] == -1) {\n        "+e+"[i] = -1;\n      } else {\n        if ("+t+"[i] == 0) {\n          "+e+"[i] = 0;\n        } else {\n          "+e+"[i] = "+r+"/"+t+"[i];\n          "+r+" = "+r+" - "+t+"[i]*"+e+"[i]; // Stupid modulo hack\n        }\n      }\n    }"},t.prototype.initIndex=function(t,e){return void 0===e?"\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          "+t+"[i] = -1;\n        }":"\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (i < "+e+") {\n            "+t+"[i] = 0;\n          } else {\n            "+t+"[i] = -1;\n          }\n        }"},t.prototype.incrementIndex=function(t,e){return"\n    for (int i = "+this.maxRank+" - 1; i >= 0; i--) {\n      if ("+e+"[i] != -1) {\n        "+t+"[i] += 1;\n        if ("+t+"[i] >= "+e+"[i]) {\n          "+t+"[i] = 0;\n        } else {\n          break;\n        }\n      }\n    }\n    "},t.prototype.incrementConditional=function(t,e,n){return"\n    for (int i = 0; i < "+this.maxRank+"; i++) {\n      if ("+n+"[i] == 1) {\n        "+t+"[i] += 1;\n        if ("+t+"[i] >= "+e+"[i]) {\n          "+t+"[i] = 0;\n        } else {\n          break;\n        }\n      } else if ("+n+"[i] == -1) {\n        break;\n      }\n    }\n    "},t.prototype.getDefaultMain=function(){return"\n    void main() {\n      initVars();\n\n      int pos = coordinateToPos(uv, widthOutput, heightOutput);\n\n      vec4 result = vec4(0,0,0,0);\n\n      if (pos < sizeOutput) {\n        int index["+this.maxRank+"];\n        "+this.posToIndex("stridesOutput","index","pos")+"\n        result.r = process(index);\n\n        pos += 1;\n\n        if (pos < sizeOutput) {\n          "+this.posToIndex("stridesOutput","index","pos")+"\n          result.g = process(index);\n\n          pos += 1;\n\n          if (pos < sizeOutput) {\n            "+this.posToIndex("stridesOutput","index","pos")+"\n            result.b = process(index);\n\n            pos += 1;\n\n            if (pos < sizeOutput) {\n              "+this.posToIndex("stridesOutput","index","pos")+"\n              result.a = process(index);\n            }\n          }\n        }\n      }\n\n      gl_FragColor = result;\n    }"},t.prototype.precisionString=function(t){return 32===t?"highp":"mediump"},t.prototype.getDrawCommand=function(t,e){var n=this.getCompleteFragmentShader(t,e),r=this.getUniforms(t);return rt({frag:n,vert:"\n        precision "+this.precisionString(e)+" float;\n        attribute vec2 position;\n        varying vec2 uv;\n        void main() {\n          uv = 0.5 * (position + 1.0);\n          gl_Position = vec4(position, 0, 1);\n        }",attributes:{position:[-4,-4,4,-4,0,4]},uniforms:r,framebuffer:rt.prop("framebuffer"),depth:{enable:!1},count:3})},t.prototype.compile=function(t,e){this.registerStatics(t),this.precision=e,this.drawCommand=this.getDrawCommand(t,e)},t.prototype.compute=function(t,e,n){void 0===this.drawCommand&&this.compile({},32);var r=O(t),o=this.allocator.allocate(r,this.precision),i={};for(var a in e)i[a]=e[a].memory.frameBuffer;if(void 0===n&&(n={}),!this.fullyStatic){for(var u in e)this.statics.has("shape"+u)||(n["size"+u]=e[u].size,n["strides"+u]=this.pad(k(e[u].shape)),n["shape"+u]=this.copyPad(e[u].shape),n["rank"+u]=e[u].shape.length),this.statics.has("width"+u)||(n["width"+u]=e[u].memory.width),this.statics.has("height"+u)||(n["height"+u]=e[u].memory.height);this.statics.has("shapeOutput")||(n.sizeOutput=r,n.stridesOutput=this.pad(k(t)),n.shapeOutput=this.copyPad(t),n.rankOutput=t.length),this.statics.has("widthOutput")||(n.widthOutput=o.width),this.statics.has("heightOutput")||(n.heightOutput=o.height)}return this.drawCommand(st(st({framebuffer:o.frameBuffer},i),n)),this.gpuTensorConstructor(o,t,this.precision)},t.prototype.getUniformAttrs=function(){return[]},t}(),ct=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.maxIterations=1e6,r.maxRank=2,r}return ct(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int ix1["+this.maxRank+"];\n      "+this.initIndex("ix1")+"\n      ix1[0] = index[0];\n\n      int ix2["+this.maxRank+"];\n      "+this.initIndex("ix2")+"\n      ix2[1] = index[1];\n\n      int k = shapeA[1];\n\n      float res = 0.0;\n\n      for (int i = 0; i < "+this.maxIterations+"; i++) {\n        if (i >= k) {\n          break;\n        }\n        ix1[1] = i;\n        ix2[0] = i;\n\n        float v1 = _A(ix1);\n        float v2 = _B(ix2);\n        res += v1*v2;\n      }\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A","B"]},e.prototype.calc=function(t){var e=this.getOutputShape(t);return this.compute(e,{A:t.A,B:t.B})},e.prototype.getOutputShape=function(t){return[t.A.shape[0],t.B.shape[1]]},e.prototype.compile=function(e,n){void 0!==e.shapeA?this.maxIterations=e.shapeA[1]:void 0!==e.shapeB&&(this.maxIterations=e.shapeB[0]),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeB:t.A.shape,widthB:t.A.memory.width,heightB:t.A.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.B.shape},e}(pt),ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ft=function(t){function e(e,n){return t.call(this,e,n)||this}return ht(e,t),e.prototype.getFragmentShader=function(t){return"\n    void main() {\n      initVars();\n\n      gl_FragColor = "+this.operation("texture2D(X, uv)")+";\n    }\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.calc=function(t){return this.compute(t.input.shape,{X:t.input})},e.prototype.getOutputShape=function(t){return t.input.shape},e.prototype.compile=function(e,n){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:this.getOutputShape(t),widthOutput:r.width,heightOutput:r.height}},e.prototype.getInputInfoString=function(t){return""+t.input.shape},e}(pt),yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dt=function(t){function e(e,n){return t.call(this,e,n)||this}return yt(e,t),e.prototype.operation=function(t){return"exp("+t+")"},e}(ft),mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(){return(gt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},vt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.maxIterations=1e6,r}return mt(e,t),e.prototype.updateInputIx=function(){return"\n    for (int d = 0; d < "+(this.maxRank-2)+"; d++) {\n      int stride = strides[d];\n      int pad = pads[d];\n      int dilation = dilations[d];\n      if (stride == -1) {\n        break;\n      }\n\n      inputIx[d+2] = index[d+2]*stride - pad + kernelIx[d+2]*dilation;\n      if (inputIx[d+2] < 0 || inputIx[d+2] >= shapeX[d+2]) {\n        skip = true;\n        break;\n      }\n    }\n    "},e.prototype.getMainBody=function(){return"\n    int n = index[0];\n    int m = index[1];\n\n    int kernelIx["+this.maxRank+"];\n    "+this.initIndex("kernelIx")+"\n    for (int i = 0; i < "+this.maxRank+"; i++) {\n      if (i >= dataRank) {\n        break;\n      }\n      kernelIx[i+2] = 0;\n    }\n    kernelIx[0] = m;\n    int inputIx["+this.maxRank+"];\n    "+this.initIndex("inputIx")+"\n    inputIx[0] = n;\n\n    for (int cg = 0; cg < "+this.maxIterations+"; cg++) {\n      if (cg >= CG) {\n        break;\n      }\n      int c = m * CG + cg;\n      int d = c/C;\n      c = c - d*C;\n      inputIx[1] = c;\n      kernelIx[1] = cg;\n      for (int kIx = 0; kIx < "+this.maxIterations+"; kIx++) {\n        if (kIx >= kernelSize) {\n          break;\n        }\n\n        bool skip = false;\n\n        "+this.updateInputIx()+"\n\n        if (!skip) {\n          res += _X(inputIx) * _W(kernelIx);\n        }\n\n        "+this.incrementIndex("kernelIx","shapeW")+"\n      }\n    }\n    "},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("CG")+" int CG;\n    "+this.getVarModifier("kernelSize")+" int kernelSize;\n    "+this.getVarModifier("dataRank")+" int dataRank;\n    "+this.getVarModifier("C")+" int C;\n    "+this.getVarModifier("dilations")+" int dilations["+this.maxRank+"];\n    "+this.getVarModifier("pads")+" int pads["+this.maxRank+"];\n    "+this.getVarModifier("strides")+" int strides["+this.maxRank+"];\n    "+this.getVarModifier("activation")+" int activation;\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      float res = 0.0;\n\n      "+this.getMainBody()+"\n\n      if (activation == 1) {\n        res = max(0.0, res);\n      } else if (activation == 2) {\n        res = max(0.0, min(res,6.0));\n      }\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X","W"]},e.prototype.getUniformAttrs=function(){return[{name:"CG"},{name:"kernelSize"},{name:"C"},{name:"dataRank"},{name:"pads",length:2*this.maxRank},{name:"strides",length:this.maxRank},{name:"dilations",length:this.maxRank},{name:"activation"}]},e.prototype.getActivationFlag=function(t){return"id"===t?0:"relu"===t?1:"relu6"===t?2:void 0},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{X:t.X,W:t.W});var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=t.W.shape.slice(2),i=t.W.shape[0],a=t.W.shape[1],u=O(o),s=B(r,o,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),t.dilations,t.strides),p=[e,i];return p=p.concat(s),this.compute(p,{X:t.X,W:t.W},{CG:a,kernelSize:u,C:n,dataRank:r.length,pads:this.copyPad(t.pads,2*this.maxRank),strides:this.copyPad(t.strides),dilations:this.copyPad(t.dilations),activation:this.getActivationFlag(t.activation)})},e.prototype.getOutputShape=function(t){var e=t.X.shape[0],n=t.X.shape.slice(2),r=t.W.shape.slice(2),o=t.W.shape[0],i=B(n,r,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),t.dilations,t.strides),a=[e,o];return a=a.concat(i)},e.prototype.compile=function(e,n){void 0!==e.shapeW&&(e.CG=e.shapeW[1],e.kernelSize=O(e.shapeW.slice(2)),e.dataRank=e.shapeW.length-2,this.maxRank=e.shapeW.length),void 0!==e.shapeX&&(e.C=e.shapeX[1],e.dataRank=e.shapeX.length-2,this.maxRank=e.shapeX.length),void 0!==e.activation&&"string"===typeof e.activation&&(e.activation=this.getActivationFlag(e.activation)),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e),o=O(t.W.shape.slice(2)),i=t.X.shape[1],a=t.X.shape.slice(2);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeW:t.W.shape,widthW:t.W.memory.width,heightW:t.W.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,pads:t.pads,dilations:t.dilations,strides:t.strides,CG:t.W.shape[1],kernelSize:o,dataRank:a.length,C:i,activation:this.getActivationFlag(t.activation)}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.W.shape+"-"+t.dilations+"-"+t.pads+"-"+t.dilations+"-"+t.strides+"-"+t.activation},e}(pt),wt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.maxIterations=1e6,r}return mt(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int biasIndex["+this.maxRank+"];\n      "+this.initIndex("biasIndex")+"\n      biasIndex[0] = index[1];\n      float res = _B(biasIndex);\n\n      "+this.getMainBody()+"\n\n      if (activation == 1) {\n        res = max(0.0, res);\n      }\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X","W","B"]},e.prototype.calc=function(t){var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=t.W.shape.slice(2),i=t.W.shape[0],a=t.W.shape[1],u=O(o),s=B(r,o,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),t.dilations,t.strides),p=[e,i];return p=p.concat(s),this.compute(p,{X:t.X,W:t.W,B:t.B},{CG:a,kernelSize:u,C:n,dataRank:r.length,pads:this.copyPad(t.pads,2*this.maxRank),strides:this.copyPad(t.strides),dilations:this.copyPad(t.dilations),activation:this.getActivationFlag(t.activation)})},e.prototype.getCompilationInfo=function(e,n){var r=t.prototype.getCompilationInfo.call(this,e,n);return gt(gt({},r),{shapeB:e.B.shape,widthB:e.B.memory.width,heightB:e.B.memory.height})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.B.shape},e}(vt),bt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xt=function(t){function e(e,n){return t.call(this,e,n)||this}return bt(e,t),e.prototype.operation=function(t){return"abs("+t+")"},e}(ft),_t=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ot=function(t){function e(e,n){return t.call(this,e,n)||this}return _t(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int["+this.maxRank+"] index) {\n      return "+this.getOp("_A(index)","_B(index)")+";\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getOutputShape=function(t){return t.outputShape},e.prototype.getTextureNames=function(){return["A","B"]},e.prototype.calc=function(t){return this.compute(t.outputShape,{A:t.A,B:t.B})},e.prototype.compile=function(e,n){void 0!==e.shapeA&&(this.maxRank=e.shapeA.length),void 0!==e.shapeB&&(this.maxRank=e.shapeB.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=ot.getAllocationDimensions(O(t.outputShape),e);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeB:t.B.shape,widthB:t.B.memory.width,heightB:t.B.memory.height,shapeOutput:t.outputShape,widthOutput:n.width,heightOutput:n.height}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.B.shape},e}(pt),kt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=function(t){function e(e,n){return t.call(this,e,n)||this}return kt(e,t),e.prototype.getOp=function(t,e){return t+" + "+e},e}(Ot),St=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pt=function(t){function e(e,n){return t.call(this,e,n)||this}return St(e,t),e.prototype.getOp=function(t,e){return t+"*"+e},e}(Ot),jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tt=function(t){function e(e,n){return t.call(this,e,n)||this}return jt(e,t),e.prototype.getOp=function(t,e){return t+" - "+e},e}(Ot),It=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ct=function(t){function e(e,n){return t.call(this,e,n)||this}return It(e,t),e.prototype.getOp=function(t,e){return t+"/"+e},e}(Ot),Mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.maxIterations=1e6,r}return Mt(e,t),e.prototype.updateInputIx=function(){return"\n    for (int d = 0; d < "+(this.maxRank-2)+"; d++) {\n      int stride = strides[d];\n      int pad = pads[d];\n      if (stride == -1) {\n        break;\n      }\n\n      inputIx[d+2] = index[d+2]*stride - pad + kernelIx[d];\n      if (inputIx[d+2] < 0 || inputIx[d+2] >= shapeX[d+2]) {\n        skip = true;\n        break;\n      }\n    }\n    "},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("kernelSize")+" int kernelSize;\n    "+this.getVarModifier("dataRank")+" int dataRank;\n    "+this.getVarModifier("includePad")+" int includePad;\n    "+this.getVarModifier("pads")+" int pads["+this.maxRank+"];\n    "+this.getVarModifier("strides")+" int strides["+this.maxRank+"];\n    "+this.getVarModifier("kernelShape")+" int kernelShape["+this.maxRank+"];\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      float res = 0.0;\n      int count = 0;\n\n      int n = index[0];\n      int c = index[1];\n\n      int kernelIx["+this.maxRank+"];\n      "+this.initIndex("kernelIx")+"\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (i >= dataRank) {\n          break;\n        }\n        kernelIx[i] = 0;\n      }\n      int inputIx["+this.maxRank+"];\n      "+this.initIndex("inputIx")+"\n      inputIx[0] = n;\n      inputIx[1] = c;\n\n      for (int kIx = 0; kIx < "+this.maxIterations+"; kIx++) {\n        if (kIx >= kernelSize) {\n          break;\n        }\n\n        bool skip = false;\n\n        "+this.updateInputIx()+"\n\n        if (!skip) {\n          res += _X(inputIx);\n        }\n\n        if (!skip || includePad == 1) {\n          count += 1;\n        }\n\n        "+this.incrementIndex("kernelIx","kernelShape")+"\n      }\n\n      res = res / float(count);\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getUniformAttrs=function(){return[{name:"kernelSize"},{name:"dataRank"},{name:"includePad"},{name:"pads",length:2*this.maxRank},{name:"strides",length:this.maxRank},{name:"kernelShape",length:this.maxRank}]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{X:t.X});var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=O(t.kernelShape),i=B(r,t.kernelShape,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),new Array(r.length).fill(1),t.strides),a=[e,n];return a=a.concat(i),this.compute(a,{X:t.X},{kernelSize:o,includePad:t.includePad?1:0,dataRank:r.length,pads:this.copyPad(t.pads,2*this.maxRank),strides:this.copyPad(t.strides),kernelShape:this.copyPad(t.kernelShape)})},e.prototype.getOutputShape=function(t){var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=B(r,t.kernelShape,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),new Array(r.length).fill(1),t.strides),i=[e,n];return i=i.concat(o)},e.prototype.compile=function(e,n){void 0!==e.shapeX&&(e.dataRank=e.shapeX.length-2,this.maxRank=e.shapeX.length),!0===e.includePad?e.includePad=1:!1===e.includePad&&(e.includePad=0),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e),o=O(t.kernelShape);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,kernelShape:t.kernelShape,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,pads:t.pads,strides:t.strides,kernelSize:o,dataRank:t.X.shape.length-2,includePad:t.includePad?1:0}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.kernelShape+"-"+t.pads+"-"+t.strides+"-"+t.includePad},e}(pt),Xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.maxIterations=1e6,r}return Xt(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("mappedInputStrides")+" int mappedInputStrides["+this.maxRank+"];\n    "+this.getVarModifier("mappedInputStrides")+" int sumDims["+this.maxRank+"];\n    "+this.getVarModifier("mappedInputStrides")+" int sumSize;\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inputIx["+this.maxRank+"];\n      "+this.initIndex("inputIx")+"\n\n      int inputPos = 0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (mappedInputStrides[i] == -1 || index[i] == -1) {\n          break;\n        }\n        inputPos += mappedInputStrides[i]*index[i];\n      }\n\n      "+this.posToIndex("stridesX","inputIx","inputPos")+"\n\n      float res = 0.0;\n\n      for (int i = 0; i < "+this.maxIterations+"; i++) {\n        if (i >= sumSize) {\n          break;\n        }\n        float curr = _X(inputIx);\n        if (i == 0) {\n          res = "+this.init("curr")+";\n        } else {\n          res = "+this.update("curr","res")+";\n        }\n\n        "+this.incrementConditional("inputIx","shapeX","sumDims")+"\n      }\n\n      "+this.post("res")+"\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.post=function(t){return""},e.prototype.init=function(t){return t},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getUniformAttrs=function(){return[{name:"mappedInputStrides",length:this.maxRank},{name:"sumDims",length:this.maxRank},{name:"sumSize"}]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{X:t.X});for(var e=z(t.X.shape,t.axes,t.keepDims),n=e[0],r=e[1],o=k(t.X.shape),i=[],a=0,u=r;a<u.length;a++){var s=u[a];i.push(o[s])}var p=1,c=new Array(t.X.shape.length).fill(0);for(s=0;s<t.axes.length;s++)c[t.axes[s]]=1,p*=t.X.shape[t.axes[s]];return this.compute(n,{X:t.X},{mappedInputStrides:this.pad(i),sumDims:this.pad(c),sumSize:p})},e.prototype.getOutputShape=function(t){var e=z(t.X.shape,t.axes,t.keepDims),n=e[0];e[1];return n},e.prototype.compile=function(e,n){if(void 0!==e.shapeX&&void 0!==e.axes&&void 0!==e.keepDims){for(var r=z(e.shapeX,e.axes,e.keepDims),o=r[0],i=r[1],a=k(e.shapeX),u=[],s=0,p=i;s<p.length;s++){var c=p[s];u.push(a[c])}var l=1,h=new Array(e.shapeX.length).fill(0);for(c=0;c<e.axes.length;c++)h[e.axes[c]]=1,l*=e.shapeX[e.axes[c]];e.sumDims=h,e.shapeOutput=o,e.mappedInputStrides=u,e.sumSize=l,delete e.keepDims,delete e.axes,this.maxRank=e.shapeX.length}t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){for(var n=z(t.X.shape,t.axes,t.keepDims),r=n[0],o=n[1],i=k(t.X.shape),a=[],u=0,s=o;u<s.length;u++){var p=s[u];a.push(i[p])}var c=1,l=new Array(t.X.shape.length).fill(0);for(p=0;p<t.axes.length;p++)l[t.axes[p]]=1,c*=t.X.shape[t.axes[p]];var h=ot.getAllocationDimensions(O(r),e);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeOutput:r,widthOutput:h.width,heightOutput:h.height,mappedInputStrides:a,sumDims:l,sumSize:c}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.axes+"-"+t.keepDims},e}(pt),Vt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Vt(e,t),e.prototype.update=function(t,e){return t+" + "+e},e.prototype.post=function(t){return t+" = "+t+"/float(sumSize);"},e}(Rt),Et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Et(e,t),e.prototype.update=function(t,e){return"("+t+"*"+t+") + "+e},e.prototype.post=function(t){return t+" = "+t+"/float(sumSize);"},e.prototype.init=function(t){return t+"*"+t},e}(Rt),Gt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Gt(e,t),e.prototype.update=function(t,e){return"("+t+"*"+t+") + "+e},e.prototype.init=function(t){return t+"*"+t},e.prototype.compile=function(e,n){t.prototype.compile.call(this,e,32)},e}(Rt),Ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ut(e,t),e.prototype.update=function(t,e){return t+" + "+e},e}(Rt),Nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Nt(e,t),e.prototype.update=function(t,e){return t+" * "+e},e}(Rt),Ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ht(e,t),e.prototype.update=function(t,e){return"max("+t+", "+e+")"},e}(Rt),Jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jt(e,t),e.prototype.update=function(t,e){return"min("+t+", "+e+")"},e}(Rt),Yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qt=function(t){function e(e,n){return t.call(this,e,n)||this}return Yt(e,t),e.prototype.operation=function(t){return"ceil("+t+")"},e}(ft),Zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$t=function(t){function e(e,n){return t.call(this,e,n)||this}return Zt(e,t),e.prototype.getFragmentShader=function(t){return"\n    void main() {\n      initVars();\n\n      vec4 maxVec = vec4(maxVal,maxVal,maxVal,maxVal);\n      vec4 minVec = vec4(minVal,minVal,minVal,minVal);\n\n      vec4 res = texture2D(X, uv);\n      if (doMin == 1) {\n        res = max(minVec, res);\n      }\n      if (doMax == 1) {\n        res = min(maxVec, res);\n      }\n\n      gl_FragColor = res;\n    }\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("minVal")+" float minVal;\n    "+this.getVarModifier("maxVal")+" float maxVal;\n    "+this.getVarModifier("doMin")+" int doMin;\n    "+this.getVarModifier("doMax")+" int doMax;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"minVal",type:"float"},{name:"maxVal",type:"float"},{name:"doMin"},{name:"doMax"}]},e.prototype.calc=function(t){return this.fullyStatic?this.compute(this.outputShape,{X:t.input}):this.compute(t.input.shape,{X:t.input},{minVal:void 0!==t.minVal?t.minVal:0,maxVal:void 0!==t.maxVal?t.maxVal:0,doMin:void 0!==t.minVal?1:0,doMax:void 0!==t.maxVal?1:0})},e.prototype.getOutputShape=function(t){return t.input.shape},e.prototype.compile=function(e,n){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=ot.getAllocationDimensions(t.input.size,e);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:t.input.shape,widthOutput:n.width,heightOutput:n.height,minVal:void 0!==t.minVal?t.minVal:0,maxVal:void 0!==t.maxVal?t.maxVal:0,doMin:void 0!==t.minVal?1:0,doMax:void 0!==t.maxVal?1:0}},e.prototype.getInputInfoString=function(t){return t.input.shape+"-"+t.minVal+"-"+t.maxVal},e}(pt),te=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(t){function e(e,n){return t.call(this,e,n)||this}return te(e,t),e.prototype.operation=function(t){return"floor("+t+")"},e}(ft),ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},oe=function(t){function e(e,n){return t.call(this,e,n)||this}return ne(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("axis")+" int axis;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"axis"}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      float res = 0.0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (i == axis) {\n          if (index[i] >= shapeA[i]) {\n            index[i] = index[i] - shapeA[i];\n            res = _B(index);\n          } else {\n            res = _A(index);\n          }\n          break;\n        }\n      }\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A","B"]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{A:t.A,B:t.B});var e=this.getOutputShape(t);return this.compute(e,{A:t.A,B:t.B},{axis:t.axis})},e.prototype.getOutputShape=function(t){var e=re(t.A.shape);return e[t.axis]+=t.B.shape[t.axis],e},e.prototype.compile=function(e,n){void 0!==e.shapeA&&(this.maxRank=e.shapeA.length),void 0!==e.shapeB&&(this.maxRank=e.shapeB.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeB:t.B.shape,widthB:t.B.memory.width,heightB:t.B.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,axis:t.axis}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.B.shape+"-"+t.axis},e}(pt),ie=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ae=function(t){function e(e,n){return t.call(this,e,n)||this}return ie(e,t),e.prototype.getFragmentShader=function(t){return"\n    void main() {\n      initVars();\n\n      gl_FragColor = texture2D(X, uv);\n    }\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.calc=function(t){var e=this.getOutputShape(t);return this.compute(e,{X:t.input})},e.prototype.getOutputShape=function(t){var e=t.outputShape;return void 0===e&&(e=t.input.shape),e},e.prototype.compile=function(e,n){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height}},e.prototype.getInputInfoString=function(t){return t.input+"-"+this.getOutputShape(t)},e}(pt),ue=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),se=function(t){function e(e,n){return t.call(this,e,n)||this}return ue(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      return _X(index);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.calc=function(t){return this.compute(t.outputShape,{X:t.input})},e.prototype.getOutputShape=function(t){return t.outputShape},e.prototype.compile=function(e,n){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height}},e.prototype.getInputInfoString=function(t){return t.input.shape+"-"+t.outputShape},e}(pt),pe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ce=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.gatherMaxIxSize=10,r}return pe(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("axis")+" int axis;\n    "+this.getVarModifier("indexValues")+" int indexValues["+this.gatherMaxIxSize+"];\n    "+this.getVarModifier("mappedIndexStrides")+" int mappedIndexStrides["+this.maxRank+"];\n    "+this.getVarModifier("mappedInputStrides")+" int mappedInputStrides["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"axis"},{name:"indexValues",length:this.gatherMaxIxSize},{name:"mappedInputStrides",length:this.maxRank},{name:"mappedIndexStrides",length:this.maxRank}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inputPos = 0;\n      int indexPos = 0;\n\n      int strideAxis = 0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (index[i] == -1) {\n          break;\n        }\n        if (i == axis) {\n          strideAxis = stridesX[i];\n        }\n        inputPos += mappedInputStrides[i]*index[i];\n        indexPos += mappedIndexStrides[i]*index[i];\n      }\n\n      for (int i = 0; i < "+this.gatherMaxIxSize+"; i++) {\n        if (i == indexPos) {\n          inputPos += indexValues[i]*strideAxis;\n          break;\n        }\n      }\n\n      return getValueAtPos(inputPos, widthX, heightX, X);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{X:t.X});if(t.indices.size>this.gatherMaxIxSize)throw new Error("Gather on GPU can deal with at most "+this.gatherMaxIxSize+" indices, input had "+t.indices.size);for(var e=t.X.shape.length,n=t.indices.shape.length,r=k(t.X.shape),o=k(t.indices.shape),i=e+n-1,a=new Array(i),u=new Array(i).fill(0),s=new Array(i).fill(0),p=0;p<t.axis;p++)a[p]=t.X.shape[p],u[p]=r[p],s[p]=0;for(p=0;p<n;p++)a[p+t.axis]=t.indices.shape[p],s[p+t.axis]=o[p],u[p+t.axis]=0;for(p=t.axis+1;p<e;p++)a[p+n-1]=t.X.shape[p],u[p+n-1]=r[p],s[p+n-1]=0;return this.compute(a,{X:t.X},{axis:t.axis,indexValues:this.pad(Array.from(t.indices.values),this.gatherMaxIxSize),mappedInputStrides:this.pad(u),mappedIndexStrides:this.pad(s)})},e.prototype.getOutputShape=function(t){for(var e=t.X.shape.length,n=t.indices.shape.length,r=new Array(e+n-1),o=0;o<t.axis;o++)r[o]=t.X.shape[o];for(o=0;o<n;o++)r[o+t.axis]=t.indices.shape[o];for(o=t.axis+1;o<e;o++)r[o+n-1]=t.X.shape[o];return r},e.prototype.compile=function(e,n){if(void 0!==e.shapeX&&(this.maxRank=e.shapeX.length,void 0!==e.indices&&void 0!==e.axis)){for(var r=e.shapeX.length,o=e.indices.shape.length,i=k(e.shapeX),a=k(e.indices.shape),u=r+o-1,s=new Array(u),p=new Array(u).fill(0),c=new Array(u).fill(0),l=0;l<e.axis;l++)s[l]=e.shapeX[l],p[l]=i[l],c[l]=0;for(l=0;l<o;l++)s[l+e.axis]=e.indices.shape[l],c[l+e.axis]=a[l],p[l+e.axis]=0;for(l=e.axis+1;l<r;l++)s[l+o-1]=e.shapeX[l],p[l+o-1]=i[l],c[l+o-1]=0;e.mappedIndexStrides=c,e.mappedInputStrides=p,e.indexValues=Array.from(e.indices.values),delete e.indices}t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){for(var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e),o=t.X.shape.length,i=t.indices.shape.length,a=k(t.X.shape),u=k(t.indices.shape),s=o+i-1,p=new Array(s),c=new Array(s).fill(0),l=new Array(s).fill(0),h=0;h<t.axis;h++)p[h]=t.X.shape[h],c[h]=a[h],l[h]=0;for(h=0;h<i;h++)p[h+t.axis]=t.indices.shape[h],l[h+t.axis]=u[h],c[h+t.axis]=0;for(h=t.axis+1;h<o;h++)p[h+i-1]=t.X.shape[h],c[h+i-1]=a[h],l[h+i-1]=0;return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,axis:t.axis,indexValues:Array.from(t.indices.values),mappedIndexStrides:l,mappedInputStrides:c}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.axis+"-"+Array.from(t.indices.values)+"-"+t.indices.shape},e}(pt),le=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),he=function(){return(he=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},fe=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},ye=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.maxIterations=1e6,r}return le(e,t),e.prototype.getMainBody=function(){return"\n      int ixA["+this.maxRank+"];\n      "+this.initIndex("ixA")+"\n      int ixB["+this.maxRank+"];\n      "+this.initIndex("ixA")+"\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (i >= rank - 2) {\n          break;\n        }\n        ixA[i] = index[i];\n        ixB[i] = index[i];\n      }\n\n      int m = 0;\n      int o = 0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (i == rank-2) {\n          m = index[i];\n          o = index[i+1];\n\n          if (aTranspose == 0) {\n            ixA[i] = m;\n          } else {\n            ixA[i+1] = m;\n          }\n\n          if (bTranspose == 0) {\n            ixB[i+1] = o;\n          } else {\n            ixB[i] = o;\n          }\n\n          break;\n        }\n      }\n\n      float res = 0.0;\n\n      for (int n = 0; n < "+this.maxIterations+"; n++) {\n        if (n >= N) {\n          break;\n        }\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (i == rank-2) {\n            if (aTranspose == 0) {\n              ixA[i+1] = n;\n            } else {\n              ixA[i] = n;\n            }\n\n            if (bTranspose == 0) {\n              ixB[i] = n;\n            } else {\n              ixB[i+1] = n;\n            }\n\n            break;\n          }\n        }\n        res += _A(ixA) * _B(ixB);\n      }\n\n      res = res*alpha;\n    "},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("M")+" int M;\n    "+this.getVarModifier("N")+" int N;\n    "+this.getVarModifier("O")+" int O;\n    "+this.getVarModifier("rank")+" int rank;\n    "+this.getVarModifier("aTranspose")+" int aTranspose;\n    "+this.getVarModifier("bTranspose")+" int bTranspose;\n    "+this.getVarModifier("alpha")+" float alpha;\n    "+this.getVarModifier("beta")+" float beta;\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      "+this.getMainBody()+"\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A","B"]},e.prototype.getUniformAttrs=function(){return[{name:"M"},{name:"N"},{name:"O"},{name:"rank"},{name:"aTranspose"},{name:"bTranspose"},{name:"alpha",type:"float"},{name:"beta",type:"float"}]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{A:t.a,B:t.b});var e=t.a.shape.length,n=t.aTranspose?t.a.shape[e-1]:t.a.shape[e-2],r=t.aTranspose?t.a.shape[e-2]:t.a.shape[e-1],o=t.bTranspose?t.b.shape[e-2]:t.b.shape[e-1],i=t.a.shape.slice(0,e-2),a=fe(i,[n,o]),u={M:n,N:r,O:o,rank:e,aTranspose:t.aTranspose?1:0,bTranspose:t.bTranspose?1:0,alpha:t.alpha,beta:t.beta};return this.compute(a,{A:t.a,B:t.b},u)},e.prototype.getOutputShape=function(t){var e=t.a.shape.length,n=t.aTranspose?t.a.shape[e-1]:t.a.shape[e-2],r=t.bTranspose?t.b.shape[e-2]:t.b.shape[e-1],o=t.a.shape.slice(0,e-2);return fe(o,[n,r])},e.prototype.compile=function(e,n){if(void 0!==e.shapeA){var r=e.shapeA.length;if(e.rank=r,this.maxRank=r,void 0!==e.aTranspose){var o=e.aTranspose?e.shapeA[r-1]:e.shapeA[r-2],i=e.aTranspose?e.shapeA[r-2]:e.shapeA[r-1];e.M=o,e.N=i,e.aTranspose=e.aTranspose?1:0}}if(void 0!==e.shapeB&&void 0!==e.bTranspose){r=e.shapeB.length;var a=e.bTranspose?e.shapeB[r-2]:e.shapeB[r-1];e.O=a,e.bTranspose=e.bTranspose?1:0}t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e),o=t.a.shape.length,i=t.aTranspose?t.a.shape[o-1]:t.a.shape[o-2],a=t.aTranspose?t.a.shape[o-2]:t.a.shape[o-1],u=t.bTranspose?t.b.shape[o-2]:t.b.shape[o-1];return{shapeA:t.a.shape,widthA:t.a.memory.width,heightA:t.a.memory.height,shapeB:t.b.shape,widthB:t.b.memory.width,heightB:t.b.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,M:i,N:a,O:u,aTranspose:t.aTranspose?1:0,bTranspose:t.bTranspose?1:0,alpha:t.alpha,beta:t.beta,rank:o}},e.prototype.getInputInfoString=function(t){return t.a.shape+"-"+t.b.shape+"-"+t.aTranspose+"-"+t.bTranspose+"-"+t.alpha+"-"+t.beta},e}(pt),de=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return le(e,t),e.prototype.getTextureNames=function(){return["A","B","C"]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      "+this.getMainBody()+"\n\n      res += beta*_C(index);\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{A:t.a,B:t.b,C:t.c});var e=t.a.shape.length,n=t.aTranspose?t.a.shape[e-1]:t.a.shape[e-2],r=t.aTranspose?t.a.shape[e-2]:t.a.shape[e-1],o=t.bTranspose?t.b.shape[e-2]:t.b.shape[e-1],i=t.a.shape.slice(0,e-2),a=fe(i,[n,o]),u={M:n,N:r,O:o,rank:e,aTranspose:t.aTranspose?1:0,bTranspose:t.bTranspose?1:0,alpha:t.alpha,beta:t.beta};return this.compute(a,{A:t.a,B:t.b,C:t.c},u)},e.prototype.getCompilationInfo=function(e,n){var r=t.prototype.getCompilationInfo.call(this,e,n);return he(he({},r),{shapeC:e.c.shape,widthC:e.c.memory.width,heightC:e.c.memory.height})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.c.shape},e}(ye),me=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=function(t){function e(e,n){return t.call(this,e,n)||this}return me(e,t),e.prototype.getOp=function(t,e){return"pow("+t+", "+e+")"},e}(Ot),ve=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),we=function(t){function e(e,n){return t.call(this,e,n)||this}return ve(e,t),e.prototype.operation=function(t){return"sqrt("+t+")"},e}(ft),be=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xe=function(t){function e(e,n){return t.call(this,e,n)||this}return be(e,t),e.prototype.operation=function(t){return"log("+t+")"},e}(ft),_e=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oe=function(t){function e(e,n){return t.call(this,e,n)||this}return _e(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("mappedStrides")+" int mappedStrides["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"mappedStrides",length:this.maxRank}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      return getValueAt(index, mappedStrides, widthA, heightA, A);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A"]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{A:t.A});for(var e=t.A.shape.length,n=this.getOutputShape(t),r=k(t.A.shape),o=new Array(e),i=0;i<e;i++)o[i]=r[t.permutation[i]];return this.compute(n,{A:t.A},{mappedStrides:this.pad(o)})},e.prototype.getOutputShape=function(t){for(var e=t.A.shape.length,n=new Array(e),r=0;r<e;r++)n[r]=t.A.shape[t.permutation[r]];return n},e.prototype.compile=function(e,n){if(void 0!==e.shapeA&&(this.maxRank=e.shapeA.length,void 0!==e.permutation)){for(var r=e.shapeA.length,o=k(e.shapeA),i=new Array(r),a=0;a<r;a++)i[a]=o[e.permutation[a]];e.mappedStrides=i,delete e.permutation}t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){for(var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e),o=t.A.shape.length,i=k(t.A.shape),a=new Array(o),u=0;u<o;u++)a[u]=i[t.permutation[u]];return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,mappedStrides:a}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.permutation},e}(pt),ke=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ae=function(t){function e(e,n){return t.call(this,e,n)||this}return ke(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("repeats")+" int repeats["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"repeats",length:this.maxRank}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inIndex["+this.maxRank+"];\n      "+this.initIndex("inIndex")+"\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (repeats[i] == -1) {\n          break;\n        }\n        int d = index[i] / shapeA[i];\n        inIndex[i] = index[i] - d*shapeA[i];\n      }\n\n      return _A(inIndex);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getOutputShape=function(t){for(var e=t.A.shape.length,n=new Array(e),r=0;r<e;r++)n[r]=t.A.shape[r]*t.repeats[r];return n},e.prototype.getTextureNames=function(){return["A"]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{A:t.A});var e=this.getOutputShape(t);return this.compute(e,{A:t.A},{repeats:this.copyPad(t.repeats)})},e.prototype.compile=function(e,n){void 0!==e.shapeA&&(this.maxRank=e.shapeA.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,repeats:t.repeats}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.repeats},e}(pt),Se=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pe=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},je=function(t){function e(e,n){return t.call(this,e,n)||this}return Se(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inputIx["+this.maxRank+"];\n      "+this.initIndex("inputIx")+"\n      if (mode == 0) {\n        float res = value;\n\n        int outOfBounds = 0;\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (index[i] == -1) {\n            break;\n          }\n          inputIx[i] = index[i] - pads[i];\n          if (inputIx[i] < 0 || inputIx[i] >= shapeX[i]) {\n            outOfBounds = 1;\n            break;\n          }\n        }\n\n        if (outOfBounds == 0) {\n          res = _X(inputIx);\n        }\n\n        return res;\n      } else if (mode == 1) {\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (index[i] == -1) {\n            break;\n          }\n          inputIx[i] = index[i] - pads[i];\n          if (inputIx[i] < 0) {\n            inputIx[i] = -inputIx[i];\n          } else if (inputIx[i] >= shapeX[i]) {\n            inputIx[i] = 2*shapeX[i] - inputIx[i] - 2;\n          }\n        }\n\n        return _X(inputIx);\n      } else {\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (index[i] == -1) {\n            break;\n          }\n          inputIx[i] = index[i] - pads[i];\n          if (inputIx[i] < 0) {\n            inputIx[i] = 0;\n          } else if (inputIx[i] >= shapeX[i]) {\n            inputIx[i] = shapeX[i] - 1;\n          }\n        }\n\n        return _X(inputIx);\n      }\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("pads")+" int pads["+2*this.maxRank+"];\n    "+this.getVarModifier("value")+" float value;\n    "+this.getVarModifier("mode")+" int mode;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"value",type:"float"},{name:"pads",length:2*this.maxRank},{name:"mode"}]},e.prototype.getModeFlag=function(t){return"constant"===t?0:"reflect"===t?1:2},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{X:t.input});var e=this.getOutputShape(t);return this.compute(e,{X:t.input},{pads:this.copyPad(t.pads,2*this.maxRank),value:t.value,mode:this.getModeFlag(t.mode)})},e.prototype.getOutputShape=function(t){for(var e=t.input.shape.length,n=Pe(t.input.shape),r=0;r<e;r++)n[r]+=t.pads[r]+t.pads[r+e];return n},e.prototype.compile=function(e,n){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),void 0!==e.mode&&"string"===typeof e.mode&&(e.mode=this.getModeFlag(e.mode)),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,pads:t.pads,mode:this.getModeFlag(t.mode),value:t.value}},e.prototype.getInputInfoString=function(t){return t.input.shape+"-"+t.pads+"-"+t.mode+"-"+t.value},e}(pt),Te=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ie=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Ce=function(t){function e(e,n){return t.call(this,e,n)||this}return Te(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inIx["+this.maxRank+"];\n      "+this.initIndex("inIx")+"\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (index[i] == -1) {\n          break;\n        }\n\n        inIx[i] = index[i] + offsets[i];\n      }\n\n      return _X(inIx);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("offsets")+" int offsets["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"offsets",length:this.maxRank}]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{X:t.X});for(var e=t.X.shape.length,n=Ie(t.X.shape),r=new Array(e).fill(0),o=0,i=0;i<e&&o<t.axes.length;i++)i==t.axes[o]&&(n[i]=t.ends[o]-t.starts[o],r[i]=t.starts[o],o++);return this.compute(n,{X:t.X},{offsets:this.pad(r)})},e.prototype.getOutputShape=function(t){for(var e=t.X.shape.length,n=Ie(t.X.shape),r=0,o=0;o<e&&r<t.axes.length;o++)o==t.axes[r]&&(n[o]=t.ends[r]-t.starts[r],r++);return n},e.prototype.compile=function(e,n){if(void 0!==e.shapeX&&(this.maxRank=e.shapeX.length,void 0!==e.axes&&void 0!==e.starts&&void 0!==e.starts)){for(var r=e.shapeX.length,o=new Array(r).fill(0),i=0,a=0;a<r&&i<e.axes.length;a++)a==e.axes[i]&&(o[a]=e.starts[i],i++);e.offsets=o,delete e.starts,delete e.ends,delete e.axes}t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){for(var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e),o=t.X.shape.length,i=Ie(t.X.shape),a=new Array(o).fill(0),u=0,s=0;s<o&&u<t.axes.length;s++)s==t.axes[u]&&(i[s]=t.ends[u]-t.starts[u],a[s]=t.starts[u],u++);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,offsets:a}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.axes+"-"+t.starts+"-"+t.ends},e}(pt),Me=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Be=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Xe=function(t){function e(e,n){return t.call(this,e,n)||this}return Me(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inIx["+this.maxRank+"];\n      "+this.initIndex("inIx")+"\n\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (index[i] == -1) {\n          break;\n        }\n\n        inIx[i] = int(floor(float(index[i]) / scales[i]));\n      }\n\n      return _X(inIx);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("scales")+" float scales["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"scales",length:this.maxRank,type:"float"}]},e.prototype.calc=function(t){if(this.fullyStatic)return this.compute(this.outputShape,{X:t.X});var e=this.getOutputShape(t);return this.compute(e,{X:t.X},{scales:this.copyPad(t.scales)})},e.prototype.getOutputShape=function(t){for(var e=t.X.shape.length,n=Be(t.X.shape),r=0;r<e;r++)n[r]=Math.floor(n[r]*t.scales[r]);return n},e.prototype.compile=function(e,n){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,scales:t.scales}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.scales},e}(pt),Re=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ve=function(t){function e(e,n){return t.call(this,e,n)||this}return Re(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("epsilon")+" float epsilon;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"epsilon",type:"float"}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int["+this.maxRank+"] index) {\n      float result = _X(index) - _Mean(index);\n      result = result / sqrt(_Variance(index) + epsilon);\n      result = result * _Scale(index) + _Bias(index);\n      return result;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getOutputShape=function(t){return t.X.shape},e.prototype.getTextureNames=function(){return["X","Mean","Variance","Scale","Bias"]},e.prototype.calc=function(t){return this.compute(t.X.shape,{X:t.X,Mean:t.Mean,Variance:t.Variance,Scale:t.Scale,Bias:t.Bias},{epsilon:t.epsilon})},e.prototype.compile=function(e,n){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e,n)},e.prototype.getCompilationInfo=function(t,e){var n=this.getOutputShape(t),r=ot.getAllocationDimensions(O(n),e);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeBias:t.Bias.shape,widthBias:t.Bias.memory.width,heightBias:t.Bias.memory.height,shapeMean:t.Mean.shape,widthMean:t.Mean.memory.width,heightMean:t.Mean.memory.height,shapeScale:t.Scale.shape,widthScale:t.Scale.memory.width,heightScale:t.Scale.memory.height,shapeVariance:t.Variance.shape,widthVariance:t.Variance.memory.width,heightVariance:t.Variance.memory.height,shapeOutput:n,widthOutput:r.width,heightOutput:r.height,epsilon:t.epsilon}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.Mean.shape+"-"+t.Variance.shape+"-"+t.Scale.shape+"-"+t.Bias.shape+"-"+t.epsilon},e}(pt),De=function(){function t(t,e){void 0===e&&(e=2),this.getOp=t,this.minCallsToCompile=e,this.opDict={}}return t.prototype.getDefault=function(t){var e="default-"+t;if(void 0===this.opDict[e]){var n=this.getOp();n.compile({},t),this.opDict[e]={infoString:e,numCalls:0,operation:n}}return this.opDict[e]},t.prototype.calc=function(t,e){var n=this.getDefault(e),r=n.operation.getInputInfoString(t);void 0===this.opDict[r]&&(this.opDict[r]={infoString:r,numCalls:0});var o=this.opDict[r];if(o.numCalls++,o.numCalls===this.minCallsToCompile){o.operation=this.getOp();var i=n.operation.getCompilationInfo(t,e);o.operation.compile(i,e)}return o.numCalls>=this.minCallsToCompile?o.operation.calc(t):(n.numCalls++,n.operation.calc(t))},t}(),Ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ze=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ge=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Fe=function(t){function e(e,n,r){var o=t.call(this)||this;return o.shape=n,o.precision=r,o.deleted=!1,o.size=O(n),e instanceof Float32Array?o.memory=ot.allocateTexture(e,r):o.memory=e,o}return Ee(e,t),e.fromData=function(t,n){var r=rt.texture({data:t,format:"rgba",type:32===n?"float":"half float"}),o=ot.allocateFramebuffer(r,n),i=r.width;return new e(o,[r.height,i,4],n)},e.prototype.getValues=function(){var t=this;return new Promise((function(e,n){rt({framebuffer:t.memory.frameBuffer})((function(){var n=new Float32Array(t.memory.size);n=rt.read(n),e(n.subarray(0,t.size))}))}))},e.prototype.getShape=function(){return this.shape},e.prototype.gpu=function(){return ze(this,void 0,void 0,(function(){return Ge(this,(function(t){return[2,this]}))}))},e.prototype.delete=function(){this.deleted=!0,ot.deallocate(this.memory),this.memory=void 0},e.prototype.copy=function(t){return vn.calc({input:this},t||this.precision)},e.prototype.exp=function(){return He.calc({input:this},this.precision)},e.prototype.log=function(){return Ze.calc({input:this},this.precision)},e.prototype.sqrt=function(){return Qe.calc({input:this},this.precision)},e.prototype.abs=function(){return qe.calc({input:this},this.precision)},e.prototype.floor=function(){return Ke.calc({input:this},this.precision)},e.prototype.ceil=function(){return Je.calc({input:this},this.precision)},e.prototype.add_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add GPU tensor to GPU tensor");return on.calc({A:t,B:n,outputShape:r},this.precision)},e.prototype.subtract_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only subtract GPU tensor from GPU tensor");return an.calc({A:t,B:n,outputShape:r},this.precision)},e.prototype.multiply_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only multiply GPU tensor with GPU tensor");return un.calc({A:t,B:n,outputShape:r},this.precision)},e.prototype.divide_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only divide GPU tensor by GPU tensor");return sn.calc({A:t,B:n,outputShape:r},this.precision)},e.prototype.power_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only take GPU tensor to power of GPU tensor");return pn.calc({A:t,B:n,outputShape:r},this.precision)},e.prototype.matMul=function(t){if(!(t instanceof e))throw new Error("Can only matrix multiply GPU tensor to GPU tensor");return We.calc({A:this,B:t},this.precision)},e.prototype.gemm_impl=function(t,n,r,o,i,a){if(!(t instanceof e&&(void 0===a||a instanceof e)))throw new Error("Can only do gemm with CPU tensors");return void 0===a?Ne.calc({a:this,b:t,aTranspose:n,bTranspose:r,alpha:o,beta:i},this.precision):Le.calc({a:this,b:t,c:a,aTranspose:n,bTranspose:r,alpha:o,beta:i},this.precision)},e.prototype.sum_impl=function(t,e){return fn.calc({X:this,axes:t,keepDims:e},this.precision)},e.prototype.sumSquare_impl=function(t,e){return hn.calc({X:this,axes:t,keepDims:e},this.precision)},e.prototype.reduceMean_impl=function(t,e){return cn.calc({X:this,axes:t,keepDims:e},this.precision)},e.prototype.reduceMeanSquare_impl=function(t,e){return ln.calc({X:this,axes:t,keepDims:e},this.precision)},e.prototype.product_impl=function(t,e){return yn.calc({X:this,axes:t,keepDims:e},this.precision)},e.prototype.max_impl=function(t,e){return dn.calc({X:this,axes:t,keepDims:e},this.precision)},e.prototype.min_impl=function(t,e){return mn.calc({X:this,axes:t,keepDims:e},this.precision)},e.prototype.conv_impl=function(t,n,r,o,i,a,u){if(!(t instanceof e)||void 0!==a&&!(a instanceof e))throw new Error("Can only do convolution of GPU tensor with GPU tensor");return void 0===a?$e.calc({X:this,W:t,pads:o,dilations:n,strides:i,activation:u},this.precision):en.calc({X:this,W:t,B:a,pads:o,dilations:n,strides:i,activation:u},this.precision)},e.prototype.averagePool_impl=function(t,e,n,r){return tn.calc({X:this,includePad:r,kernelShape:t,pads:e,strides:n},this.precision)},e.prototype.reshape_impl=function(t,n){return n?vn.calc({input:this,outputShape:t},this.precision):new e(this.memory,t,this.precision)},e.prototype.concat=function(t,n){if(!(t instanceof e))throw new Error("Can only concat GPU tensor to GPU tensor");return gn.calc({A:this,B:t,axis:n},this.precision)},e.prototype.transpose_impl=function(t){return xn.calc({A:this,permutation:t},this.precision)},e.prototype.clip=function(t,e){return Ye.calc({input:this,minVal:t,maxVal:e},this.precision)},e.prototype.repeat=function(t){return _n.calc({A:this,repeats:t},this.precision)},e.prototype.expand=function(t){var e=this.alignShapes(this.shape,t),n=e[0],r=(e[1],e[2]);return S(this.shape,r)?this.copy():wn.calc({input:this.reshape(n,!1),outputShape:r},this.precision)},e.prototype.pad_impl=function(t,e,n){return nn.calc({input:this,pads:t,mode:e,value:n},this.precision)},e.prototype.gather=function(t,e){return bn.calc({X:this,axis:t,indices:e},this.precision)},e.prototype.slice_impl=function(t,e,n){return On.calc({X:this,starts:t,ends:e,axes:n},this.precision)},e.prototype.upsample=function(t){return rn.calc({X:this,scales:t},this.precision)},e.prototype.normalize=function(t,n,r,o,i){if(!(t instanceof e)||!(n instanceof e)||!(o instanceof e)||!(i instanceof e))throw new Error("Can only normalize with CPU tensors");return kn.calc({X:this,Mean:t,Variance:n,Scale:o,Bias:i,epsilon:r},this.precision)},e}(C),Ue=function(t,e,n){return new Fe(t,e,n)},We=new De((function(){return new lt(Ue)})),Ne=new De((function(){return new ye(Ue)})),Le=new De((function(){return new de(Ue)})),He=new De((function(){return new dt(Ue)})),qe=new De((function(){return new xt(Ue)})),Je=new De((function(){return new Qt(Ue)})),Ke=new De((function(){return new ee(Ue)})),Ye=new De((function(){return new $t(Ue)})),Qe=new De((function(){return new we(Ue)})),Ze=new De((function(){return new xe(Ue)})),$e=new De((function(){return new vt(Ue)})),tn=new De((function(){return new Bt(Ue)})),en=new De((function(){return new wt(Ue)})),nn=new De((function(){return new je(Ue)})),rn=new De((function(){return new Xe(Ue)})),on=new De((function(){return new At(Ue)})),an=new De((function(){return new Tt(Ue)})),un=new De((function(){return new Pt(Ue)})),sn=new De((function(){return new Ct(Ue)})),pn=new De((function(){return new ge(Ue)})),cn=new De((function(){return new Dt(Ue)})),ln=new De((function(){return new zt(Ue)})),hn=new De((function(){return new Ft(Ue)})),fn=new De((function(){return new Wt(Ue)})),yn=new De((function(){return new Lt(Ue)})),dn=new De((function(){return new qt(Ue)})),mn=new De((function(){return new Kt(Ue)})),gn=new De((function(){return new oe(Ue)})),vn=new De((function(){return new ae(Ue)})),wn=new De((function(){return new se(Ue)})),bn=new De((function(){return new ce(Ue)})),xn=new De((function(){return new Oe(Ue)})),_n=new De((function(){return new Ae(Ue)})),On=new De((function(){return new Ce(Ue)})),kn=new De((function(){return new Ve(Ue)})),An=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Pn=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},jn=new Promise((function(t,e){n.e(3).then(n.bind(null,46)).then((function(e){ut=e.Tensor,t()}))})),Tn=function(t){function e(e,n){var r=t.call(this)||this;if(e instanceof Float32Array){if(void 0===n)throw new Error("Need the shape when creating a Wasm tensor from values");r.wasmTensor=ut.create(n,e)}else r.wasmTensor=e;return r}return An(e,t),e.prototype.getValues=function(){return Promise.resolve(this.wasmTensor.get_vals())},e.prototype.getShape=function(){return Array.from(this.wasmTensor.get_shape())},e.prototype.wasm=function(){return Sn(this,void 0,void 0,(function(){return Pn(this,(function(t){return[2,this]}))}))},e.prototype.delete=function(){this.wasmTensor.free(),this.wasmTensor=void 0},e.prototype.copy=function(){return new e(this.wasmTensor.copy())},e.prototype.exp=function(){return new e(this.wasmTensor.exp())},e.prototype.log=function(){return new e(this.wasmTensor.log())},e.prototype.sqrt=function(){return new e(this.wasmTensor.sqrt())},e.prototype.abs=function(){return new e(this.wasmTensor.abs())},e.prototype.add_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add WASM tensor to WASM tensor");return new e(t.wasmTensor.addition(n.wasmTensor))},e.prototype.subtract_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only subtract WASM tensor from WASM tensor");return new e(t.wasmTensor.subtraction(n.wasmTensor))},e.prototype.multiply_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only multiply WASM tensor with WASM tensor");return new e(t.wasmTensor.multiply(n.wasmTensor))},e.prototype.divide_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only divide WASM tensor by WASM tensor");return new e(t.wasmTensor.divide(n.wasmTensor))},e.prototype.power_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only take WASM tensor to power of WASM tensor");return new e(t.wasmTensor.power(n.wasmTensor))},e.prototype.matMul=function(t){if(!(t instanceof e))throw new Error("Can only add WASM tensor to WASM tensor");return new e(this.wasmTensor.matmul(t.wasmTensor))},e.prototype.gemm_impl=function(t,n,r,o,i,a){if(!(t instanceof e&&(void 0===a||a instanceof e)))throw new Error("Can only do gemm with CPU tensors");return new e(void 0!==a?this.wasmTensor.gemm_with_c(t.wasmTensor,n,r,o,a.wasmTensor,i):this.wasmTensor.gemm(t.wasmTensor,n,r,o))},e.prototype.sum_impl=function(t,n){return new e(this.wasmTensor.sum(new Uint32Array(t),n))},e.prototype.sumSquare_impl=function(t,n){return new e(this.wasmTensor.sum_square(new Uint32Array(t),n))},e.prototype.product_impl=function(t,n){return new e(this.wasmTensor.product(new Uint32Array(t),n))},e.prototype.max_impl=function(t,n){return new e(this.wasmTensor.max(new Uint32Array(t),n))},e.prototype.min_impl=function(t,n){return new e(this.wasmTensor.min(new Uint32Array(t),n))},e.prototype.reduceMean_impl=function(t,n){return new e(this.wasmTensor.reduce_mean(new Uint32Array(t),n))},e.prototype.reduceMeanSquare_impl=function(t,n){return new e(this.wasmTensor.reduce_mean_square(new Uint32Array(t),n))},e.prototype.conv_impl=function(t,n,r,o,i,a){if(!(t instanceof e)||void 0!==a&&!(a instanceof e))throw new Error("Can only do convolution of CPU tensor with CPU tensor");return new e(void 0!==a?this.wasmTensor.conv_with_bias(t.wasmTensor,a.wasmTensor,new Uint32Array(n),r,new Uint32Array(o),new Uint32Array(i)):this.wasmTensor.conv(t.wasmTensor,new Uint32Array(n),r,new Uint32Array(o),new Uint32Array(i)))},e.prototype.averagePool_impl=function(t,n,r,o){return new e(this.wasmTensor.average_pool(new Uint32Array(t),new Uint32Array(n),new Uint32Array(r),o))},e.prototype.reshape_impl=function(t){var n=new Uint32Array(t);return new e(this.wasmTensor.reshape(n),n)},e.prototype.concat=function(t,n){if(!(t instanceof e))throw new Error("Can only concat WASM tensor to WASM tensor");return new e(this.wasmTensor.concat(t.wasmTensor,n))},e.prototype.transpose_impl=function(t){return new e(this.wasmTensor.transpose(new Uint32Array(t)))},e.prototype.clip=function(t,n){return void 0!==t&&void 0!==n?new e(this.wasmTensor.clip(t,n)):void 0!==t?new e(this.wasmTensor.clip_min(t)):void 0!==n?new e(this.wasmTensor.clip_max(n)):this.copy()},e.prototype.repeat=function(t){return new e(this.wasmTensor.repeat(new Uint32Array(t)))},e.prototype.expand=function(t){var n=this.getShape(),r=this.alignShapes(n,t),o=r[0],i=(r[1],r[2]);return S(n,i)?this.copy():new e(this.reshape(o,!1).wasmTensor.expand(new Uint32Array(i)))},e.prototype.pad_impl=function(t,n,r){return new e(this.wasmTensor.pad(new Uint32Array(t),e.padModeToInt[n],r))},e.prototype.gather=function(t,n){return new e(this.wasmTensor.gather(t,n.values,new Uint32Array(n.shape)))},e.prototype.floor=function(){return new e(this.wasmTensor.floor())},e.prototype.ceil=function(){return new e(this.wasmTensor.ceil())},e.prototype.slice_impl=function(t,n,r){return new e(this.wasmTensor.slice(new Uint32Array(t),new Uint32Array(n),new Uint32Array(r)))},e.prototype.upsample=function(t){return new e(this.wasmTensor.upsample(new Float32Array(t)))},e.prototype.normalize=function(t,n,r,o,i){if(!(t instanceof e)||!(n instanceof e)||!(o instanceof e)||!(i instanceof e))throw new Error("Can only normalize with CPU tensors");return new e(this.wasmTensor.normalize(t.wasmTensor,n.wasmTensor,r,o.wasmTensor,i.wasmTensor))},e.padModeToInt={constant:0,reflect:1,edge:2},e}(C),In=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Cn=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function Mn(t){return In(this,void 0,void 0,(function(){var e;return Cn(this,(function(n){switch(n.label){case 0:return t instanceof Y?[2,t]:[4,t.getValues()];case 1:return e=n.sent(),[2,new Y(t.getShape(),e)]}}))}))}function Bn(t){return In(this,void 0,void 0,(function(){var e;return Cn(this,(function(n){switch(n.label){case 0:return t instanceof Tn?[2,t]:[4,t.getValues()];case 1:return e=n.sent(),t instanceof Y&&e instanceof Int32Array?[2,t]:[2,new Tn(e,new Uint32Array(t.getShape()))]}}))}))}function Xn(t,e){return In(this,void 0,void 0,(function(){var n;return Cn(this,(function(r){switch(r.label){case 0:return t instanceof Fe?[2,t]:[4,t.getValues()];case 1:return n=r.sent(),t instanceof Y&&n instanceof Int32Array?[2,t]:[2,new Fe(n,t.getShape(),e)]}}))}))}var Rn=n(1),Vn=n.n(Rn),Dn=n(14),En=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},zn=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Gn=function(){function t(t,e,n,r,o){this.attributes={};for(var i=0;i<t.length;i++)this.attributes[t[i].name]=t[i];this.inputs=e,this.outputs=n,this.onnxVersion=o,this.variableInputs=0;for(i=0;i<this.inputs.length;i++)void 0===r[this.inputs[i]]&&this.variableInputs++}return t.prototype.initialize=function(t){},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getAttributeString=function(t){var e=this.attributes[t];if(void 0!==e){var n=e.s;return void 0!==n?new TextDecoder("utf-8").decode(n):void 0}},t.prototype.getAttributeInts=function(t){if(void 0!==this.attributes[t]){for(var e=this.attributes[t].ints,n=0;n<e.length;n++)Vn.a.isLong(e[n])&&(e[n]=e[n].toNumber());return e}},t.prototype.getAttributeInt=function(t){var e=this.attributes[t];if(void 0!==e){var n=e.i;return Vn.a.isLong(n)&&(n=n.toNumber()),n}},t.prototype.getAttributeFloat=function(t){var e=this.attributes[t];if(void 0!==e)return e.f},t.prototype.getAttributeTensor=function(t){var e=this.attributes[t];if(void 0!==e)return e.t},t.prototype.toCPU=function(){return En(this,void 0,void 0,(function(){return zn(this,(function(t){return[2]}))}))},t.prototype.toWASM=function(){return En(this,void 0,void 0,(function(){return zn(this,(function(t){return[2]}))}))},t.prototype.toGPU=function(t){return En(this,void 0,void 0,(function(){return zn(this,(function(t){return[2]}))}))},t}();function Fn(t){if(void 0!==t.segment&&null!==t.segment)throw new Error("Handling of tensor proto segment not yet implemented");var e=t.dims;if(void 0===e||null===e)throw new Error("Tensor shape must be specified");for(var n=0;n<e.length;n++)Vn.a.isLong(e[n])&&(e[n]=e[n].toNumber());0===e.length&&(e=[1]);var r=O(e);if(1===t.dataType){if(t.floatData&&t.floatData.length>0)return new Y(e,t.floatData);if(t.rawData&&t.rawData.length>0){var o=t.rawData.buffer.slice(t.rawData.byteOffset,t.rawData.byteOffset+t.rawData.byteLength),i=new Float32Array(o);return new Y(e,i)}if(0===r)return new Y(e);throw new Error("Cant process float tensor without float or raw data")}if(7===t.dataType){if(t.rawData&&t.rawData.length>0){for(i=new Int32Array(t.rawData.length/8),n=0;n<t.rawData.length;n+=8){var a=Vn.a.fromBytesLE(Array.from(t.rawData.slice(n,n+8))).toNumber();i[n/8]=a}return new Y(e,i,"int")}throw new Error("Cant process int64 tensor without raw data")}throw new Error("Handling of tensor type "+t.dataType+" not yet implemented")}var Un=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Nn=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ln=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;if(i<11){var u=a.getAttributeTensor("value");a.tensor=Fn(u)}return a}return Un(e,t),e.prototype.forward=function(t){return Wn(this,void 0,void 0,(function(){return Nn(this,(function(t){if(this.onnxVersion<11)return[2,[this.tensor]];throw new Error("Constant with onnx version >= 11 not yet implemented")}))}))},e.prototype.toCPU=function(){return Wn(this,void 0,void 0,(function(){var t;return Nn(this,(function(e){switch(e.label){case 0:return t=this,[4,Mn(this.tensor)];case 1:return t.tensor=e.sent(),[2]}}))}))},e.prototype.toWASM=function(){return Wn(this,void 0,void 0,(function(){var t;return Nn(this,(function(e){switch(e.label){case 0:return t=this,[4,Bn(this.tensor)];case 1:return t.tensor=e.sent(),[2]}}))}))},e.prototype.toGPU=function(t){return Wn(this,void 0,void 0,(function(){var e;return Nn(this,(function(n){switch(n.label){case 0:return e=this,[4,Xn(this.tensor,t)];case 1:return e.tensor=n.sent(),[2]}}))}))},e.prototype.getType=function(){return"Constant"},e.prototype.delete=function(){this.tensor.delete()},e}(Gn),Hn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qn=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Jn=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Kn=function(t){function e(e,n,r,o,i,a,u,s){var p=t.call(this,e,n,r,o,i)||this;if(void 0!==p.getAttributeString("autoPad"))throw new Error("Autopad in conv not supported yet");return void 0===s&&(s="id"),p.activation=s,p.group=p.getAttributeInt("group")||1,p.dilations=p.getAttributeInts("dilations"),p.pads=p.getAttributeInts("pads"),p.strides=p.getAttributeInts("strides"),p.kernel=a,p.bias=u,p}return Hn(e,t),e.prototype.forward=function(t){return qn(this,void 0,void 0,(function(){var e,n,r;return Jn(this,(function(o){return e=t[0],n=void 0!==this.kernel?this.kernel:t[1],r=t.length>2?t[2]:this.bias,[2,[e.conv(n,r,this.dilations,this.group,this.pads,this.strides,this.activation)]]}))}))},e.prototype.getDilations=function(t){return void 0!==this.dilations?this.dilations:new Array(t).fill(1)},e.prototype.getPads=function(t){return void 0!==this.pads?this.pads:new Array(2*t).fill(0)},e.prototype.getStrides=function(t){return void 0!==this.strides?this.strides:new Array(t).fill(1)},e.prototype.getType=function(){return"Conv"},e.prototype.toCPU=function(){return qn(this,void 0,void 0,(function(){var t,e;return Jn(this,(function(n){switch(n.label){case 0:return void 0===this.kernel?[3,2]:(t=this,[4,Mn(this.kernel)]);case 1:t.kernel=n.sent(),n.label=2;case 2:return void 0===this.bias?[3,4]:(e=this,[4,Mn(this.bias)]);case 3:e.bias=n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype.toWASM=function(){return qn(this,void 0,void 0,(function(){var t,e;return Jn(this,(function(n){switch(n.label){case 0:return void 0===this.kernel?[3,2]:(t=this,[4,Bn(this.kernel)]);case 1:t.kernel=n.sent(),n.label=2;case 2:return void 0===this.bias?[3,4]:(e=this,[4,Bn(this.bias)]);case 3:e.bias=n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype.toGPU=function(t){return qn(this,void 0,void 0,(function(){var e,n;return Jn(this,(function(r){switch(r.label){case 0:return void 0===this.kernel?[3,2]:(e=this,[4,Xn(this.kernel,t)]);case 1:e.kernel=r.sent(),r.label=2;case 2:return void 0===this.bias?[3,4]:(n=this,[4,Xn(this.bias,t)]);case 3:n.bias=r.sent(),r.label=4;case 4:return[2]}}))}))},e.prototype.delete=function(){void 0!==this.kernel&&this.kernel.delete(),void 0!==this.bias&&this.bias.delete()},e}(Gn),Yn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qn=function(t){function e(e){var n=t.call(this)||this;return n.nodeTypes=e,n}return Yn(e,t),e.prototype.findApplications=function(t){var e=[],n=t.getNodes();for(var r in Object.keys(n)){var o=n[r];if(void 0!==o&&o.getType()===this.nodeTypes[0]){var i=this.checkApplication(t,r);void 0!==i&&e.push(i)}}return e},e.prototype.checkApplication=function(t,e){for(var n=t.getNodes(),r=[e],o=n[e],i=[o],a=1;a<this.nodeTypes.length;a++){var u=t.getNodeWithInput(o.outputs[0]);if(void 0===u)return;var s=n[u];if(s.getType()!==this.nodeTypes[a])return;r.push(u),o=s,i.push(o)}return this.canApply(i)?r:void 0},e.prototype.canApply=function(t){return!0},e}((function(){})),Zn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$n=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},tr=function(t){function e(){return t.call(this,["Conv","BatchNormalization"])||this}return Zn(e,t),e.prototype.apply=function(t,e,n,r){var o=t[0],i=t[1],a=e(o.inputs[1]),u=e(o.inputs[2]),s=e(i.inputs[1]),p=e(i.inputs[2]),c=e(i.inputs[3]),l=e(i.inputs[4]).add(i.epsTensor).sqrt(),h=s.divide(l);l.delete();var f=p.subtract(c.multiply(h)),y=$n(h.getShape(),new Array(a.getShape().length-h.getShape().length).fill(1)),d=a.multiply(h.reshape(y,!1)),m=f;if(void 0!==u){var g=u.multiply(h);m=m.add(g),g.delete()}return new Kn(Object.entries(o.attributes).map((function(t){return t[1]})),[o.inputs[0]],i.outputs,n,r,d,m)},e}(Qn),er=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nr=function(t){function e(){return t.call(this,["Conv","Relu"])||this}return er(e,t),e.prototype.apply=function(t,e,n,r){var o=t[0],i=t[1];return new Kn(Object.entries(o.attributes).map((function(t){return t[1]})),o.inputs,i.outputs,n,r,o.kernel,o.bias,"relu")},e}(Qn),rr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),or=function(t){function e(){return t.call(this,["Conv","Clip"])||this}return rr(e,t),e.prototype.apply=function(t,e,n,r){var o=t[0],i=t[1];return new Kn(Object.entries(o.attributes).map((function(t){return t[1]})),o.inputs,i.outputs,n,r,o.kernel,o.bias,"relu6")},e.prototype.canApply=function(t){var e=t[1];return 0===e.min&&6===e.max},e}(Qn),ir=[new tr,new nr,new or],ar=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ur=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},sr=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},pr=function(t){function e(e,n,r,o,i){return t.call(this,e,n,r,o,i)||this}return ar(e,t),e.prototype.forward=function(t){return ur(this,void 0,void 0,(function(){var e,n;return sr(this,(function(r){if(this.onnxVersion<13&&this.onnxVersion>=7)return e=t[0],n=t[1],[2,[this.compute(e,n)]];throw new Error(this.name+" not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return this.name},e.prototype.delete=function(){},e}(Gn),cr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),lr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="Add",a}return cr(e,t),e.prototype.compute=function(t,e){return t.add(e)},e}(pr),hr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},yr=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},dr=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},mr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.epsilon=a.getAttributeFloat("epsilon")||1e-5,a.momentum=a.getAttributeFloat("momentum")||.9,a.epsTensor=new Y([1],[a.epsilon]),a}return hr(e,t),e.prototype.initialize=function(t){var e=t(this.inputs[1]),n=t(this.inputs[2]),r=t(this.inputs[3]),o=t(this.inputs[4]);void 0!==e&&void 0!==n&&void 0!==r&&void 0!==o&&o.add(this.epsTensor).sqrt().delete()},e.prototype.defaultForward=function(t){return fr(this,void 0,void 0,(function(){var e,n,r,o,i,a,u;return yr(this,(function(s){return e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=n.getShape()[0],u=dr([1,a],new Array(e.getShape().length-2).fill(1)),n=n.reshape(u,!1),r=r.reshape(u,!1),o=o.reshape(u,!1),i=i.reshape(u,!1),[2,[e.normalize(o,i,this.epsilon,n,r)]]}))}))},e.prototype.forward=function(t){return fr(this,void 0,void 0,(function(){return yr(this,(function(e){return[2,this.defaultForward(t)]}))}))},e.prototype.getType=function(){return"BatchNormalization"},e.prototype.toCPU=function(){return fr(this,void 0,void 0,(function(){var t;return yr(this,(function(e){switch(e.label){case 0:return t=this,[4,Mn(this.epsTensor)];case 1:return t.epsTensor=e.sent(),[2]}}))}))},e.prototype.toWASM=function(){return fr(this,void 0,void 0,(function(){var t;return yr(this,(function(e){switch(e.label){case 0:return t=this,[4,Bn(this.epsTensor)];case 1:return t.epsTensor=e.sent(),[2]}}))}))},e.prototype.toGPU=function(t){return fr(this,void 0,void 0,(function(){var e;return yr(this,(function(n){switch(n.label){case 0:return e=this,[4,Xn(this.epsTensor,t)];case 1:return e.epsTensor=n.sent(),[2]}}))}))},e.prototype.delete=function(){this.epsTensor.delete()},e}(Gn);function gr(t,e){if(t.type===e)return t;if("float"===e){for(var n=new Float32Array(t.size),r=0;r<t.size;r++)n[r]=t.get(r);return new Y(t.shape,n,e)}for(n=new Int32Array(t.size),r=0;r<t.size;r++)n[r]=t.get(r);return new Y(t.shape,n,e)}var vr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},br=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},xr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.to=a.getAttributeString("to"),a}return vr(e,t),e.prototype.forward=function(t){return wr(this,void 0,void 0,(function(){var e;return br(this,(function(n){if((e=t[0])instanceof Y)return[2,[gr(e,this.to)]];throw new Error("Can only cast CPU tensors right now")}))}))},e.prototype.getType=function(){return"Cast"},e.prototype.delete=function(){},e}(Gn),_r=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Or=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},kr=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ar=function(t){function e(e,n,r,o,i){return t.call(this,e,n,r,o,i)||this}return _r(e,t),e.prototype.forward=function(t){return Or(this,void 0,void 0,(function(){var e;return kr(this,(function(n){return e=t[0],[2,[this.compute(e)]]}))}))},e.prototype.getType=function(){return this.name},e.prototype.delete=function(){},e}(Gn),Sr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="Ceil",a}return Sr(e,t),e.prototype.compute=function(t){return t.ceil()},e}(Ar),jr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ir=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Cr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return i<11&&(a.min=a.getAttributeFloat("min"),a.max=a.getAttributeFloat("max")),a}return jr(e,t),e.prototype.forward=function(t){return Tr(this,void 0,void 0,(function(){var e,n,r;return Ir(this,(function(o){if(e=t[0],this.onnxVersion<11)return[2,[e.clip(this.min,this.max)]];if(n=t.length>1?t[1]:void 0,r=t.length>2?t[2]:void 0,void 0===n&&void 0===r)return[2,[e.copy()]];throw new Error("Clip with onnx version >= 11 not yet implemented")}))}))},e.prototype.getType=function(){return"Clip"},e.prototype.delete=function(){},e}(Gn),Mr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Br=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Xr=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Rr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return i<13&&(a.axis=a.getAttributeInt("axis")),a}return Mr(e,t),e.prototype.forward=function(t){return Br(this,void 0,void 0,(function(){var e,n,r;return Xr(this,(function(o){for(t.length,e=t[0],n=1;n<t.length;n++)r=e.concat(t[n],this.axis),n>1&&e.delete(),e=r;return[2,[e]]}))}))},e.prototype.getType=function(){return"Concat"},e.prototype.delete=function(){},e}(Gn),Vr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Er=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},zr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;if(i<11){var u=a.getAttributeTensor("value");a.tensor=Fn(u)}return a}return Vr(e,t),e.prototype.forward=function(t){return Dr(this,void 0,void 0,(function(){var e,n,r,o,i;return Er(this,(function(a){if(!((e=t[0])instanceof Y))throw new Error("ConstantOfShape needs cpu tensor as shape tensor");for(n=new Array(e.size),r=0;r<e.size;r++)n[r]=e.get(r);return o=O(n),i=new Float32Array(o).fill(this.tensor.get(0)),[2,[new Y(n,i,this.tensor.type)]]}))}))},e.prototype.getType=function(){return"ConstantOfShape"},e.prototype.delete=function(){this.tensor.delete()},e}(Gn),Gr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="Div",a}return Gr(e,t),e.prototype.compute=function(t,e){return t.divide(e)},e}(pr),Ur=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="Exp",a}return Ur(e,t),e.prototype.compute=function(t){return t.exp()},e}(Ar),Nr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Hr=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},qr=function(t){function e(e,n,r,o,i){return t.call(this,e,n,r,o,i)||this}return Nr(e,t),e.prototype.forward=function(t){return Lr(this,void 0,void 0,(function(){var e,n,r,o;return Hr(this,(function(i){if(this.onnxVersion<13){if(e=t[0],!((n=t[1])instanceof Y))throw new Error("Expand needs cpu tensor as shape tensor");for(r=new Array(n.size),o=0;o<n.size;o++)r[o]=n.get(o);return[2,[e.expand(r)]]}throw new Error("Expand not yet implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Expand"},e.prototype.delete=function(){},e}(Gn),Jr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kr=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="Floor",a}return Jr(e,t),e.prototype.compute=function(t){return t.floor()},e}(Ar),Yr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qr=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Zr=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},$r=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.axis=a.getAttributeInt("axis")||0,a}return Yr(e,t),e.prototype.forward=function(t){return Qr(this,void 0,void 0,(function(){var e,n;return Zr(this,(function(r){if(e=t[0],!((n=t[1])instanceof Y))throw new Error("Gather requires CPU tensor for the indices");return[2,[e.gather(this.axis,n)]]}))}))},e.prototype.getType=function(){return"Gather"},e.prototype.delete=function(){},e}(Gn),to=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),eo=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},no=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ro=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;a.alpha=a.getAttributeFloat("alpha")||1,a.beta=a.getAttributeFloat("beta")||1;var u=a.getAttributeInt("transA"),s=a.getAttributeInt("transB");return a.transA=1===u,a.transB=1===s,a}return to(e,t),e.prototype.forward=function(t){return eo(this,void 0,void 0,(function(){var e,n,r;return no(this,(function(o){if(this.onnxVersion>=9&&this.onnxVersion<11)return e=t[0],n=t[1],r=t[2],[2,[e.gemm(n,this.transA,this.transB,this.alpha,r,this.beta)]];throw new Error("Gemm is not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Gemm"},e.prototype.delete=function(){},e}(Gn),oo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),io=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},ao=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},uo=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},so=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.epsilon=a.getAttributeFloat("epsilon")||1e-5,a}return oo(e,t),e.prototype.defaultForward=function(t){return io(this,void 0,void 0,(function(){var e,n,r,o,i,a,u,s,p,c,l,h;return ao(this,(function(f){for(e=t[0],n=t[1],r=t[2],o=e.getShape().length-2,i=n.getShape()[0],a=uo([1,i],new Array(o).fill(1)),n=n.reshape(a,!1),r=r.reshape(a,!1),u=new Array(e.getShape().length-2),s=0;s<o;s++)u[s]=s+2;return p=e.reduceMean(u,!0),nt.flush(),c=e.subtract(p),nt.flush(),l=c.reduceMeanSquare(u,!0),nt.flush(),h=e.normalize(p,l,this.epsilon,n,r),p.delete(),c.delete(),l.delete(),[2,[h]]}))}))},e.prototype.forward=function(t){return io(this,void 0,void 0,(function(){return ao(this,(function(e){return[2,this.defaultForward(t)]}))}))},e.prototype.getType=function(){return"InstanceNormalization"},e.prototype.delete=function(){},e}(Gn),po=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),co=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},lo=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ho=function(t){function e(e,n,r,o,i){return t.call(this,e,n,r,o,i)||this}return po(e,t),e.prototype.forward=function(t){return co(this,void 0,void 0,(function(){var e,n;return lo(this,(function(r){if(e=t[0],n=t[1],this.onnxVersion<13&&this.onnxVersion>=9){if(e.getShape().length!==n.getShape().length)throw new Error("Automatic broadcasting in MatMul not supported yet");return[2,[e.gemm(n)]]}throw new Error("Matmul with onnx version "+this.onnxVersion+" not yet implemented")}))}))},e.prototype.getType=function(){return"MatMul"},e.prototype.delete=function(){},e}(Gn),fo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yo=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="Mul",a}return fo(e,t),e.prototype.compute=function(t,e){return t.multiply(e)},e}(pr),mo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),go=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},vo=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},wo=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.mode=a.getAttributeString("mode")||"constant",a.pads=a.getAttributeInts("pads"),a.value=a.getAttributeFloat("value")||0,a}return mo(e,t),e.prototype.forward=function(t){return go(this,void 0,void 0,(function(){return vo(this,(function(e){if(this.onnxVersion<11)return[2,[t[0].pad(this.pads,this.mode,this.value)]];throw new Error("Pad not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Pad"},e.prototype.delete=function(){},e}(Gn),bo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xo=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},_o=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Oo=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;a.axes=a.getAttributeInts("axes");var u=a.getAttributeInt("keepdims");return a.keepDims=1===u||void 0===u,a}return bo(e,t),e.prototype.getAxes=function(t){if(void 0!==this.axes)return this.axes;for(var e=t.getShape().length,n=new Array(e),r=0;r<e;r++)n[r]=r;return n},e.prototype.forward=function(t){return xo(this,void 0,void 0,(function(){return _o(this,(function(e){if(this.onnxVersion<11)return[2,[this.calc(t[0])]];throw new Error(this.name+" is not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return this.name},e.prototype.delete=function(){},e}(Gn),ko=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ao=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="ReduceMax",a}return ko(e,t),e.prototype.calc=function(t){return t.max(this.axes,this.keepDims)},e}(Oo),So=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Po=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="ReduceMean",a}return So(e,t),e.prototype.calc=function(t){return t.reduceMean(this.axes,this.keepDims)},e}(Oo),jo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),To=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="ReduceSum",a}return jo(e,t),e.prototype.calc=function(t){return t.sum(this.axes,this.keepDims)},e}(Oo),Io=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Co=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="ReduceSumSquare",a}return Io(e,t),e.prototype.calc=function(t){return t.sumSquare(this.axes,this.keepDims)},e}(Oo),Mo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bo=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.max=void 0,a.min=0,a}return Mo(e,t),e.prototype.getType=function(){return"Relu"},e}(Cr),Xo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ro=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Vo=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Do=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return i<13&&(a.shape=a.getAttributeInts("shape")),a}return Xo(e,t),e.prototype.forward=function(t){return Ro(this,void 0,void 0,(function(){var e,n,r,o;return Vo(this,(function(i){if(e=t[0],!((n=t[1])instanceof Y))throw new Error("Reshape only works with CPU tensor as shape tensor");if(this.onnxVersion<13){for(r=new Array(n.size),o=0;o<n.size;o++)r[o]=n.get(o);return[2,[e.reshape(r)]]}throw new Error("Reshape with onnx version "+this.onnxVersion+" not yet implemented")}))}))},e.prototype.getType=function(){return"Reshape"},e.prototype.delete=function(){},e}(Gn),Eo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zo=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Go=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Fo=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Uo=function(t){function e(e,n,r,o,i){return t.call(this,e,n,r,o,i)||this}return Eo(e,t),e.prototype.forward=function(t){return zo(this,void 0,void 0,(function(){var e,n;return Go(this,(function(r){if(this.onnxVersion<13)return e=t[0],n=e.getShape(),[2,[new Y([n.length],Fo(n),"int")]];throw new Error("Shape not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Shape"},e.prototype.delete=function(){},e}(Gn),Wo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),No=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Lo=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ho=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.axes=a.getAttributeInts("axes"),a.starts=a.getAttributeInts("starts"),a.ends=a.getAttributeInts("ends"),a}return Wo(e,t),e.prototype.forward=function(t){return No(this,void 0,void 0,(function(){return Lo(this,(function(e){if(this.onnxVersion<11)return[2,[t[0].slice(this.starts,this.ends,this.axes)]];throw new Error("Slice not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Slice"},e.prototype.delete=function(){},e}(Gn),qo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jo=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ko=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Yo=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.axis=a.getAttributeInt("axis"),a}return qo(e,t),e.prototype.defaultForward=function(t){return Jo(this,void 0,void 0,(function(){var e,n,r,o,i,a,u,s,p,c;return Ko(this,(function(l){return e=t[0],n=e.getShape(),void 0===(r=this.axis)&&(r=this.onnxVersion<13?1:n.length-1),o=n.slice(0,r).reduce((function(t,e){return t*e}),1),i=e.reshape([o,-1],!1),a=i.max(1,!0),u=i.subtract(a),s=u.exp(),p=s.sum(1,!0),c=s.divide(p),a.delete(),u.delete(),s.delete(),p.delete(),[2,[c.reshape(n,!1)]]}))}))},e.prototype.forward=function(t){return Jo(this,void 0,void 0,(function(){return Ko(this,(function(e){return[2,this.defaultForward(t)]}))}))},e.prototype.getType=function(){return"Softmax"},e.prototype.delete=function(){},e}(Gn),Qo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zo=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.name="Sub",a}return Qo(e,t),e.prototype.compute=function(t,e){return t.subtract(e)},e}(pr),$o=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ti=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},ei=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ni=function(t){function e(e,n,r,o,i){return t.call(this,e,n,r,o,i)||this}return $o(e,t),e.prototype.forward=function(t){return ti(this,void 0,void 0,(function(){var e,n,r,o;return ei(this,(function(i){if(e=t[0],!((n=t[1])instanceof Y))throw new Error("Tile only works with CPU tensor as repeats");if(this.onnxVersion<13&&this.onnxVersion>=6){for(r=new Array(n.size),o=0;o<n.size;o++)r[o]=n.get(o);return[2,[e.repeat(r)]]}throw new Error("Tile with onnx version "+this.onnxVersion+" not yet implemented")}))}))},e.prototype.getType=function(){return"Tile"},e.prototype.delete=function(){},e}(Gn),ri=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},ii=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ai=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return a.permutation=a.getAttributeInts("perm"),a}return ri(e,t),e.prototype.forward=function(t){return oi(this,void 0,void 0,(function(){return ii(this,(function(e){return[2,[t[0].transpose(this.permutation)]]}))}))},e.prototype.getType=function(){return"Transpose"},e.prototype.delete=function(){},e}(Gn),ui=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),si=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},pi=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ci=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;return i<13&&(a.axes=a.getAttributeInts("axes")),a}return ui(e,t),e.prototype.forward=function(t){return si(this,void 0,void 0,(function(){var e,n,r,o,i;return pi(this,(function(a){if(e=t[0],this.onnxVersion<13){for(n=e.getShape(),r=[],o=0,i=0;i<n.length;i++)o<this.axes.length&&this.axes[o]===i&&(r.push(1),o++),r.push(n[i]);return this.axes[this.axes.length-1]===n.length&&r.push(1),[2,[e.reshape(r)]]}throw new Error("Unsqueeze with onnx version "+this.onnxVersion+" not yet implemented")}))}))},e.prototype.getType=function(){return"Unsqueeze"},e.prototype.delete=function(){},e}(Gn),li=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},fi=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},yi=function(t){function e(e,n,r,o,i){var a=t.call(this,e,n,r,o,i)||this;if(a.mode=a.getAttributeString("mode"),"nearest"!==a.mode)throw new Error("Upsampling only supported with nearest neighbor sampling");return a}return li(e,t),e.prototype.getScales=function(t){return hi(this,void 0,void 0,(function(){var e,n,r;return fi(this,(function(o){switch(o.label){case 0:return t instanceof Y?[3,2]:(console.warn("Scales tensor for upsample not on CPU, need to transfer!"),[4,Mn(t)]);case 1:t=o.sent(),o.label=2;case 2:for(e=t,n=new Array(e.size),r=0;r<e.size;r++)n[r]=e.get(r);return[2,n]}}))}))},e.prototype.forward=function(t){return hi(this,void 0,void 0,(function(){var e,n,r;return fi(this,(function(o){switch(o.label){case 0:return e=t[0],n=t[1],[4,this.getScales(n)];case 1:return r=o.sent(),[2,[e.upsample(r)]]}}))}))},e.prototype.getType=function(){return"Upsample"},e.prototype.delete=function(){},e}(Gn),di=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},gi=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},vi=function(t){function e(e,n,r,o,i){return t.call(this,e,n,r,o,i)||this}return di(e,t),e.prototype.forward=function(t){return mi(this,void 0,void 0,(function(){var e,n,r;return gi(this,(function(o){for(e=t[0],n=new Array(e.getShape().length-2),r=0;r<e.getShape().length-2;r++)n[r]=r+2;return[2,[e.reduceMean(n,!0)]]}))}))},e.prototype.getType=function(){return"GlobalAveragePool"},e.prototype.delete=function(){},e}(Gn),wi={Conv:function(t,e,n,r,o){return new Kn(t,e,n,r,o)},BatchNormalization:function(t,e,n,r,o){return new mr(t,e,n,r,o)},Clip:function(t,e,n,r,o){return new Cr(t,e,n,r,o)},Add:function(t,e,n,r,o){return new lr(t,e,n,r,o)},ReduceMean:function(t,e,n,r,o){return new Po(t,e,n,r,o)},Gemm:function(t,e,n,r,o){return new ro(t,e,n,r,o)},Constant:function(t,e,n,r,o){return new Ln(t,e,n,r,o)},Reshape:function(t,e,n,r,o){return new Do(t,e,n,r,o)},Tile:function(t,e,n,r,o){return new ni(t,e,n,r,o)},MatMul:function(t,e,n,r,o){return new ho(t,e,n,r,o)},Exp:function(t,e,n,r,o){return new Wr(t,e,n,r,o)},ReduceSum:function(t,e,n,r,o){return new To(t,e,n,r,o)},ReduceMax:function(t,e,n,r,o){return new Ao(t,e,n,r,o)},ReduceSumSquare:function(t,e,n,r,o){return new Co(t,e,n,r,o)},Sub:function(t,e,n,r,o){return new Zo(t,e,n,r,o)},Mul:function(t,e,n,r,o){return new yo(t,e,n,r,o)},Div:function(t,e,n,r,o){return new Fr(t,e,n,r,o)},Unsqueeze:function(t,e,n,r,o){return new ci(t,e,n,r,o)},Concat:function(t,e,n,r,o){return new Rr(t,e,n,r,o)},ConstantOfShape:function(t,e,n,r,o){return new zr(t,e,n,r,o)},Expand:function(t,e,n,r,o){return new qr(t,e,n,r,o)},InstanceNormalization:function(t,e,n,r,o){return new so(t,e,n,r,o)},Pad:function(t,e,n,r,o){return new wo(t,e,n,r,o)},Relu:function(t,e,n,r,o){return new Bo(t,e,n,r,o)},Shape:function(t,e,n,r,o){return new Uo(t,e,n,r,o)},Gather:function(t,e,n,r,o){return new $r(t,e,n,r,o)},Cast:function(t,e,n,r,o){return new xr(t,e,n,r,o)},Floor:function(t,e,n,r,o){return new Kr(t,e,n,r,o)},Ceil:function(t,e,n,r,o){return new Pr(t,e,n,r,o)},Slice:function(t,e,n,r,o){return new Ho(t,e,n,r,o)},Upsample:function(t,e,n,r,o){return new yi(t,e,n,r,o)},Transpose:function(t,e,n,r,o){return new ai(t,e,n,r,o)},Softmax:function(t,e,n,r,o){return new Yo(t,e,n,r,o)},GlobalAveragePool:function(t,e,n,r,o){return new vi(t,e,n,r,o)}},bi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},xi=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},_i=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Oi=function(){function t(t,e){var n;this.inputSet=new Set,this.nodes={},this.nodeIds=[],this.defaultReady=[],this.intermediaries={},this.constants={},this.nodeIdCounter=1e4,void 0===e&&(e={}),this.noConvertConstants=new Set(void 0!==e.noConvertConstants?e.noConvertConstants:[]),this.noConvertNodes=new Set(void 0!==e.noConvertNodes?e.noConvertNodes:[]),this.precision=e.precision||32,n=t instanceof ArrayBuffer?new Uint8Array(t):t,this.modelProto=Dn.onnx.ModelProto.decode(n);var r=this.modelProto.opsetImport[0].version;Vn.a.isLong(r)&&(r=r.toNumber()),this.version=r,this.inputs=this.modelProto.graph.input;for(var o=0;o<this.inputs.length;o++)this.inputSet.add(this.inputs[o].name);this.outputs=this.modelProto.graph.output.map((function(t){return t.name})),this.initializer(this.modelProto.graph.initializer),this.initNodes(this.modelProto)}return t.prototype.initNodes=function(t){for(var e=this,n=0;n<t.graph.node.length;n++){var r=t.graph.node[n],o=wi[r.opType];if(void 0===o)throw new Error("Node operator "+r.opType+" can not be resolved");var i=r.attribute||[],a=r.input||[],u=o(i,a,r.output||[],this.constants,this.version);this.nodes[n]=u,this.nodeIds.push(n);for(var s=0;s<a.length;s++){var p=a[s];void 0===this.intermediaries[p]&&(this.intermediaries[p]={to:[],deletable:!0}),this.intermediaries[p].to.push(n)}0===u.variableInputs&&this.defaultReady.push(n),"Constant"===r.opType&&(void 0===this.intermediaries[r.output[0]]?this.intermediaries[r.output[0]]={to:[],deletable:!1}:this.intermediaries[r.output[0]].deletable=!1)}for(var c=0,l=this.nodeIds;c<l.length;c++){var h=l[c];this.nodes[h].initialize((function(t){return e.resolveConstant(t)}))}},t.prototype.initializer=function(t){for(var e=0;e<t.length;e++){var n=t[e],r=Fn(n);this.constants[n.name]=r}},t.prototype.forward=function(t,e){return bi(this,void 0,void 0,(function(){var n,r,o,i,a,u,s,p,c,l,h,f,y,d,m=this;return xi(this,(function(g){switch(g.label){case 0:for(n={},r={},o=0,i=this.nodeIds;o<i.length;o++)d=i[o],r[d]={variableInputs:0};a=_i(this.defaultReady),this.initializeForward(t,n,r,a),g.label=1;case 1:if(!(a.length>0))return[3,8];u=a.shift(),s=this.nodes[u],p=this.getInputsToNode(s,n),c=p.inputs,l=p.toDelete,h=void 0,g.label=2;case 2:return g.trys.push([2,4,,5]),[4,s.forward(c)];case 3:return h=g.sent(),[3,5];case 4:throw f=g.sent(),console.error("Error occurred in node "+u+" with inputs "+s.inputs+" from nodes "+s.inputs.map((function(t){return m.getNodeWithOutput(t)}))),f;case 5:for(nt.flush(),this.propagateResults(s,n,h,r,a),d=0;d<l.length;d++)this.inputSet.has(l[d])||(n[l[d]].value.delete(),delete n[l[d]]);return void 0===e?[3,7]:[4,new Promise((function(t,n){setTimeout(t,e)}))];case 6:g.sent(),g.label=7;case 7:return[3,1];case 8:for(y=[],d=0;d<this.outputs.length;d++)y.push(n[this.outputs[d]].value);return[2,y]}}))}))},t.prototype.initializeForward=function(t,e,n,r){for(var o=0;o<t.length;o++){e[this.inputs[o].name]={value:t[o],used:0};for(var i=this.intermediaries[this.inputs[o].name],a=0;a<i.to.length;a++){var u=i.to[a];n[u].variableInputs++,n[u].variableInputs===this.nodes[u].variableInputs&&(r.push(u),delete n[u])}}},t.prototype.getInputsToNode=function(t,e){for(var n=[],r=[],o=0;o<t.inputs.length;o++){var i=t.inputs[o];if(void 0!==this.constants[i])n.push(this.constants[i]);else{var a=e[i];a.used++,a.used>=this.intermediaries[i].to.length&&this.intermediaries[i].deletable&&r.push(i),n.push(a.value)}}return{inputs:n,toDelete:r}},t.prototype.propagateResults=function(t,e,n,r,o){for(var i=0;i<t.outputs.length;i++){var a=t.outputs[i];e[a]={value:n[i],used:0};var u=this.intermediaries[a];if(void 0!==u)for(var s=0;s<u.to.length;s++){var p=u.to[s];r[p].variableInputs++,r[p].variableInputs===this.nodes[p].variableInputs&&(o.push(p),delete r[p])}}},t.prototype.toCPU=function(){return bi(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return xi(this,(function(s){switch(s.label){case 0:for(e in t=[],this.constants)t.push(e);n=0,s.label=1;case 1:return n<t.length?(u=t[n],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,Mn(this.constants[u])])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return n++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toCPU()]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},t.prototype.toWASM=function(){return bi(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return xi(this,(function(s){switch(s.label){case 0:for(e in t=[],this.constants)t.push(e);n=0,s.label=1;case 1:return n<t.length?(u=t[n],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,Bn(this.constants[u])])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return n++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toWASM()]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},t.prototype.toGPU=function(){return bi(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return xi(this,(function(s){switch(s.label){case 0:for(e in t=[],this.constants)t.push(e);n=0,s.label=1;case 1:return n<t.length?(u=t[n],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,Xn(this.constants[u],this.precision)])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return n++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toGPU(this.precision)]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},t.prototype.optimize=function(){for(var t=this,e=0,n=ir;e<n.length;e++)for(var r=n[e],o=0,i=r.findApplications(this);o<i.length;o++){for(var a=i[o],u=a.map((function(e){return t.nodes[e]})),s=r.apply(u,(function(e){return t.resolveConstant(e)}),this.constants,this.version),p=new Set(s.outputs),c=0,l=a;c<l.length;c++){var h=l[c];this.removeNode(h,p)}this.insertNode(s)}this.prune()},t.prototype.prune=function(){for(var t=this;;){var e=this.pruneIntermediaries();if(!(e.size>0))break;e.forEach((function(e){t.removeNode(e,new Set)}))}},t.prototype.pruneIntermediaries=function(){var t=new Set,e=[];for(var n in this.intermediaries){if(0===this.intermediaries[n].to.length){e.push(n);var r=this.getNodeWithOutput(n);void 0!==r&&t.add(r)}}for(var o=0,i=e;o<i.length;o++){n=i[o];delete this.intermediaries[n]}return t},t.prototype.removeNode=function(t,e){for(var n=this.nodes[t],r=0,o=n.inputs;r<o.length;r++){var i=o[r];void 0!==this.intermediaries[i]&&(this.intermediaries[i].to=this.intermediaries[i].to.filter((function(e){return e.toString()!==t.toString()})))}e.has(n.outputs[0])||delete this.intermediaries[n.outputs[0]],this.nodeIds=this.nodeIds.filter((function(e){return e.toString()!==t.toString()})),this.nodes[t].delete(),delete this.nodes[t]},t.prototype.insertNode=function(t){var e=this.nodeIdCounter++;this.nodeIds.push(e),this.nodes[e]=t;for(var n=0,r=t.inputs;n<r.length;n++){var o=r[n];this.intermediaries[o].to.push(e)}},t.prototype.getNodeWithOutput=function(t){for(var e=0,n=this.nodeIds;e<n.length;e++){var r=n[e];if(-1!==this.nodes[r].outputs.findIndex((function(e){return e===t})))return r}},t.prototype.getNodeWithInput=function(t){for(var e=0,n=this.nodeIds;e<n.length;e++){var r=n[e];if(-1!==this.nodes[r].inputs.findIndex((function(e){return e===t})))return r}},t.prototype.resolveConstant=function(t){if(void 0!==this.constants[t])return this.constants[t];var e=this.getNodeWithOutput(t),n=this.nodes[e];return n instanceof Ln?n.tensor:void 0},t.prototype.getNodes=function(){return this.nodes},t.prototype.delete=function(){for(var t in this.constants)this.constants[t].delete();for(var e=0,n=this.nodeIds;e<n.length;e++){var r=n[e];this.nodes[r].delete()}},t}();function ki(){return(ki=Object(v.a)(d.a.mark((function t(e){var n,r,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("models/".concat(e,".onnx"));case 2:return n=t.sent,t.next=5,n.arrayBuffer();case 5:return r=t.sent,o=new s.model.OnnxModel(r,{noConvertNodes:[69,98],precision:16}),t.next=9,o.toGPU();case 9:return t.abrupt("return",o);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ai=["Tench","Goldfish","Great white shark","Tiger shark","Hammerhead","Electric ray","Stingray","Cock","Hen","Ostrich","Brambling","Goldfinch","House finch","Junco","Indigo bunting","Robin","Bulbul","Jay","Magpie","Chickadee","Water ouzel","Kite","Bald eagle","Vulture","Great grey owl","Europeafire salamander","Commonewt","Eft","Spotted salamander","Axolotl","Bullfrog","Tree frog","Tailed frog","Loggerhead","Leatherback turtle","Mud turtle","Terrapin","Box turtle","Banded gecko","Commoiguana","Americachameleon","Whiptail","Agama","Frilled lizard","Alligator lizard","Gila monster","Greelizard","Africachameleon","Komodo dragon","Africacrocodile","Americaalligator","Triceratops","Thunder snake","Ringneck snake","Hognose snake","Greesnake","King snake","Garter snake","Water snake","Vine snake","Night snake","Boa constrictor","Rock python","Indiacobra","Greemamba","Sea snake","Horned viper","Diamondback","Sidewinder","Trilobite","Harvestman","Scorpion","Black and gold gardespider","Barspider","Gardespider","Black widow","Tarantula","Wolf spider","Tick","Centipede","Black grouse","Ptarmigan","Ruffed grouse","Prairie chicken","Peacock","Quail","Partridge","Africagrey","Macaw","Sulphur-crested cockatoo","Lorikeet","Coucal","Bee eater","Hornbill","Hummingbird","Jacamar","Toucan","Drake","Red-breasted merganser","Goose","Black swan","Tusker","Echidna","Platypus","Wallaby","Koala","Wombat","Jellyfish","Sea anemone","Braicoral","Flatworm","Nematode","Conch","Snail","Slug","Sea slug","Chiton","Chambered nautilus","Dungeness crab","Rock crab","Fiddler crab","King crab","Americalobster","Spiny lobster","Crayfish","Hermit crab","Isopod","White stork","Black stork","Spoonbill","Flamingo","Little blue heron","Americaegret","Bittern","Crane","Limpkin","Europeagallinule","Americacoot","Bustard","Ruddy turnstone","Red-backed sandpiper","Redshank","Dowitcher","Oystercatcher","Pelican","King penguin","Albatross","Grey whale","Killer whale","Dugong","Sea lion","Chihuahua","Japanese spaniel","Maltese dog","Pekinese","Shih-Tzu","Blenheim spaniel","Papillon","Toy terrier","Rhodesiaridgeback","Afghahound","Basset","Beagle","Bloodhound","Bluetick","Black-and-tacoonhound","Walker hound","English foxhound","Redbone","Borzoi","Irish wolfhound","Italiagreyhound","Whippet","Ibizahound","Norwegiaelkhound","Otterhound","Saluki","Scottish deerhound","Weimaraner","Staffordshire bullterrier","AmericaStaffordshire terrier","Bedlingtoterrier","Border terrier","Kerry blue terrier","Irish terrier","Norfolk terrier","Norwich terrier","Yorkshire terrier","Wire-haired fox terrier","Lakeland terrier","Sealyham terrier","Airedale","Cairn","Australiaterrier","Dandie Dinmont","Bostobull","Miniature schnauzer","Giant schnauzer","Standard schnauzer","Scotch terrier","Tibetaterrier","Silky terrier","Soft-coated wheateterrier","West Highland white terrier","Lhasa","Flat-coated retriever","Curly-coated retriever","Golderetriever","Labrador retriever","Chesapeake Bay retriever","Germashort-haired pointer","Vizsla","English setter","Irish setter","Gordosetter","Brittany spaniel","Clumber","English springer","Welsh springer spaniel","Cocker spaniel","Sussex spaniel","Irish water spaniel","Kuvasz","Schipperke","Groenendael","Malinois","Briard","Kelpie","Komondor","Old English sheepdog","Shetland sheepdog","Collie","Border collie","Bouvier des Flandres","Rottweiler","Germashepherd","Doberman","Miniature pinscher","Greater Swiss Mountaidog","Bernese mountaidog","Appenzeller","EntleBucher","Boxer","Bull mastiff","Tibetamastiff","French bulldog","Great Dane","Saint Bernard","Eskimo dog","Malamute","Siberiahusky","Dalmatian","Affenpinscher","Basenji","Pug","Leonberg","Newfoundland","Great Pyrenees","Samoyed","Pomeranian","Chow","Keeshond","Brabancogriffon","Pembroke","Cardigan","Toy poodle","Miniature poodle","Standard poodle","Mexicahairless","Timber wolf","White wolf","Red wolf","Coyote","Dingo","Dhole","Africahunting dog","Hyena","Red fox","Kit fox","Arctic fox","Grey fox","Tabby","Tiger cat","Persiacat","Siamese cat","Egyptiacat","Cougar","Lynx","Leopard","Snow leopard","Jaguar","Lion","Tiger","Cheetah","Browbear","Americablack bear","Ice bear","Sloth bear","Mongoose","Meerkat","Tiger beetle","Ladybug","Ground beetle","Long-horned beetle","Leaf beetle","Dung beetle","Rhinoceros beetle","Weevil","Fly","Bee","Ant","Grasshopper","Cricket","Walking stick","Cockroach","Mantis","Cicada","Leafhopper","Lacewing","Dragonfly's darning needle","Damselfly","Admiral","Ringlet","Monarch","Cabbage butterfly","Sulphur butterfly","Lycaenid","Starfish","Sea urchin","Sea cucumber","Wood rabbit","Hare","Angora","Hamster","Porcupine","Fox squirrel","Marmot","Beaver","Guinea pig","Sorrel","Zebra","Hog","Wild boar","Warthog","Hippopotamus","Ox","Water buffalo","Bison","Ram","Bighorn","Ibex","Hartebeest","Impala","Gazelle","Arabiacamel","Llama","Weasel","Mink","Polecat","Black-footed ferret","Otter","Skunk","Badger","Armadillo","Three-toed sloth","Orangutan","Gorilla","Chimpanzee","Gibbon","Siamang","Guenon","Patas","Baboon","Macaque","Langur","Colobus","Proboscis monkey","Marmoset","Capuchin","Howler monkey","Titi","Spider monkey","Squirrel monkey","Madagascar cat","Indri","Indiaelephant","Africaelephant","Lesser panda","Giant panda","Barracouta","Eel","Coho","Rock beauty","Anemone fish","Sturgeon","Gar","Lionfish","Puffer","Abacus","Abaya","Academic gown's robe","Accordion","Acoustic guitar","Aircraft carrier","Airliner","Airship","Altar","Ambulance","Amphibian","Analog clock","Apiary","Apron","Ashcan","Assault rifle","Backpack","Bakery","Balance beam","Balloon","Ballpoint","Band Aid","Banjo","Bannister","Barbell","Barber chair","Barbershop","Barn","Barometer","Barrel","Barrow","Baseball","Basketball","Bassinet","Bassoon","Bathing cap","Bath towel","Bathtub","Beach wagon","Beacon","Beaker","Bearskin","Beer bottle","Beer glass","Bell cote","Bib","Bicycle-built-for-two","Bikini","Binder","Binoculars","Birdhouse","Boathouse","Bobsled","Bolo tie","Bonnet","Bookcase","Bookshop","Bottlecap","Bow","Bow tie","Brass","Brassiere","Breakwater","Breastplate","Broom","Bucket","Buckle","Bulletproof vest","Bullet train","Butcher shop","Cab","Caldron","Candle","Cannon","Canoe","Caopener","Cardigan","Car mirror","Carousel","Carpenter's kit","Carton","Car wheel","Cash machine","Cassette","Cassette player","Castle","Catamaran","CD player","Cello","Cellular telephone","Chain","Chainlink fence","Chaimail","Chaisaw","Chest","Chiffonier","Chime","China cabinet","Christmas stocking","Church","Cinema","Cleaver","Cliff dwelling","Cloak","Clog","Cocktail shaker","Coffee mug","Coffeepot","Coil","Combinatiolock","Computer keyboard","Confectionery","Container ship","Convertible","Corkscrew","Cornet","Cowboy boot","Cowboy hat","Cradle","Crane","Crash helmet","Crate","Crib","Crock Pot","Croquet ball","Crutch","Cuirass","Dam","Desk","Desktop computer","Dial telephone","Diaper","Digital clock","Digital watch","Dining table","Dishrag","Dishwasher","Disk brake","Dock","Dogsled","Dome","Doormat","Drilling platform","Drum","Drumstick","Dumbbell","Dutch oven","Electric fan","Electric guitar","Electric locomotive","Entertainment center","Envelope","Espresso maker","Face powder","Feather boa","File","Fireboat","Fire engine","Fire screen","Flagpole","Flute","Folding chair","Football helmet","Forklift","Fountain","Fountaipen","Four-poster","Freight car","French horn","Frying pan","Fur coat","Garbage truck","Gasmask","Gas pump","Goblet","Go-kart","Golf ball","Golfcart","Gondola","Gong","Gown","Grand piano","Greenhouse","Grille","Grocery store","Guillotine","Hair slide","Hair spray","Half track","Hammer","Hamper","Hand blower","Hand-held computer","Handkerchief","Hard disc","Harmonica","Harp","Harvester","Hatchet","Holster","Home theater","Honeycomb","Hook","Hoopskirt","Horizontal bar","Horse cart","Hourglass","IPod","Iron","Jack-o'-lantern","Jean","Jeep","Jersey","Jigsaw puzzle","Jinrikisha","Joystick","Kimono","Knee pad","Knot","Lab coat","Ladle","Lampshade","Laptop","Lawmower","Lens cap","Letter opener","Library","Lifeboat","Lighter","Limousine","Liner","Lipstick","Loafer","Lotion","Loudspeaker","Loupe's loupe","Lumbermill","Magnetic compass","Mailbag","Mailbox","Maillot","Maillot","Manhole cover","Maraca","Marimba","Mask","Matchstick","Maypole","Maze","Measuring cup","Medicine chest","Megalith","Microphone","Microwave","Military uniform","Milk can","Minibus","Miniskirt","Minivan","Missile","Mitten","Mixing bowl","Mobile home","Model T","Modem","Monastery","Monitor","Moped","Mortar","Mortarboard","Mosque","Mosquito net","Motor scooter","Mountaibike","Mountaitent","Mouse","Mousetrap","Moving van","Muzzle","Nail","Neck brace","Necklace","Nipple","Notebook","Obelisk","Oboe","Ocarina","Odometer","Oil filter","Organ","Oscilloscope","Overskirt","Oxcart","Oxygemask","Packet","Paddle","Paddlewheel","Padlock","Paintbrush","Pajama's","Palace","Panpipe","Paper towel","Parachute","Parallel bars","Park bench","Parking meter","Passenger car","Patio","Pay-phone","Pedestal","Pencil box","Pencil sharpener","Perfume","Petri dish","Photocopier","Pick","Pickelhaube","Picket fence","Pickup","Pier","Piggy bank","Pill bottle","Pillow","Ping-pong ball","Pinwheel","Pirate","Pitcher","Plane's plane","Planetarium","Plastic bag","Plate rack","Plow","Plunger's helper","Polaroid camera","Pole","Police van","Poncho","Pool table","Pop bottle","Pot","Potter's wheel","Power drill","Prayer rug","Printer","Prison","Projectile","Projector","Puck","Punching bag","Purse","Quill","Quilt","Racer","Racket","Radiator","Radio","Radio telescope","Raibarrel","Recreational vehicle.V.","Reel","Reflex camera","Refrigerator","Remote control","Restaurant","Revolver","Rifle","Rocking chair","Rotisserie","Rubber eraser","Rugby ball","Rule","Running shoe","Safe","Safety pin","Saltshaker","Sandal","Sarong","Sax","Scabbard","Scale","School bus","Schooner","Scoreboard","Screen","Screw","Screwdriver","Seat belt","Sewing machine","Shield","Shoe shop","Shoji","Shopping basket","Shopping cart","Shovel","Shower cap","Shower curtain","Ski","Ski mask","Sleeping bag","Slide rule","Sliding door","Slot","Snorkel","Snowmobile","Snowplow","Soap dispenser","Soccer ball","Sock","Solar dish","Sombrero","Soup bowl","Space bar","Space heater","Space shuttle","Spatula","Speedboat","Spider web's web","Spindle","Sports car","Spotlight","Stage","Steam locomotive","Steel arch bridge","Steel drum","Stethoscope","Stole","Stone wall","Stopwatch","Stove","Strainer","Streetcar","Stretcher","Studio couch","Stupa","Submarine","Suit","Sundial","Sunglass","Sunglasses","Sunscreen","Suspensiobridge","Swab","Sweatshirt","Swimming trunks","Swing","Switch","Syringe","Table lamp","Tank","Tape player","Teapot","Teddy","Television","Tennis ball","Thatch","Theater curtain","Thimble","Thresher","Throne","Tile roof","Toaster","Tobacco shop","Toilet seat","Torch","Totem pole","Tow truck","Toyshop","Tractor","Trailer truck","Tray","Trench coat","Tricycle","Trimaran","Tripod","Triumphal arch","Trolleybus","Trombone","Tub","Turnstile","Typewriter keyboard","Umbrella","Unicycle","Upright","Vacuum","Vase","Vault","Velvet","Vending machine","Vestment","Viaduct","Violin","Volleyball","Waffle iron","Wall clock","Wallet","Wardrobe","Warplane","Washbasin","Washer","Water bottle","Water jug","Water tower","Whiskey jug","Whistle","Wig","Window screen","Window shade","Windsor tie","Wine bottle","Wing","Wok","Woodespoon","Wool","Worm fence","Wreck","Yawl","Yurt","Web site","Comic book","Crossword puzzle","Street sign","Traffic light","Book jacket","Menu","Plate","Guacamole","Consomme","Hot pot","Trifle","Ice cream","Ice lolly","French loaf","Bagel","Pretzel","Cheeseburger","Hotdog","Mashed potato","Head cabbage","Broccoli","Cauliflower","Zucchini","Spaghetti squash","Acorsquash","Butternut squash","Cucumber","Artichoke","Bell pepper","Cardoon","Mushroom","Granny Smith","Strawberry","Orange","Lemon","Fig","Pineapple","Banana","Jackfruit","Custard apple","Pomegranate","Hay","Carbonara","Chocolate sauce","Dough","Meat loaf","Pizza","Potpie","Burrito","Red wine","Espresso","Cup","Eggnog","Alp","Bubble","Cliff","Coral reef","Geyser","Lakeside","Promontory","Sandbar","Seashore","Valley","Volcano","Ballplayer","Groom","Scuba diver","Rapeseed","Daisy","Yellow lady's slipper","Corn","Acorn","Hip","Buckeye","Coral fungus","Agaric","Gyromitra","Stinkhorn","Earthstar","Hen-of-the-woods","Bolete","Ear","Toilet tissue"],Si=["n01440764_tench.JPEG","n03160309_dam.JPEG","n03216828_dock.JPEG","n03670208_limousine.JPEG","n04548280_wall_clock.JPEG","n04552348_warplane.JPEG","n04599235_wool.JPEG","n06874185_traffic_light.JPEG","n07873807_pizza.JPEG","n07920052_espresso.JPEG","n09193705_alp.JPEG","n12620546_hip.JPEG"],Pi=function(t){Object(x.a)(n,t);var e=Object(_.a)(n);function n(t){var r;return Object(w.a)(this,n),(r=e.call(this,t)).model=void 0,r.mean=new a.gpu.GPUTensor(new Float32Array([.485,.456,.406]),[3,1,1],16),r.std=new a.gpu.GPUTensor(new Float32Array([.229,.224,.225]),[3,1,1],16),function(t){return ki.apply(this,arguments)}("mobilenet").then((function(t){r.model=t,console.log("Got model")})),r.setState({showResult:!1,results:[]}),r}return Object(b.a)(n,[{key:"getImageData",value:function(){var t=Object(v.a)(d.a.mark((function t(){var e,n,r,o,i,u,s,p,c,l,h,f,y,v,w,b,x,_,O,k=this;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=document.getElementById("img"),console.log("Reading pixels"),r=a.gpu.GPUTensor.fromData(n,16),o=r.shape.slice(0,2),i=Object(g.a)(o,2),u=i[0],s=i[1],p=Math.min(s,u),c=Math.floor(p/2),l=Math.floor(s/2)-c,h=Math.floor(u/2)-c,f=r.slice([h,l,0],[h+p,l+p,3],[0,1,2]),r.delete(),y=224/p,v=f.upsample([y,y,1]),f.delete(),w=v.getShape()[0],this.setState(Object(m.a)({},this.state)),b=v.transpose([2,0,1]),v.delete(),x=b.subtract(this.mean),b.delete(),_=x.divide(this.std),x.delete(),O=_.reshape([1,3,w,w],!1),null===(e=this.model)||void 0===e||e.forward([O]).then((function(t){return k.handleResult(t[0])}));case 23:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleResult",value:function(){var t=Object(v.a)(d.a.mark((function t(e){var n,r,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Got result",e),n=e.softmax(1),e.delete(),t.next=5,n.copy(32).getValues();case 5:r=t.sent,o=(o=Array.from(r).map((function(t,e){return{prob:t,name:Ai[e]}}))).sort((function(t,e){return e.prob-t.prob})),this.setState(Object(m.a)(Object(m.a)({},this.state),{},{showResult:!0,results:o.slice(0,5)}));case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fileSelected",value:function(t){this.setState(Object(m.a)(Object(m.a)({},this.state),{},{img:URL.createObjectURL(t.target.files[0]),showResult:!1,results:[]}))}},{key:"setImage",value:function(t){this.setState(Object(m.a)(Object(m.a)({},this.state),{},{img:"img/"+t,showResult:!1,results:[]}))}},{key:"render",value:function(){var t,e=this,n=!1;this.state&&(t=this.state.img,n=this.state.showResult);return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)("h1",{children:"MobilenNet Classification"}),Object(p.jsx)("label",{htmlFor:"file",children:"Choose an image:"})," ",Object(p.jsx)("input",{type:"file",id:"file",onChange:function(t){return e.fileSelected(t)}}),Object(p.jsx)("br",{}),"Or use one of the examples:",Object(p.jsx)("table",{children:Object(p.jsx)("tr",{children:Si.map((function(t){return Object(p.jsx)("td",{children:Object(p.jsx)("img",{src:"img/"+t,height:50,onClick:function(){return e.setImage(t)},className:"exampleImage",alt:"Example"})})}))})}),void 0!==t?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("table",{children:Object(p.jsxs)("tr",{children:[Object(p.jsxs)("td",{children:[Object(p.jsx)("img",{id:"img",src:this.state.img,alt:"Your upload",width:400}),Object(p.jsx)("br",{}),Object(p.jsx)("button",{onClick:function(){return e.getImageData()},children:"Run"}),Object(p.jsx)("br",{})]}),Object(p.jsx)("td",{className:"resultList",children:n?this.renderResults():Object(p.jsx)(p.Fragment,{})})]})})}):Object(p.jsx)(p.Fragment,{})]})}},{key:"renderResults",value:function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("table",{children:this.state.results.map((function(t){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{className:"resultName",children:t.name}),Object(p.jsx)("td",{children:Object(p.jsx)("div",{style:{width:400*t.prob},children:Object(p.jsx)("div",{className:"result",children:400*t.prob>50?Math.round(100*t.prob)+"%":Object(p.jsx)(p.Fragment,{})})})})]},t.name)}))})})}}]),n}(l.a.Component),ji=function(t){t&&t instanceof Function&&n.e(4).then(n.bind(null,47)).then((function(e){var n=e.getCLS,r=e.getFID,o=e.getFCP,i=e.getLCP,a=e.getTTFB;n(t),r(t),o(t),i(t),a(t)}))};f.a.render(Object(p.jsx)(l.a.StrictMode,{children:Object(p.jsx)(Pi,{})}),document.getElementById("root")),ji()}},[[42,1,2]]]);
//# sourceMappingURL=main.2876ea7a.chunk.js.map