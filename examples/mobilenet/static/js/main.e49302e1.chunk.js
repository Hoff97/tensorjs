(this.webpackJsonpstyle=this.webpackJsonpstyle||[]).push([[0],{23:function(t,e,n){},25:function(t,e,n){},42:function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"CPUTensor",(function(){return Q}));var o={};n.r(o),n.d(o,"GPUTensor",(function(){return In})),n.d(o,"gpuConstructor",(function(){return Cn}));var i={};n.r(i),n.d(i,"tensorConstructor",(function(){return Wn})),n.d(i,"wasmLoaded",(function(){return Nr})),n.d(i,"WASMTensor",(function(){return qr}));var a={};n.r(a),n.d(a,"cpu",(function(){return r})),n.d(a,"gpu",(function(){return o})),n.d(a,"wasm",(function(){return i}));var u={};n.r(u),n.d(u,"OnnxModel",(function(){return Ip}));var s={};n.r(s),n.d(s,"model",(function(){return u}));var p=n(0),c=n(5),l=n.n(c),h=n(10),f=n.n(h),d=(n(23),n(2)),y=n.n(d),m=n(3),v=n(15),w=n(6),g=n(11),b=n(12),_=n(17),x=n(16);n(25);function O(t,e){if(void 0===e&&(e=0),0===t.length)return e;for(var n=1,r=0;r<t.length;r+=1)n*=t[r];return n}function k(t){var e=t.length;if(0===e)return[];if(1===e)return 1===t[0]?[0]:[1];var n=new Array(e);n[e-1]=1,1===t[e-1]&&(n[e-1]=0);for(var r=1,o=e-2;o>=0;o-=1)r=t[o+1]*r,1===t[o]?n[o]=0:n[o]=r;return n}function S(t,e,n){for(var r=0,o=0;o<t.length;o+=1){if(n&&(t[o]<0||t[o]>=n[o]&&1!==n[o]))throw new Error("Invalid index");r+=t[o]*e[o]}return r}function A(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0}function P(t,e){for(var n=t.length-1;n>=0&&(t[n]+=1,t[n]>=e[n]);n--)t[n]=0}var j=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},M=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},T=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},I={float64:Float64Array,float32:Float32Array,float16:Float32Array,int32:Int32Array,int16:Int16Array,int8:Int8Array,uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array},C=function(){function t(t){this.dtype=t}return t.prototype.compare=function(t,e){return j(this,void 0,void 0,(function(){var n,r,o;return M(this,(function(i){switch(i.label){case 0:return A(this.getShape(),t.getShape())?[4,this.getValues()]:[2,!1];case 1:return n=i.sent(),[4,t.getValues()];case 2:if(r=i.sent(),void 0!==e){for(o=0;o<n.length;o+=1)if(Math.abs(n[o]-r[o])>e)return[2,!1]}else for(o=0;o<n.length;o+=1)if(n[o]!==r[o])return[2,!1];return[2,!0]}}))}))},t.prototype.getAxes=function(t){var e,n=this.getShape();if(void 0===t){e=[];for(var r=0;r<n.length;r++)e.push(r)}else if(t instanceof Array){e=t;for(r=0;r<e.length;r++)e[r]<0&&(e[r]+=this.getShape().length)}else e=[t];return e},t.prototype.sum=function(t,e){var n=this.getAxes(t);return e=e||!1,this.sum_impl(n,e)},t.prototype.sumSquare=function(t,e){var n=this.getAxes(t);return e=e||!1,this.sumSquare_impl(n,e)},t.prototype.product=function(t,e){var n=this.getAxes(t);return e=e||!1,this.product_impl(n,e)},t.prototype.max=function(t,e){var n=this.getAxes(t);return e=e||!1,this.max_impl(n,e)},t.prototype.min=function(t,e){var n=this.getAxes(t);return e=e||!1,this.min_impl(n,e)},t.prototype.reduceMean=function(t,e){var n=this.getAxes(t);return e=e||!1,this.reduceMean_impl(n,e)},t.prototype.reduceLogSum=function(t,e){var n=this.getAxes(t);return e=e||!1,this.reduceLogSum_impl(n.sort(),e)},t.prototype.reduceLogSumExp=function(t,e){var n=this.getAxes(t);return e=e||!1,this.reduceLogSumExp_impl(n,e)},t.prototype.reduceMeanSquare=function(t,e){var n=this.getAxes(t);return e=e||!1,this.reduceMeanSquare_impl(n,e)},t.prototype.conv=function(t,e,n,r,o,i,a){var u=this.getShape().length-2;return n=n||new Array(u).fill(1),r=r||1,o=o||new Array(2*u).fill(0),i=i||new Array(u).fill(1),void 0===a&&(a="id"),this.conv_impl(t,n,r,o,i,a,e)},t.prototype.convTranspose=function(t,e,n,r,o){var i=this.getShape().length-2;return e=e||new Array(i).fill(1),n=n||1,r=r||new Array(2*i).fill(0),o=o||new Array(i).fill(1),this.convTranspose_impl(t,e,n,r,o)},t.prototype.pad=function(t,e,n){return void 0===e&&(e="constant"),void 0===n&&(n=0),this.pad_impl(t,e,n)},t.prototype.averagePool=function(t,e,n,r){var o=this.getShape().length-2;return e=e||new Array(2*o).fill(0),n=n||new Array(o).fill(1),r=r||!1,this.averagePool_impl(t,e,n,r)},t.prototype.reshape=function(t,e){for(var n=1,r=-1,o=0;o<t.length;o++)-1===t[o]?r=o:n*=t[o];if(void 0===e&&(e=!0),-1!==r){var i=O(this.getShape()),a=T(t);return a[r]=i/n,this.reshape_impl(a,e)}return this.reshape_impl(t,e)},t.prototype.alignShapes=function(t,e){var n,r;if(A(t,e))return[t,e,t];if(t.length<e.length){t=T(t);var o=e.length-t.length;(n=t).unshift.apply(n,new Array(o).fill(1))}else if(e.length<t.length){e=T(e);o=t.length-e.length;(r=e).unshift.apply(r,new Array(o).fill(1))}for(var i=new Array(t.length).fill(1),a=0;a<t.length;a++)i[a]=Math.max(t[a],e[a]);return[t,e,i]},t.prototype.alignTensor=function(t){var e,n,r=this.getShape(),o=t.getShape();if(A(r,o))return[this,t,r];var i=this;if(r.length<o.length){r=T(r);var a=o.length-r.length;(e=r).unshift.apply(e,new Array(a).fill(1)),i=this.reshape(r,!1)}else if(o.length<r.length){o=T(o);a=r.length-o.length;(n=o).unshift.apply(n,new Array(a).fill(1)),t=t.reshape(o,!1)}for(var u=new Array(r.length).fill(1),s=0;s<r.length;s++)u[s]=Math.max(r[s],o[s]);return[i,t,u]},t.prototype.add=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=1);var r=this.alignTensor(t),o=r[0],i=r[1],a=r[2];return this.add_impl(o,i,a,e,n)},t.prototype.subtract=function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=1);var r=this.alignTensor(t),o=r[0],i=r[1],a=r[2];return this.subtract_impl(o,i,a,e,n)},t.prototype.multiply=function(t,e){void 0===e&&(e=1);var n=this.alignTensor(t),r=n[0],o=n[1],i=n[2];return this.multiply_impl(r,o,i,e)},t.prototype.multiplyScalar=function(t){return this.addMultiplyScalar(t,0)},t.prototype.addScalar=function(t){return this.addMultiplyScalar(1,t)},t.prototype.divide=function(t,e){void 0===e&&(e=1);var n=this.alignTensor(t),r=n[0],o=n[1],i=n[2];return this.divide_impl(r,o,i,e)},t.prototype.power=function(t){var e=this.alignTensor(t),n=e[0],r=e[1],o=e[2];return this.power_impl(n,r,o)},t.prototype.transpose=function(t){if(void 0===t){var e=this.getShape().length;t=[];for(var n=0;n<e;n++)t.push(e-n-1)}return this.transpose_impl(t)},t.prototype.softmax=function(t){var e=this.max(t,!0),n=this.subtract(e),r=n.exp(),o=r.sum(t,!0),i=r.divide(o);return e.delete(),n.delete(),r.delete(),o.delete(),i},t.prototype.gemm=function(t,e,n,r,o,i){if(e=e||!1,n=n||!1,r=void 0!==r?r:1,i=void 0!==i?i:1,void 0!==o){var a=this.getShape(),u=o.getShape(),s=a.length,p=u.length;s>p&&(u=T(new Array(s-p).fill(1),u),o=o.reshape(u,!1))}return this.gemm_impl(t,e,n,r,i,o)},t.prototype.slice=function(t,e,n,r){var o=this.getShape(),i=o.length;if(void 0===n){n=[];for(var a=0;a<i;a++)n.push(a)}else n=n.map((function(t){return t<0?t+i:t}));void 0===r&&(r=new Array(i).fill(1)),t=T(t),e=T(e);for(a=0;a<n.length;a++){var u=o[n[a]];t[a]<0?t[a]+=u:t[a]>=u&&(r[a]>0?t[a]=u:t[a]=u-1),e[a]<0?e[a]+=u:e[a]>=u&&(e[a]=u)}return this.slice_impl(t,e,n,r)},t.prototype.squeeze=function(){for(var t=[],e=0,n=this.getShape();e<n.length;e++){var r=n[e];1!==r&&t.push(r)}return this.reshape(t)},t.prototype.flatten=function(t){void 0===t&&(t=1);var e=this.getShape();t<0&&(t+=e.length);var n=[O(e.slice(0,t),1),O(e.slice(t),1)];return this.reshape(n)},t}();function G(t,e,n,r,o,i){var a=o*(e-1)+1;return Math.floor((t+n+r-a)/i+1)}function V(t,e,n,r,o,i){for(var a=[],u=0;u<t.length;u++)a.push(G(t[u],e[u],n[u],r[u],o[u],i[u]));return a}function E(t,e){for(var n=new Q(t.shape,void 0,t.dtype),r=0;r<n.size;r+=1)n.set(r,e(t.get(r)));return n}function R(t,e,n,r){if(!function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n]&&1!==t[n]&&1!==e[n])return!1;return!0}(t.shape,e.shape))throw new Error("The shapes of the two tensors should be the same for a binary operation");for(var o=new Q(r,void 0,t.dtype),i=new Array(r.length).fill(0),a=0;a<o.size;a+=1)o.set(i,n(t.get(i),e.get(i))),P(i,r);return o}function X(t,e,n){return E(t,(function(t){return t*e+n}))}var B=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function D(t,e,n,r,o,i){for(var a,u,s,p,c,l=[],h=0;h<t.length;h++)l.push((a=t[h],u=e[h],s=n[h],p=r[h],c=o[h],i[h]*(a-1)+s+p-(c*(u-1)+1)+2));return l}var U=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var W=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function z(t,e,n){for(var r=[],o=[],i=[],a=0;a<t.length;a++)e.includes(a)?(n&&(r.push(1),i.push(a)),o.push(t[a])):(r.push(t[a]),i.push(a));return 0===r.length&&r.push(1),[r,i]}function L(t,e,n,r,o){for(var i=t.getShape(),a=O(i),u=z(i,e,r),s=u[0],p=u[1],c=O(s),l=k(s),h=new Q(s,void 0,t.dtype),f=new Array(c).fill(!1),d=new Array(i.length).fill(0),y=new Array(s.length).fill(0),m=0;m<a;m++){for(var v=0;v<p.length;v++)y[v]=d[p[v]];var w=S(y,l);f[w]?h.set(y,n(t.get(m),h.get(y))):(f[w]=!0,h.set(y,n(t.get(m)))),P(d,i)}if(o)for(m=0;m<h.size;m++)h.set(m,o(h.get(m)));return h}var F=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var N=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function q(t,e,n,r,o){if(o)return t.get(e);var i=t.shape.length;if("constant"===n)return r;if("edge"===n)for(var a=0;a<i;a++)e[a]<0?e[a]=0:e[a]>=t.shape[a]&&(e[a]=t.shape[a]-1);else for(a=0;a<i;a++)e[a]<0?e[a]=-e[a]:e[a]>=t.shape[a]&&(e[a]=2*t.shape[a]-e[a]-2);return t.get(e)}var H=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var J=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var K=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Y=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Q=function(t){function e(e,n,r){var o=t.call(this,r||"float32")||this;return o.deleted=!1,o.shape=e,o.strides=k(e),o.size=O(e),o.values=void 0!==n?n instanceof Array?new I[o.dtype](n):n:new I[o.dtype](o.size),o}return K(e,t),e.range=function(t,n,r){for(var o=Math.max(Math.ceil((n-t)/r),0),i=new Float32Array(o),a=0;a<o;a++)i[a]=t+a*r;return new e([o],i)},e.prototype.getValues=function(){return Promise.resolve(this.values)},e.prototype.getShape=function(){return this.shape},e.prototype.constantLike=function(t){return new e(this.shape,new I[this.dtype](this.size).fill(t),this.dtype)},e.prototype.singleConstant=function(t){return new e([1],[t],this.dtype)},e.prototype.cast=function(t){return new e(this.shape,Array.from(this.values),t)},e.prototype.delete=function(){this.values=void 0,this.deleted=!0},e.prototype.copy=function(t){void 0===t&&(t=Y(this.shape));for(var n=new I[this.dtype](this.size),r=0;r<this.size;r++)n[r]=this.values[r];return new e(t,n,this.dtype)},e.prototype.get=function(t){var e;return e=Array.isArray(t)?S(t,this.strides,this.shape):t,this.values[e]},e.prototype.set=function(t,e){var n;n=Array.isArray(t)?S(t,this.strides):t,this.values[n]=e},e.prototype.setValues=function(t,n){if(!(t instanceof e))throw new Error("Can only set CPU values to CPU values");return function(t,e,n){for(var r=new Q(t.shape,void 0,t.dtype),o=new Array(t.shape.length).fill(0),i=0;i<r.size;i+=1){for(var a=!0,u=new Array(n.length).fill(0),s=0;s<n.length;s++){if(o[s]<n[s]||o[s]>=n[s]+e.shape[s]){a=!1;break}u[s]=o[s]-n[s]}a?r.set(i,e.get(u)):r.set(i,t.get(i)),P(o,t.shape)}return r}(this,t,n)},e.prototype.exp=function(){return E(this,(function(t){return Math.exp(t)}))},e.prototype.log=function(){return E(this,(function(t){return Math.log(t)}))},e.prototype.sqrt=function(){return E(this,(function(t){return Math.sqrt(t)}))},e.prototype.abs=function(){return E(this,(function(t){return Math.abs(t)}))},e.prototype.sin=function(){return E(this,(function(t){return Math.sin(t)}))},e.prototype.cos=function(){return E(this,(function(t){return Math.cos(t)}))},e.prototype.tan=function(){return E(this,(function(t){return Math.tan(t)}))},e.prototype.asin=function(){return E(this,(function(t){return Math.asin(t)}))},e.prototype.acos=function(){return E(this,(function(t){return Math.acos(t)}))},e.prototype.atan=function(){return E(this,(function(t){return Math.atan(t)}))},e.prototype.sinh=function(){return E(this,(function(t){return Math.sinh(t)}))},e.prototype.cosh=function(){return E(this,(function(t){return Math.cosh(t)}))},e.prototype.tanh=function(){return E(this,(function(t){return Math.tanh(t)}))},e.prototype.asinh=function(){return E(this,(function(t){return Math.asinh(t)}))},e.prototype.acosh=function(){return E(this,(function(t){return Math.acosh(t)}))},e.prototype.atanh=function(){return E(this,(function(t){return Math.atanh(t)}))},e.prototype.floor=function(){return E(this,(function(t){return Math.floor(t)}))},e.prototype.ceil=function(){return E(this,(function(t){return Math.ceil(t)}))},e.prototype.round=function(){return E(this,(function(t){return Math.round(t)}))},e.prototype.negate=function(){return E(this,(function(t){return-t}))},e.prototype.powerScalar=function(t,e){return function(t,e,n){return E(t,(function(t){return Math.pow(t,e)*n}))}(this,t,e)},e.prototype.multiplyScalar=function(t){return X(this,t,0)},e.prototype.addScalar=function(t){return X(this,1,t)},e.prototype.addMultiplyScalar=function(t,e){return X(this,t,e)},e.prototype.sign=function(){return E(this,(function(t){return t<0?-1:0===t?0:1}))},e.prototype.clip=function(t,e){return function(t,e,n){var r=function(t){return t};return void 0!==e&&void 0!==n?r=function(t){return Math.min(n,Math.max(e,t))}:void 0!==n?r=function(t){return Math.min(n,t)}:void 0!==e&&(r=function(t){return Math.max(e,t)}),E(t,r)}(this,t,e)},e.prototype.clipBackward=function(t,n,r){if(!(t instanceof e))throw new Error("Can only do clipBackward with CPUTensor");return function(t,e,n,r,o){return R(t,e,(function(t,e){return void 0!==r&&t<r||void 0!==o&&t>o?0:e}),n)}(this,t,this.getShape(),n,r)},e.prototype.sigmoid=function(){return E(this,(function(t){return 1/(1+Math.exp(-t))}))},e.prototype.hardSigmoid=function(t,e){return function(t,e,n){return E(t,(function(t){return Math.max(0,Math.min(1,e*t+n))}))}(this,t,e)},e.prototype.add_impl=function(t,n,r,o,i){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,e,n,r,o){return R(t,e,(function(t,e){return t*r+e*o}),n)}(t,n,r,o,i)},e.prototype.subtract_impl=function(t,n,r,o,i){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only subtract CPU tensor to CPU tensor");return function(t,e,n,r,o){return R(t,e,(function(t,e){return t*r-e*o}),n)}(t,n,r,o,i)},e.prototype.multiply_impl=function(t,n,r,o){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,e,n,r){return R(t,e,(function(t,e){return t*e*r}),n)}(t,n,r,o)},e.prototype.divide_impl=function(t,n,r,o){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,e,n,r){return R(t,e,(function(t,e){return t/e*r}),n)}(t,n,r,o)},e.prototype.power_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only take CPU tensor to power of CPU tensor");return function(t,e,n){return R(t,e,(function(t,e){return Math.pow(t,e)}),n)}(t,n,r)},e.prototype.matMul=function(t){if(!(t instanceof e))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,e){if(2!==t.shape.length||2!==e.shape.length)throw new Error("Matmul expects both operands to have rank 2");if(t.shape[1]!==e.shape[0])throw new Error("Matmul expects dimension 1 of operand 1 to equal dimension 0 of operand 2");for(var n=t.shape[0],r=t.shape[1],o=e.shape[1],i=new Q([n,o],void 0,t.dtype),a=0;a<n;a+=1)for(var u=0;u<o;u+=1){for(var s=0,p=0;p<r;p+=1)s+=t.get([a,p])*e.get([p,u]);i.set([a,u],s)}return i}(this,t)},e.prototype.gemm_impl=function(t,n,r,o,i,a){if(!(t instanceof e&&(void 0===a||a instanceof e)))throw new Error("Can only do gemm with CPU tensors");return function(t,e,n,r,o,i,a){var u=t.shape.length,s=n?t.shape[u-1]:t.shape[u-2],p=n?t.shape[u-2]:t.shape[u-1],c=r?e.shape[u-2]:e.shape[u-1],l=s*p,h=p*c,f=s*c,d=n?s:1,y=n?1:p,m=r?1:c,v=r?p:1,w=0,g=0,b=0;void 0!==a&&(w=a.strides[u-2],g=a.strides[u-1],O(a.shape.slice(0,u-2))>1?1===(b=a.shape[u-2]*a.shape[u-1])&&(b=0):b=0);var _=t.shape.slice(0,u-2),x=O(_);0===x&&(x=1);for(var k=W(_,[s,c]),S=new Q(k,void 0,t.dtype),A=0;A<x;A++)for(var P=A*l,j=A*h,M=A*f,T=A*b,I=0;I<s;I++)for(var C=0;C<c;C++){for(var G=0,V=0;V<p;V++)G+=t.get(P+I*y+V*d)*e.get(j+V*m+C*v);G*=o,void 0!==a&&(G+=i*a.get(T+I*w+C*g)),S.set(M+I*c+C,G)}return S}(this,t,n,r,o,i,a)},e.prototype.sum_impl=function(t,e){return function(t,e,n){return L(t,e,(function(t,e){return t+(void 0!==e?e:0)}),n)}(this,t,e)},e.prototype.sumSquare_impl=function(t,e){return function(t,e,n){return L(t,e,(function(t,e){return t*t+(void 0!==e?e:0)}),n)}(this,t,e)},e.prototype.product_impl=function(t,e){return function(t,e,n){return L(t,e,(function(t,e){return t*(void 0!==e?e:1)}),n)}(this,t,e)},e.prototype.max_impl=function(t,e){return function(t,e,n){return L(t,e,(function(t,e){return Math.max(t,void 0!==e?e:t)}),n)}(this,t,e)},e.prototype.min_impl=function(t,e){return function(t,e,n){return L(t,e,(function(t,e){return Math.min(t,void 0!==e?e:t)}),n)}(this,t,e)},e.prototype.reduceMean_impl=function(t,e){return function(t,e,n){for(var r=1,o=0;o<e.length;o++)r*=t.shape[e[o]];return L(t,e,(function(t,e){return t+(void 0!==e?e:0)}),n,(function(t){return t/r}))}(this,t,e)},e.prototype.reduceMeanSquare_impl=function(t,e){return function(t,e,n){for(var r=1,o=0;o<e.length;o++)r*=t.shape[e[o]];return L(t,e,(function(t,e){return t*t+(void 0!==e?e:0)}),n,(function(t){return t/r}))}(this,t,e)},e.prototype.reduceLogSum_impl=function(t,e){return function(t,e,n){return L(t,e,(function(t,e){return t+(void 0!==e?e:0)}),n,(function(t){return Math.log(t)}))}(this,t,e)},e.prototype.reduceLogSumExp_impl=function(t,e){return function(t,e,n){return L(t,e,(function(t,e){return Math.exp(t)+(void 0!==e?e:0)}),n,(function(t){return Math.log(t)}))}(this,t,e)},e.prototype.conv_impl=function(t,n,r,o,i,a,u){if(!(t instanceof e)||void 0!==u&&!(u instanceof e))throw new Error("Can only do convolution of CPU tensor with CPU tensor");return function(t,e,n,r,o,i,a,u){var s=t.shape[0],p=t.shape[1],c=t.shape.slice(2),l=e.shape.slice(2),h=e.shape[0],f=p/r,d=O(l),y=V(c,l,o.slice(0,o.length/2),o.slice(o.length/2),n,i),m=O(y),v=[s,h];v=v.concat(y);for(var w=new Q(v,void 0,t.dtype),g=y.length,b=0;b<s;b++)for(var _=0;_<h;_++){if(u){var x=u?u.get([_]):0;(D=new Array(y.length).fill(0)).unshift(b,_);for(var k=0;k<m;k++)w.set(D,x),P(D,w.shape)}for(var S=0;S<f;S++){var A=(_*f+S)%p;for((D=new Array(y.length).fill(0)).unshift(b,_),k=0;k<m;k++){var j=w.get(D),M=new Array(y.length).fill(0);M.unshift(_,S);for(var T=0;T<d;T++){for(var I=[b,A],C=!1,G=0;G<g;G++){var E=0===i.length?1:i[G],R=0===o.length?0:o[G],X=0===n.length?1:n[G],B=D[G+2]*E-R+M[G+2]*X;if(B<0||B>=c[G]){C=!0;break}I.push(B)}C||(j+=e.get(M)*t.get(I)),P(M,e.shape)}w.set(D,j),P(D,w.shape)}}var D;if("id"!==a)for((D=new Array(y.length).fill(0)).unshift(b,_),k=0;k<m;k++)j=w.get(D),"relu"===a?j=Math.max(0,j):"relu6"===a&&(j=Math.min(Math.max(0,j),6)),w.set(D,j),P(D,w.shape)}return w}(this,t,n,r,o,i,a,u)},e.prototype.convTranspose_impl=function(t,n,r,o,i){if(!(t instanceof e))throw new Error("Can only do transpose convolution of CPU tensor with CPU tensor");return function(t,e,n,r,o,i){var a=t.shape[0],u=t.shape[1],s=t.shape.slice(2),p=e.shape.slice(2),c=e.shape[0],l=u/r,h=O(p),f=D(s,p,o.slice(0,o.length/2),o.slice(o.length/2),n,i),d=O(f),y=[a,c];y=y.concat(f);for(var m=new Q(y,void 0,t.dtype),v=f.length,w=0;w<a;w++)for(var g=0;g<c;g++)for(var b=0;b<l;b++){var _=(g*l+b)%u,x=new Array(f.length).fill(0);x.unshift(w,g);for(var k=0;k<d;k++){var S=m.get(x),A=new Array(f.length).fill(0);A.unshift(g,b);for(var j=0;j<h;j++){for(var M=[w,_],T=!1,I=0;I<v;I++){var C=0===i.length?1:i[I],G=0===o.length?0:o[I],V=0===n.length?1:n[I],E=x[I+2]-G+A[I+2]*V;if(0!==E%C){T=!0;break}if((E/=C)<0||E>=s[I]){T=!0;break}M.push(E)}if(!T){for(var R=[g,b],X=0;X<v;X++)R.push(p[X]-A[X+2]-1);S+=e.get(R)*t.get(M)}P(A,e.shape)}m.set(x,S),P(x,m.shape)}}return m}(this,t,n,r,o,i)},e.prototype.pad_impl=function(t,e,n){return function(t,e,n,r){for(var o=t.shape.length,i=N(t.shape),a=0;a<o;a++)i[a]+=e[a]+e[a+o];var u=new Q(i,void 0,t.dtype),s=new Array(o).fill(0),p=new Array(o).fill(0);for(a=0;a<u.size;a++){for(var c=!0,l=0;l<o;l++)p[l]=s[l]-e[l],(p[l]<0||p[l]>=t.shape[l])&&(c=!1);u.set(a,q(t,p,n,r,c)),P(s,i)}return u}(this,t,e,n)},e.prototype.averagePool_impl=function(t,e,n,r){return function(t,e,n,r,o){var i=t.shape[0],a=t.shape[1],u=t.shape.slice(2),s=u.length,p=O(e),c=V(u,e,n.slice(0,n.length/2),n.slice(n.length/2),new Array(s).fill(1),r),l=O(c),h=[i,a];h=h.concat(c);for(var f=new Q(h,void 0,t.dtype),d=0;d<i;d++)for(var y=0;y<a;y++){var m=new Array(c.length).fill(0);m.unshift(d,y);for(var v=0;v<l;v++){for(var w=0,g=new Array(c.length).fill(0),b=0,_=0;_<p;_++){for(var x=[d,y],k=!1,S=0;S<s;S++){var A=0===r.length?1:r[S],j=0===n.length?0:n[S],M=m[S+2]*A-j+g[S];if(M<0||M>=u[S]){k=!0;break}x.push(M)}k||(w+=t.get(x)),k&&!o||(b+=1),P(g,e)}w/=b,f.set(m,w),P(m,f.shape)}}return f}(this,t,e,n,r)},e.prototype.reshape_impl=function(t,n){return n?this.copy(t):new e(t,this.values,this.dtype)},e.prototype.concat=function(t,n){if(!(t instanceof e))throw new Error("Can only concat CPU tensor to CPU tensor");return n<0&&(n+=this.shape.length),function(t,e,n){var r=B(t.shape);r[n]+=e.shape[n];for(var o=new Q(r,void 0,t.dtype),i=0,a=0,u=0,s=o.strides[n]*t.shape[n],p=o.strides[n]*e.shape[n],c=o.size/(n>0?o.strides[n-1]:o.size),l=0;l<c;l++){for(var h=0;h<s;h++)o.set(u,t.get(i)),u++,i++;for(h=0;h<p;h++)o.set(u,e.get(a)),u++,a++}return o}(this,t,n)},e.prototype.transpose_impl=function(t){return function(t,e){for(var n=t.shape.length,r=new Array(n),o=new Array(n),i=0;i<n;i++)r[i]=t.shape[e[i]],o[e[i]]=i;var a=new Q(r,void 0,t.dtype),u=a.strides,s=new Array(n);for(i=0;i<n;i++)s[i]=u[o[i]];var p=new Array(n).fill(0);for(i=0;i<t.size;i++){for(var c=0,l=0;l<n;l++)c+=p[l]*s[l];a.set(c,t.get(i)),P(p,t.shape)}return a}(this,t)},e.prototype.repeat=function(t){return function(t,e){for(var n=t.shape.length,r=new Array(n),o=0;o<n;o++)r[o]=t.shape[o]*e[o];var i=new Q(r,void 0,t.dtype),a=new Array(n).fill(0);for(o=0;o<i.size;o++){for(var u=new Array(n),s=0;s<n;s++)u[s]=a[s]%t.shape[s];i.set(o,t.get(u)),P(a,i.shape)}return i}(this,t)},e.prototype.expand=function(t){var e=this.alignShapes(this.shape,t),n=e[0],r=(e[1],e[2]);return A(this.shape,r)?this.copy():function(t,e){for(var n=t.shape.length,r=new Q(e,void 0,t.dtype),o=new Array(n).fill(0),i=0;i<r.size;i++)r.set(i,t.get(o)),P(o,r.shape);return r}(this.reshape(n,!1),r)},e.prototype.gather=function(t,e){return function(t,e,n){for(var r=t.shape.length,o=n.shape.length,i=r+o-1,a=new Array(i),u=0;u<e;u++)a[u]=t.shape[u];for(u=0;u<o;u++)a[u+e]=n.shape[u];for(u=e+1;u<r;u++)a[u+o-1]=t.shape[u];var s,p,c=new Q(a,void 0,t.dtype),l=new Array(i).fill(0);for(u=0;u<c.size;u++){s=l.slice(e,e+o);var h=n.get(s);p=U(l.slice(0,e),[h],l.slice(e+o)),c.set(u,t.get(p)),P(l,a)}return c}(this,t,e)},e.prototype.slice_impl=function(t,e,n,r){return function(t,e,n,r,o){for(var i=t.shape.length,a=H(t.shape),u=0,s=0;s<i&&u<r.length;s++)s===r[u]&&(a[s]=Math.ceil((n[u]-e[u])/o[u]),u++);var p,c=new Q(a,void 0,t.dtype),l=new Array(i).fill(0);for(s=0;s<c.size;s++){p=new Array(i);for(var h=0;h<r.length;h++)p[r[h]]=l[r[h]]*o[h]+e[h];c.set(s,t.get(p)),P(l,a)}return c}(this,t,e,n,r)},e.prototype.upsample=function(t){return function(t,e){for(var n=t.shape.length,r=J(t.shape),o=0;o<n;o++)r[o]=Math.floor(r[o]*e[o]);var i=new Q(r,void 0,t.dtype),a=new Array(n).fill(0),u=new Array(n);for(o=0;o<i.size;o++){for(var s=0;s<n;s++)u[s]=Math.floor(a[s]/e[s]);i.set(o,t.get(u)),P(a,r)}return i}(this,t)},e.prototype.normalize=function(t,n,r,o,i){if(!(t instanceof e)||!(n instanceof e)||!(o instanceof e)||!(i instanceof e))throw new Error("Can only normalize with CPU tensors");return function(t,e,n,r,o,i){for(var a=t.shape.length,u=F(t.shape),s=new Q(u,void 0,t.dtype),p=new Array(a).fill(0),c=0;c<s.size;c++){var l=(t.get(p)-e.get(p))/Math.sqrt(n.get(p)+r);l=l*o.get(p)+i.get(p),s.set(c,l),P(p,u)}return s}(this,t,n,r,o,i)},e}(C),Z=n(13),$=n.n(Z),tt=function(){function t(t){this.toNumber=t,this.numEntries=0,this.dict={}}return t.prototype.betweenBoundsFirst=function(t){if(void 0!==t.gte){var e=this.toNumber(t.gte);return void 0!==this.dict[e]&&this.dict[e].length>0?[{key:t.gte,value:this.dict[e][this.dict[e].length-1]}]:[]}if(void 0!==t.lte){e=this.toNumber(t.lte);return void 0!==this.dict[e]&&this.dict[e].length>0?[{key:t.lte,value:this.dict[e][this.dict[e].length-1]}]:[]}return[]},t.prototype.deleteFirst=function(t){var e=this.toNumber(t);void 0!==this.dict[e]&&(this.dict[e].pop(),this.numEntries--)},t.prototype.insert=function(t,e){var n=this.toNumber(t);void 0===this.dict[n]&&(this.dict[n]=[]),this.dict[n].push(e),this.numEntries++},t}();function et(t){return nt(t)}function nt(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!0),!Number.isInteger(t))return e;var r=Math.abs(t);if(r<2)return e;var o=Math.sqrt(r),i=2;if(r%i&&r%(i=3)){i=5;for(var a=2;r%i&&i<o;)i+=a,a=6-a}(i=i<=o?i:r,n)?e.push(i):e.indexOf(i)<0&&e.push(i);return i===r?e:nt(r/i,e,n)}function rt(){for(var t=0,e=0;0===t;)t=Math.random();for(;0===e;)e=Math.random();return[Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*e),Math.sqrt(-2*Math.log(t))*Math.sin(2*Math.PI*e)]}var ot,it,at,ut={float32:"float",float16:"half float",int32:"float",int16:"float",int8:"float",uint32:"float",uint16:"float",uint8:"float"},st=function(){function t(t,e,n){this.orderedDictConstructor=e,this.totalAllocations=0,this.trees={},this.regl=t,this.entryId=0,this.maxSizeFactor=n||2}return t.prototype.getColorType=function(t){return ut[t]},t.prototype.dtypeGroup=function(t){return"float16"===t?"float16":"float32"},t.prototype.allocate=function(t,e){var n=this.dtypeGroup(e),r=t*this.maxSizeFactor,o=4*Math.ceil(t/4);o<r&&(r=o);var i=void 0!==this.trees[n]?this.trees[n].betweenBoundsFirst({gte:o,lte:r}):[];if(0===i.length){var a=Math.ceil(t/4),u=this.getTextureDims(a),s=u.width,p=u.height,c={width:s,height:p,size:s*p*4,frameBuffer:this.regl.framebuffer({width:s,height:p,depthStencil:!1,colorFormat:"rgba",colorType:ut[e]}),id:this.entryId++,dtype:e};return this.totalAllocations++,c}var l=i[0];return this.trees[n].deleteFirst(l.key),l.value.dtype=e,l.value},t.prototype.getAllocationDimensions=function(t,e){var n=this.dtypeGroup(e),r=t*this.maxSizeFactor,o=4*Math.ceil(t/4);o<r&&(r=o);var i=void 0!==this.trees[n]?this.trees[n].betweenBoundsFirst({gte:t,lte:r}):[];if(0===i.length){var a=Math.ceil(t/4);return this.getTextureDims(a)}var u=i[0];return{width:u.value.width,height:u.value.height}},t.prototype.deallocate=function(t){var e=this.dtypeGroup(t.dtype);void 0===this.trees[e]&&(this.trees[e]=this.orderedDictConstructor()),this.trees[e].insert(t.size,t)},t.prototype.allocateTexture=function(t,e){for(var n=Math.ceil(t.length/4),r=this.getTextureDims(n),o=r.width,i=r.height,a=o*i*4,u=new Array(a),s=0;s<t.length;s++)u[s]=t[s];for(s=t.length;s<a;s++)u[s]=0;var p=this.regl.texture({width:o,height:i,format:"rgba",type:ut[e],data:u}),c=this.regl.framebuffer({color:p,width:o,height:i,depthStencil:!1});return this.totalAllocations++,{width:o,height:i,size:a,frameBuffer:c,id:this.entryId++,dtype:e}},t.prototype.allocateOfDimensions=function(t,e,n){var r=t*e*4,o=this.regl.texture({width:t,height:e,format:"rgba",type:ut[n]}),i=this.regl.framebuffer({color:o,width:t,height:e,depthStencil:!1});return this.totalAllocations++,{width:t,height:e,size:r,frameBuffer:i,id:this.entryId++,dtype:n}},t.prototype.allocateFramebuffer=function(t,e){var n=this.regl.framebuffer({color:t,width:t.width,height:t.height,depthStencil:!1,colorType:ut[e]});return this.totalAllocations++,{width:t.width,height:t.height,size:t.width*t.height*4,frameBuffer:n,id:this.entryId++,dtype:e}},t.prototype.getTextureDims=function(t){for(var e=et(t),n=1,r=1,o=0;o<e.length;o+=2)n*=e[o],o+1<e.length&&(r*=e[o+1]);return{width:n,height:r}},t.prototype.getNumEntries=function(){var t=0;for(var e in this.trees)t+=this.trees[e].numEntries;return t},t}(),pt=document.createElement("canvas");ot=pt.getContext("webgl",{failIfMajorPerformanceCaveat:!1}),it=$()({gl:ot,extensions:["OES_texture_float","WEBGL_color_buffer_float","OES_texture_half_float"]}),at=new st(it,(function(){return new tt((function(t){return t}))}));var ct=function(){return(ct=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},lt=function(){function t(t,e,n,r){this.dtype=e,this.statics=new Set,this.copyCounter=0,this.fullyStatic=!1,void 0===n&&(n=at),void 0===r&&(r=10),this.allocator=n,this.maxRank=r,this.gpuTensorConstructor=t}return t.prototype.registerStatics=function(t){var e=0,n=0;for(var r in t)if(r.startsWith("shape")){var o=r.slice("shape".length);this.statics.add("shape"+o),this.statics.add("size"+o),this.statics.add("rank"+o),this.statics.add("strides"+o),e++}else this.statics.add(r),r.startsWith("width")||r.startsWith("height")||n++;e-1===this.getTextureNames().length&&n===this.getUniformAttrs().length&&(this.fullyStatic=!0,this.outputShape=t.shapeOutput)},t.prototype.getVarModifier=function(t){return this.statics.has(t)?"":"uniform"},t.prototype.pad=function(t,e){for(void 0===e&&(e=this.maxRank);t.length<e;)t.push(-1);return t},t.prototype.copyPad=function(t,e){void 0===e&&(e=this.maxRank);for(var n=Array.from(t);n.length<e;)n.push(-1);return n},t.prototype.getVariables=function(){return""},t.prototype.getVariableDeclarations=function(){var t=this,e=this.getTextureNames();return e.push("Output"),"\n      "+e.map((function(e){return"\n        "+("Output"===e?"":"uniform sampler2D "+e+";")+"\n        "+t.getVarModifier("size"+e)+" int size"+e+";\n        "+t.getVarModifier("width"+e)+" int width"+e+";\n        "+t.getVarModifier("height"+e)+" int height"+e+";\n        "+t.getVarModifier("strides"+e)+" int strides"+e+"["+t.maxRank+"];\n        "+t.getVarModifier("shape"+e)+" int shape"+e+"["+t.maxRank+"];\n        "+t.getVarModifier("rank"+e)+" int rank"+e+";\n        "})).join("\n")+"\n      varying vec2 uv;\n\n      "+this.getVariables()},t.prototype.getVariableInitializations=function(t){var e=this.getTextureNames();e.push("Output");for(var n="",r=0,o=e;r<o.length;r++){var i=o[r];if("shape"+i in t){var a=t["shape"+i],u=k(a),s=O(a),p=a.length;n+=this.getArrayInit("shape"+i,a),n+=this.getArrayInit("strides"+i,u),n+="\nsize"+i+" = "+s+";",n+="\nrank"+i+" = "+p+";"}}for(var c in t){if(!c.startsWith("shape"))if(Array.isArray(t[c]))n+=this.getArrayInit(c,t[c]);else n+="int"===this.getVarType(c)?"\n"+c+" = "+t[c]+";":"\n"+c+" = "+t[c].toPrecision(20)+";"}return n},t.prototype.getVarType=function(t){var e=this.getUniformAttrs().find((function(e){return e.name===t}));return void 0!==e&&e.type?e.type:"int"},t.prototype.getArrayInit=function(t,e,n,r){void 0===n&&(n=this.maxRank);var o=this.getVarType(t);void 0===r&&("int"===o?r="-1":"float"===o&&(r="-1.0"));for(var i="",a=0;a<n;a++)a<e.length?"int"===o?i+="\n "+t+"["+a+"] = "+e[a]+";":"float"===o&&(i+="\n "+t+"["+a+"] = "+e[a].toPrecision(20)+";"):i+="\n "+t+"["+a+"] = "+r+";";return i},t.prototype.getUtilFunctions=function(){return"\n    int fromFloat(float f) {\n      return int(floor(f+0.5));\n    }\n\n    int coordinateToPos(vec2 coordinate, int textureWidth, int textureHeight) {\n      int x = (fromFloat(coordinate.x*float(textureWidth*2))-1)/2;\n      int y = (fromFloat(coordinate.y*float(textureHeight*2))-1)/2;\n\n      int pos = x + y*textureWidth;\n\n      return pos*4;\n    }\n\n    vec2 posToCoordinate(int pos, int textureWidth, int textureHeight) {\n      pos = pos/4;\n\n      int y = pos/textureWidth;\n      int x = pos - y*textureWidth;\n\n      return vec2(float(x*2+1)/float(textureWidth*2), float(y*2+1)/float(textureHeight*2));\n    }\n\n    int indexToPos(int index["+this.maxRank+"], int strides["+this.maxRank+"]) {\n      int pos = 0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (strides[i] == -1) {\n          break;\n        }\n        pos += index[i]*strides[i];\n      }\n      return pos;\n    }\n\n    // TODO: Change return type based on dtype of operation\n    // TODO: Change values per texel here\n    float getValueAtPos(int pos, int textureWidth, int textureHeight, sampler2D tex) {\n      vec2 coord = posToCoordinate(pos, textureWidth, textureHeight);\n      int res = pos - (pos/4)*4;\n      vec4 val = texture2D(tex, coord);\n      if (res == 0) {\n        return val.r;\n      } else if (res == 1) {\n        return val.g;\n      } else if (res == 2) {\n        return val.b;\n      } else {\n        return val.a;\n      }\n    }\n\n    // TODO: Change return type based on dtype of operation\n    float getValueAt(int index["+this.maxRank+"], int strides["+this.maxRank+"], int textureWidth, int textureHeight, sampler2D tex) {\n      int pos = indexToPos(index, strides);\n      return getValueAtPos(pos, textureWidth, textureHeight, tex);\n    }"},t.prototype.getTextureFunctions=function(){var t=this;return this.getTextureNames().map((function(e){return"\n        float _"+e+"(int indices["+t.maxRank+"]) {\n          return getValueAt(indices, strides"+e+", width"+e+", height"+e+", "+e+");\n        }\n      "})).join("\n")},t.prototype.getCompleteFragmentShader=function(t){var e=this.getFragmentShader(t),n=this.getVariableDeclarations(),r=this.getVariableInitializations(t),o=this.getUtilFunctions(),i=this.getTextureFunctions();return"\n    // TODO: Change between int/float here\n    precision "+this.precisionString()+" float;\n\n    "+n+"\n\n    "+o+"\n    "+i+"\n\n    void initVars() {\n      "+r+"\n    }\n\n    "+e},t.prototype.getUniforms=function(t){for(var e=[],n=0,r=this.getUniformAttrs();n<r.length;n++){var o=r[n];void 0===t[o.name]&&e.push(o)}var i=this.getTextureNames();i.push("Output");for(var a=0,u=i;a<u.length;a++){var s=u[a];e.push({name:s}),void 0===t["shape"+s]&&(e.push({name:"size"+s}),e.push({name:"strides"+s,length:this.maxRank}),e.push({name:"shape"+s,length:this.maxRank}),e.push({name:"rank"+s})),void 0===t["width"+s]&&e.push({name:"width"+s}),void 0===t["height"+s]&&e.push({name:"height"+s})}for(var p={},c=0,l=e;c<l.length;c++){var h=l[c];if(void 0===t[h.name])if(void 0!==h.length)for(var f=0;f<h.length;f++){var d=h.name+"["+f+"]";p[d]=it.prop(d)}else p[h.name]=it.prop(h.name)}return p},t.prototype.posToIndex=function(t,e,n){var r=n+"_"+this.copyCounter++;return"\n    int "+r+" = "+n+";\n    for (int i = 0; i < "+this.maxRank+"; i++) {\n      if ("+t+"[i] == -1) {\n        "+e+"[i] = -1;\n      } else {\n        if ("+t+"[i] == 0) {\n          "+e+"[i] = 0;\n        } else {\n          "+e+"[i] = "+r+"/"+t+"[i];\n          "+r+" = "+r+" - "+t+"[i]*"+e+"[i]; // Stupid modulo hack\n        }\n      }\n    }"},t.prototype.initIndex=function(t,e){return void 0===e?"\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          "+t+"[i] = -1;\n        }":"\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (i < "+e+") {\n            "+t+"[i] = 0;\n          } else {\n            "+t+"[i] = -1;\n          }\n        }"},t.prototype.incrementIndex=function(t,e){return"\n    for (int i = "+this.maxRank+" - 1; i >= 0; i--) {\n      if ("+e+"[i] != -1) {\n        "+t+"[i] += 1;\n        if ("+t+"[i] >= "+e+"[i]) {\n          "+t+"[i] = 0;\n        } else {\n          break;\n        }\n      }\n    }\n    "},t.prototype.incrementConditional=function(t,e,n){return"\n    for (int i = 0; i < "+this.maxRank+"; i++) {\n      if ("+n+"[i] == 1) {\n        "+t+"[i] += 1;\n        if ("+t+"[i] >= "+e+"[i]) {\n          "+t+"[i] = 0;\n        } else {\n          break;\n        }\n      } else if ("+n+"[i] == -1) {\n        break;\n      }\n    }\n    "},t.prototype.getDefaultMain=function(){return"\n    void main() {\n      initVars();\n\n      int pos = coordinateToPos(uv, widthOutput, heightOutput);\n\n      // TODO: change number of values per pixel here\n      vec4 result = vec4(0,0,0,0);\n\n      if (pos < sizeOutput) {\n        int index["+this.maxRank+"];\n        "+this.posToIndex("stridesOutput","index","pos")+"\n        result.r = process(index);\n\n        pos += 1;\n\n        if (pos < sizeOutput) {\n          "+this.posToIndex("stridesOutput","index","pos")+"\n          result.g = process(index);\n\n          pos += 1;\n\n          if (pos < sizeOutput) {\n            "+this.posToIndex("stridesOutput","index","pos")+"\n            result.b = process(index);\n\n            pos += 1;\n\n            if (pos < sizeOutput) {\n              "+this.posToIndex("stridesOutput","index","pos")+"\n              result.a = process(index);\n            }\n          }\n        }\n      }\n\n      gl_FragColor = result;\n    }"},t.prototype.precisionString=function(){return"float16"===this.dtype?"mediump":"highp"},t.prototype.getDrawCommand=function(t){var e=this.getCompleteFragmentShader(t),n=this.getUniforms(t);return it({frag:e,vert:"\n        // TODO: Change between float/int\n        precision "+this.precisionString()+" float;\n        attribute vec2 position;\n        varying vec2 uv;\n        void main() {\n          uv = 0.5 * (position + 1.0);\n          gl_Position = vec4(position, 0, 1);\n        }",attributes:{position:[-4,-4,4,-4,0,4]},uniforms:n,framebuffer:it.prop("framebuffer"),depth:{enable:!1},count:3})},t.prototype.compile=function(t){this.registerStatics(t),this.drawCommand=this.getDrawCommand(t)},t.prototype.compute=function(t,e,n){void 0===this.drawCommand&&this.compile({});var r=O(t),o=this.allocator.allocate(r,this.dtype);for(var i in e){if(e[i].memory.id===o.id)throw new Error("Allocator returned a framebuffer that is also an input\n                         Did you delete a GPU tensor that was still used elsewhere?")}var a={};for(var u in e)a[u]=e[u].memory.frameBuffer;if(void 0===n&&(n={}),!this.fullyStatic){for(var s in e)this.statics.has("shape"+s)||(n["size"+s]=e[s].size,n["strides"+s]=this.pad(k(e[s].shape)),n["shape"+s]=this.copyPad(e[s].shape),n["rank"+s]=e[s].shape.length),this.statics.has("width"+s)||(n["width"+s]=e[s].memory.width),this.statics.has("height"+s)||(n["height"+s]=e[s].memory.height);this.statics.has("shapeOutput")||(n.sizeOutput=r,n.stridesOutput=this.pad(k(t)),n.shapeOutput=this.copyPad(t),n.rankOutput=t.length),this.statics.has("widthOutput")||(n.widthOutput=o.width),this.statics.has("heightOutput")||(n.heightOutput=o.height)}return this.drawCommand(ct(ct({framebuffer:o.frameBuffer},a),n)),this.gpuTensorConstructor(o,t,this.precision)},t.prototype.getUniformAttrs=function(){return[]},t}(),ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ft=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o.maxRank=2,o}return ht(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int ix1["+this.maxRank+"];\n      "+this.initIndex("ix1")+"\n      ix1[0] = index[0];\n\n      int ix2["+this.maxRank+"];\n      "+this.initIndex("ix2")+"\n      ix2[1] = index[1];\n\n      int k = shapeA[1];\n\n      float res = 0.0;\n\n      for (int i = 0; i < "+this.maxIterations+"; i++) {\n        if (i >= k) {\n          break;\n        }\n        ix1[1] = i;\n        ix2[0] = i;\n\n        float v1 = _A(ix1);\n        float v2 = _B(ix2);\n        res += v1*v2;\n      }\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A","B"]},e.prototype.calc=function(t){var e=this.getOutputShape(t);return this.compute(e,{A:t.A,B:t.B})},e.prototype.getOutputShape=function(t){return[t.A.shape[0],t.B.shape[1]]},e.prototype.compile=function(e){void 0!==e.shapeA?this.maxIterations=e.shapeA[1]:void 0!==e.shapeB&&(this.maxIterations=e.shapeB[0]),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeB:t.A.shape,widthB:t.A.memory.width,heightB:t.A.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.B.shape},e}(lt),dt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yt=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return dt(e,t),e.prototype.getFragmentShader=function(t){return"\n    void main() {\n      initVars();\n\n      gl_FragColor = "+this.operation("texture2D(X, uv)")+";\n    }\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.calc=function(t){return this.compute(t.input.shape,{X:t.input})},e.prototype.getOutputShape=function(t){return t.input.shape},e.prototype.compile=function(e){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:this.getOutputShape(t),widthOutput:n.width,heightOutput:n.height}},e.prototype.getInputInfoString=function(t){return""+t.input.shape},e}(lt),mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return mt(e,t),e.prototype.operation=function(t){return"exp("+t+")"},e}(yt),wt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gt=function(){return(gt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},bt=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o}return wt(e,t),e.prototype.updateInputIx=function(){return"\n    for (int d = 0; d < "+(this.maxRank-2)+"; d++) {\n      int stride = strides[d];\n      int pad = pads[d];\n      int dilation = dilations[d];\n      if (stride == -1) {\n        break;\n      }\n\n      inputIx[d+2] = index[d+2]*stride - pad + kernelIx[d+2]*dilation;\n      if (inputIx[d+2] < 0 || inputIx[d+2] >= shapeX[d+2]) {\n        skip = true;\n        break;\n      }\n    }\n    "},e.prototype.getMainBody=function(){return"\n    int n = index[0];\n    int m = index[1];\n\n    int kernelIx["+this.maxRank+"];\n    "+this.initIndex("kernelIx")+"\n    for (int i = 0; i < "+this.maxRank+"; i++) {\n      if (i >= dataRank) {\n        break;\n      }\n      kernelIx[i+2] = 0;\n    }\n    kernelIx[0] = m;\n    int inputIx["+this.maxRank+"];\n    "+this.initIndex("inputIx")+"\n    inputIx[0] = n;\n\n    for (int cg = 0; cg < "+this.maxIterations+"; cg++) {\n      if (cg >= CG) {\n        break;\n      }\n      int c = m * CG + cg;\n      int d = c/C;\n      c = c - d*C;\n      inputIx[1] = c;\n      kernelIx[1] = cg;\n      for (int kIx = 0; kIx < "+this.maxIterations+"; kIx++) {\n        if (kIx >= kernelSize) {\n          break;\n        }\n\n        bool skip = false;\n\n        "+this.updateInputIx()+"\n\n        if (!skip) {\n          res += _X(inputIx) * _W(kernelIx);\n        }\n\n        "+this.incrementIndex("kernelIx","shapeW")+"\n      }\n    }\n    "},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("CG")+" int CG;\n    "+this.getVarModifier("kernelSize")+" int kernelSize;\n    "+this.getVarModifier("dataRank")+" int dataRank;\n    "+this.getVarModifier("C")+" int C;\n    "+this.getVarModifier("dilations")+" int dilations["+this.maxRank+"];\n    "+this.getVarModifier("pads")+" int pads["+this.maxRank+"];\n    "+this.getVarModifier("strides")+" int strides["+this.maxRank+"];\n    "+this.getVarModifier("activation")+" int activation;\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      float res = 0.0;\n\n      "+this.getMainBody()+"\n\n      if (activation == 1) {\n        res = max(0.0, res);\n      } else if (activation == 2) {\n        res = max(0.0, min(res,6.0));\n      }\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X","W"]},e.prototype.getUniformAttrs=function(){return[{name:"CG"},{name:"kernelSize"},{name:"C"},{name:"dataRank"},{name:"pads",length:2*this.maxRank},{name:"strides",length:this.maxRank},{name:"dilations",length:this.maxRank},{name:"activation"}]},e.prototype.getActivationFlag=function(t){return"id"===t?0:"relu"===t?1:2},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{X:t.X,W:t.W});var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=t.W.shape.slice(2),i=t.W.shape[0],a=t.W.shape[1],u=O(o),s=V(r,o,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),t.dilations,t.strides),p=[e,i];return p=p.concat(s),this.compute(p,{X:t.X,W:t.W},{CG:a,kernelSize:u,C:n,dataRank:r.length,pads:this.copyPad(t.pads,2*this.maxRank),strides:this.copyPad(t.strides),dilations:this.copyPad(t.dilations),activation:this.getActivationFlag(t.activation)})},e.prototype.getOutputShape=function(t){var e=t.X.shape[0],n=t.X.shape.slice(2),r=t.W.shape.slice(2),o=t.W.shape[0],i=V(n,r,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),t.dilations,t.strides),a=[e,o];return a=a.concat(i)},e.prototype.compile=function(e){void 0!==e.shapeW&&(e.CG=e.shapeW[1],e.kernelSize=O(e.shapeW.slice(2)),e.dataRank=e.shapeW.length-2,this.maxRank=e.shapeW.length),void 0!==e.shapeX&&(e.C=e.shapeX[1],e.dataRank=e.shapeX.length-2,this.maxRank=e.shapeX.length),void 0!==e.activation&&"string"===typeof e.activation&&(e.activation=this.getActivationFlag(e.activation)),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype),r=O(t.W.shape.slice(2)),o=t.X.shape[1],i=t.X.shape.slice(2);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeW:t.W.shape,widthW:t.W.memory.width,heightW:t.W.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,pads:t.pads,dilations:t.dilations,strides:t.strides,CG:t.W.shape[1],kernelSize:r,dataRank:i.length,C:o,activation:this.getActivationFlag(t.activation)}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.W.shape+"-"+t.dilations+"-"+t.pads+"-"+t.dilations+"-"+t.strides+"-"+t.activation},e}(lt),_t=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o}return wt(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int biasIndex["+this.maxRank+"];\n      "+this.initIndex("biasIndex")+"\n      biasIndex[0] = index[1];\n      float res = _B(biasIndex);\n\n      "+this.getMainBody()+"\n\n      if (activation == 1) {\n        res = max(0.0, res);\n      } else if (activation == 2) {\n        res = max(0.0, min(res,6.0));\n      }\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X","W","B"]},e.prototype.calc=function(t){var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=t.W.shape.slice(2),i=t.W.shape[0],a=t.W.shape[1],u=O(o),s=V(r,o,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),t.dilations,t.strides),p=[e,i];return p=p.concat(s),this.compute(p,{X:t.X,W:t.W,B:t.B},{CG:a,kernelSize:u,C:n,dataRank:r.length,pads:this.copyPad(t.pads,2*this.maxRank),strides:this.copyPad(t.strides),dilations:this.copyPad(t.dilations),activation:this.getActivationFlag(t.activation)})},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return gt(gt({},n),{shapeB:e.B.shape,widthB:e.B.memory.width,heightB:e.B.memory.height})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.B.shape},e}(bt),xt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ot=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return xt(e,t),e.prototype.operation=function(t){return"abs("+t+")"},e}(yt),kt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),St=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return kt(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int["+this.maxRank+"] index) {\n      return "+this.getOp("_A(index)","_B(index)")+";\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getOutputShape=function(t){return t.outputShape},e.prototype.getTextureNames=function(){return["A","B"]},e.prototype.calc=function(t){return this.compute(t.outputShape,{A:t.A,B:t.B})},e.prototype.compile=function(e){void 0!==e.shapeA&&(this.maxRank=e.shapeA.length),void 0!==e.shapeB&&(this.maxRank=e.shapeB.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=at.getAllocationDimensions(O(t.outputShape),this.dtype);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeB:t.B.shape,widthB:t.B.memory.width,heightB:t.B.memory.height,shapeOutput:t.outputShape,widthOutput:e.width,heightOutput:e.height}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.B.shape},e}(lt),At=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pt=function(){return(Pt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},jt=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return At(e,t),e.prototype.getOp=function(t,e){return"alpha*"+t+" + beta*"+e},e.prototype.calc=function(t){return this.compute(t.outputShape,{A:t.A,B:t.B},{alpha:t.alpha,beta:t.beta})},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("alpha")+" float alpha;\n    "+this.getVarModifier("beta")+" float beta;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"alpha",type:"float"},{name:"beta",type:"float"}]},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return Pt(Pt({},n),{alpha:e.alpha,beta:e.beta})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.alpha+"-"+e.beta},e}(St),Mt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tt=function(){return(Tt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},It=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Mt(e,t),e.prototype.getOp=function(t,e){return"alpha*"+t+" * "+e},e.prototype.calc=function(t){return this.compute(t.outputShape,{A:t.A,B:t.B},{alpha:t.alpha})},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("alpha")+" float alpha;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"alpha",type:"float"}]},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return Tt(Tt({},n),{alpha:e.alpha})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.alpha},e}(St),Ct=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(){return(Gt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Vt=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Ct(e,t),e.prototype.getOp=function(t,e){return"alpha*"+t+" - beta*"+e},e.prototype.calc=function(t){return this.compute(t.outputShape,{A:t.A,B:t.B},{alpha:t.alpha,beta:t.beta})},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("alpha")+" float alpha;\n    "+this.getVarModifier("beta")+" float beta;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"alpha",type:"float"},{name:"beta",type:"float"}]},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return Gt(Gt({},n),{alpha:e.alpha,beta:e.beta})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.alpha+"-"+e.beta},e}(St),Et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(){return(Rt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xt=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Et(e,t),e.prototype.getOp=function(t,e){return"alpha*"+t+" / "+e},e.prototype.calc=function(t){return this.compute(t.outputShape,{A:t.A,B:t.B},{alpha:t.alpha})},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("alpha")+" float alpha;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"alpha",type:"float"}]},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return Rt(Rt({},n),{alpha:e.alpha})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.alpha},e}(St),Bt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o}return Bt(e,t),e.prototype.updateInputIx=function(){return"\n    for (int d = 0; d < "+(this.maxRank-2)+"; d++) {\n      int stride = strides[d];\n      int pad = pads[d];\n      if (stride == -1) {\n        break;\n      }\n\n      inputIx[d+2] = index[d+2]*stride - pad + kernelIx[d];\n      if (inputIx[d+2] < 0 || inputIx[d+2] >= shapeX[d+2]) {\n        skip = true;\n        break;\n      }\n    }\n    "},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("kernelSize")+" int kernelSize;\n    "+this.getVarModifier("dataRank")+" int dataRank;\n    "+this.getVarModifier("includePad")+" int includePad;\n    "+this.getVarModifier("pads")+" int pads["+this.maxRank+"];\n    "+this.getVarModifier("strides")+" int strides["+this.maxRank+"];\n    "+this.getVarModifier("kernelShape")+" int kernelShape["+this.maxRank+"];\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      float res = 0.0;\n      int count = 0;\n\n      int n = index[0];\n      int c = index[1];\n\n      int kernelIx["+this.maxRank+"];\n      "+this.initIndex("kernelIx")+"\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (i >= dataRank) {\n          break;\n        }\n        kernelIx[i] = 0;\n      }\n      int inputIx["+this.maxRank+"];\n      "+this.initIndex("inputIx")+"\n      inputIx[0] = n;\n      inputIx[1] = c;\n\n      for (int kIx = 0; kIx < "+this.maxIterations+"; kIx++) {\n        if (kIx >= kernelSize) {\n          break;\n        }\n\n        bool skip = false;\n\n        "+this.updateInputIx()+"\n\n        if (!skip) {\n          res += _X(inputIx);\n        }\n\n        if (!skip || includePad == 1) {\n          count += 1;\n        }\n\n        "+this.incrementIndex("kernelIx","kernelShape")+"\n      }\n\n      res = res / float(count);\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getUniformAttrs=function(){return[{name:"kernelSize"},{name:"dataRank"},{name:"includePad"},{name:"pads",length:2*this.maxRank},{name:"strides",length:this.maxRank},{name:"kernelShape",length:this.maxRank}]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{X:t.X});var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=O(t.kernelShape),i=V(r,t.kernelShape,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),new Array(r.length).fill(1),t.strides),a=[e,n];return a=a.concat(i),this.compute(a,{X:t.X},{kernelSize:o,includePad:t.includePad?1:0,dataRank:r.length,pads:this.copyPad(t.pads,2*this.maxRank),strides:this.copyPad(t.strides),kernelShape:this.copyPad(t.kernelShape)})},e.prototype.getOutputShape=function(t){var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=V(r,t.kernelShape,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),new Array(r.length).fill(1),t.strides),i=[e,n];return i=i.concat(o)},e.prototype.compile=function(e){void 0!==e.shapeX&&(e.dataRank=e.shapeX.length-2,this.maxRank=e.shapeX.length),!0===e.includePad?e.includePad=1:!1===e.includePad&&(e.includePad=0),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype),r=O(t.kernelShape);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,kernelShape:t.kernelShape,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,pads:t.pads,strides:t.strides,kernelSize:r,dataRank:t.X.shape.length-2,includePad:t.includePad?1:0}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.kernelShape+"-"+t.pads+"-"+t.strides+"-"+t.includePad},e}(lt),Ut=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wt=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o}return Ut(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("mappedInputStrides")+" int mappedInputStrides["+this.maxRank+"];\n    "+this.getVarModifier("mappedInputStrides")+" int sumDims["+this.maxRank+"];\n    "+this.getVarModifier("mappedInputStrides")+" int sumSize;\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inputIx["+this.maxRank+"];\n      "+this.initIndex("inputIx")+"\n\n      int inputPos = 0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (mappedInputStrides[i] == -1 || index[i] == -1) {\n          break;\n        }\n        inputPos += mappedInputStrides[i]*index[i];\n      }\n\n      "+this.posToIndex("stridesX","inputIx","inputPos")+"\n\n      float res = 0.0;\n\n      for (int i = 0; i < "+this.maxIterations+"; i++) {\n        if (i >= sumSize) {\n          break;\n        }\n        float curr = _X(inputIx);\n        if (i == 0) {\n          res = "+this.init("curr")+";\n        } else {\n          res = "+this.update("curr","res")+";\n        }\n\n        "+this.incrementConditional("inputIx","shapeX","sumDims")+"\n      }\n\n      "+this.post("res")+"\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.post=function(t){return""},e.prototype.init=function(t){return t},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getUniformAttrs=function(){return[{name:"mappedInputStrides",length:this.maxRank},{name:"sumDims",length:this.maxRank},{name:"sumSize"}]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{X:t.X});for(var e=z(t.X.shape,t.axes,t.keepDims),n=e[0],r=e[1],o=k(t.X.shape),i=[],a=0,u=r;a<u.length;a++){var s=u[a];i.push(o[s])}var p=1,c=new Array(t.X.shape.length).fill(0);for(s=0;s<t.axes.length;s++)c[t.axes[s]]=1,p*=t.X.shape[t.axes[s]];return this.compute(n,{X:t.X},{mappedInputStrides:this.pad(i),sumDims:this.pad(c),sumSize:p})},e.prototype.getOutputShape=function(t){var e=z(t.X.shape,t.axes,t.keepDims),n=e[0];e[1];return n},e.prototype.compile=function(e){if(void 0!==e.shapeX&&void 0!==e.axes&&void 0!==e.keepDims){for(var n=z(e.shapeX,e.axes,e.keepDims),r=n[0],o=n[1],i=k(e.shapeX),a=[],u=0,s=o;u<s.length;u++){var p=s[u];a.push(i[p])}var c=1,l=new Array(e.shapeX.length).fill(0);for(p=0;p<e.axes.length;p++)l[e.axes[p]]=1,c*=e.shapeX[e.axes[p]];e.sumDims=l,e.shapeOutput=r,e.mappedInputStrides=a,e.sumSize=c,delete e.keepDims,delete e.axes,this.maxRank=e.shapeX.length}t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){for(var e=z(t.X.shape,t.axes,t.keepDims),n=e[0],r=e[1],o=k(t.X.shape),i=[],a=0,u=r;a<u.length;a++){var s=u[a];i.push(o[s])}var p=1,c=new Array(t.X.shape.length).fill(0);for(s=0;s<t.axes.length;s++)c[t.axes[s]]=1,p*=t.X.shape[t.axes[s]];var l=at.getAllocationDimensions(O(n),this.dtype);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeOutput:n,widthOutput:l.width,heightOutput:l.height,mappedInputStrides:i,sumDims:c,sumSize:p}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.axes+"-"+t.keepDims},e}(lt),zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return zt(e,t),e.prototype.update=function(t,e){return t+" + "+e},e.prototype.post=function(t){return t+" = "+t+"/float(sumSize);"},e}(Wt),Ft=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ft(e,t),e.prototype.update=function(t,e){return"("+t+"*"+t+") + "+e},e.prototype.post=function(t){return t+" = "+t+"/float(sumSize);"},e.prototype.init=function(t){return t+"*"+t},e}(Wt),qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qt(e,t),e.prototype.update=function(t,e){return"("+t+"*"+t+") + "+e},e.prototype.init=function(t){return t+"*"+t},e}(Wt),Jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Jt(e,t),e.prototype.update=function(t,e){return t+" + "+e},e}(Wt),Yt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yt(e,t),e.prototype.update=function(t,e){return t+" * "+e},e}(Wt),Zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$t=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Zt(e,t),e.prototype.update=function(t,e){return"max("+t+", "+e+")"},e}(Wt),te=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return te(e,t),e.prototype.update=function(t,e){return"min("+t+", "+e+")"},e}(Wt),ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return ne(e,t),e.prototype.operation=function(t){return"ceil("+t+")"},e}(yt),oe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ie=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return oe(e,t),e.prototype.getFragmentShader=function(t){return"\n    void main() {\n      initVars();\n\n      vec4 maxVec = vec4(maxVal,maxVal,maxVal,maxVal);\n      vec4 minVec = vec4(minVal,minVal,minVal,minVal);\n\n      vec4 res = texture2D(X, uv);\n      if (doMin == 1) {\n        res = max(minVec, res);\n      }\n      if (doMax == 1) {\n        res = min(maxVec, res);\n      }\n\n      gl_FragColor = res;\n    }\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("minVal")+" float minVal;\n    "+this.getVarModifier("maxVal")+" float maxVal;\n    "+this.getVarModifier("doMin")+" int doMin;\n    "+this.getVarModifier("doMax")+" int doMax;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"minVal",type:"float"},{name:"maxVal",type:"float"},{name:"doMin"},{name:"doMax"}]},e.prototype.calc=function(t){return this.fullyStatic&&void 0!==this.outputShape?this.compute(this.outputShape,{X:t.input}):this.compute(t.input.shape,{X:t.input},{minVal:void 0!==t.minVal?t.minVal:0,maxVal:void 0!==t.maxVal?t.maxVal:0,doMin:void 0!==t.minVal?1:0,doMax:void 0!==t.maxVal?1:0})},e.prototype.getOutputShape=function(t){return t.input.shape},e.prototype.compile=function(e){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=at.getAllocationDimensions(t.input.size,this.dtype);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:t.input.shape,widthOutput:e.width,heightOutput:e.height,minVal:void 0!==t.minVal?t.minVal:0,maxVal:void 0!==t.maxVal?t.maxVal:0,doMin:void 0!==t.minVal?1:0,doMax:void 0!==t.maxVal?1:0}},e.prototype.getInputInfoString=function(t){return t.input.shape+"-"+t.minVal+"-"+t.maxVal},e}(lt),ae=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ue=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return ae(e,t),e.prototype.operation=function(t){return"floor("+t+")"},e}(yt),se=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pe=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},ce=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return se(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("axis")+" int axis;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"axis"}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      float res = 0.0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (i == axis) {\n          if (index[i] >= shapeA[i]) {\n            index[i] = index[i] - shapeA[i];\n            res = _B(index);\n          } else {\n            res = _A(index);\n          }\n          break;\n        }\n      }\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A","B"]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{A:t.A,B:t.B});var e=this.getOutputShape(t);return this.compute(e,{A:t.A,B:t.B},{axis:t.axis})},e.prototype.getOutputShape=function(t){var e=pe(t.A.shape);return e[t.axis]+=t.B.shape[t.axis],e},e.prototype.compile=function(e){void 0!==e.shapeA&&(this.maxRank=e.shapeA.length),void 0!==e.shapeB&&(this.maxRank=e.shapeB.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeB:t.B.shape,widthB:t.B.memory.width,heightB:t.B.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,axis:t.axis}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.B.shape+"-"+t.axis},e}(lt),le=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),he=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return le(e,t),e.prototype.getFragmentShader=function(t){return"\n    void main() {\n      initVars();\n\n      gl_FragColor = texture2D(X, uv);\n    }\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.calc=function(t){var e=this.getOutputShape(t);return this.compute(e,{X:t.input})},e.prototype.getOutputShape=function(t){var e=t.outputShape;return void 0===e&&(e=t.input.shape),e},e.prototype.compile=function(e){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height}},e.prototype.getInputInfoString=function(t){return t.input+"-"+this.getOutputShape(t)},e}(lt),fe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),de=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return fe(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      return _X(index);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.calc=function(t){return this.compute(t.outputShape,{X:t.input})},e.prototype.getOutputShape=function(t){return t.outputShape},e.prototype.compile=function(e){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height}},e.prototype.getInputInfoString=function(t){return t.input.shape+"-"+t.outputShape},e}(lt),ye=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),me=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.gatherMaxIxSize=10,o}return ye(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("axis")+" int axis;\n    "+this.getVarModifier("indexValues")+" int indexValues["+this.gatherMaxIxSize+"];\n    "+this.getVarModifier("mappedIndexStrides")+" int mappedIndexStrides["+this.maxRank+"];\n    "+this.getVarModifier("mappedInputStrides")+" int mappedInputStrides["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"axis"},{name:"indexValues",length:this.gatherMaxIxSize},{name:"mappedInputStrides",length:this.maxRank},{name:"mappedIndexStrides",length:this.maxRank}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inputPos = 0;\n      int indexPos = 0;\n\n      int strideAxis = 0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (index[i] == -1) {\n          break;\n        }\n        if (i == axis) {\n          strideAxis = stridesX[i];\n        }\n        inputPos += mappedInputStrides[i]*index[i];\n        indexPos += mappedIndexStrides[i]*index[i];\n      }\n\n      for (int i = 0; i < "+this.gatherMaxIxSize+"; i++) {\n        if (i == indexPos) {\n          inputPos += indexValues[i]*strideAxis;\n          break;\n        }\n      }\n\n      return getValueAtPos(inputPos, widthX, heightX, X);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{X:t.X});if(t.indices.size>this.gatherMaxIxSize)throw new Error("Gather on GPU can deal with at most "+this.gatherMaxIxSize+" indices, input had "+t.indices.size);for(var e=t.X.shape.length,n=t.indices.shape.length,r=k(t.X.shape),o=k(t.indices.shape),i=e+n-1,a=new Array(i),u=new Array(i).fill(0),s=new Array(i).fill(0),p=0;p<t.axis;p++)a[p]=t.X.shape[p],u[p]=r[p],s[p]=0;for(p=0;p<n;p++)a[p+t.axis]=t.indices.shape[p],s[p+t.axis]=o[p],u[p+t.axis]=0;for(p=t.axis+1;p<e;p++)a[p+n-1]=t.X.shape[p],u[p+n-1]=r[p],s[p+n-1]=0;return this.compute(a,{X:t.X},{axis:t.axis,indexValues:this.pad(Array.from(t.indices.values),this.gatherMaxIxSize),mappedInputStrides:this.pad(u),mappedIndexStrides:this.pad(s)})},e.prototype.getOutputShape=function(t){for(var e=t.X.shape.length,n=t.indices.shape.length,r=new Array(e+n-1),o=0;o<t.axis;o++)r[o]=t.X.shape[o];for(o=0;o<n;o++)r[o+t.axis]=t.indices.shape[o];for(o=t.axis+1;o<e;o++)r[o+n-1]=t.X.shape[o];return r},e.prototype.compile=function(e){if(void 0!==e.shapeX&&(this.maxRank=e.shapeX.length,void 0!==e.indices&&void 0!==e.axis)){for(var n=e.shapeX.length,r=e.indices.shape.length,o=k(e.shapeX),i=k(e.indices.shape),a=n+r-1,u=new Array(a),s=new Array(a).fill(0),p=new Array(a).fill(0),c=0;c<e.axis;c++)u[c]=e.shapeX[c],s[c]=o[c],p[c]=0;for(c=0;c<r;c++)u[c+e.axis]=e.indices.shape[c],p[c+e.axis]=i[c],s[c+e.axis]=0;for(c=e.axis+1;c<n;c++)u[c+r-1]=e.shapeX[c],s[c+r-1]=o[c],p[c+r-1]=0;e.mappedIndexStrides=p,e.mappedInputStrides=s,e.indexValues=Array.from(e.indices.values),delete e.indices}t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){for(var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype),r=t.X.shape.length,o=t.indices.shape.length,i=k(t.X.shape),a=k(t.indices.shape),u=r+o-1,s=new Array(u),p=new Array(u).fill(0),c=new Array(u).fill(0),l=0;l<t.axis;l++)s[l]=t.X.shape[l],p[l]=i[l],c[l]=0;for(l=0;l<o;l++)s[l+t.axis]=t.indices.shape[l],c[l+t.axis]=a[l],p[l+t.axis]=0;for(l=t.axis+1;l<r;l++)s[l+o-1]=t.X.shape[l],p[l+o-1]=i[l],c[l+o-1]=0;return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,axis:t.axis,indexValues:Array.from(t.indices.values),mappedIndexStrides:c,mappedInputStrides:p}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.axis+"-"+Array.from(t.indices.values)+"-"+t.indices.shape},e}(lt),ve=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),we=function(){return(we=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ge=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},be=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o}return ve(e,t),e.prototype.getMainBody=function(){return"\n      int ixA["+this.maxRank+"];\n      "+this.initIndex("ixA")+"\n      int ixB["+this.maxRank+"];\n      "+this.initIndex("ixA")+"\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (i >= rank - 2) {\n          break;\n        }\n        ixA[i] = index[i];\n        ixB[i] = index[i];\n      }\n\n      int m = 0;\n      int o = 0;\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (i == rank-2) {\n          m = index[i];\n          o = index[i+1];\n\n          if (aTranspose == 0) {\n            ixA[i] = m;\n          } else {\n            ixA[i+1] = m;\n          }\n\n          if (bTranspose == 0) {\n            ixB[i+1] = o;\n          } else {\n            ixB[i] = o;\n          }\n\n          break;\n        }\n      }\n\n      float res = 0.0;\n\n      for (int n = 0; n < "+this.maxIterations+"; n++) {\n        if (n >= N) {\n          break;\n        }\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (i == rank-2) {\n            if (aTranspose == 0) {\n              ixA[i+1] = n;\n            } else {\n              ixA[i] = n;\n            }\n\n            if (bTranspose == 0) {\n              ixB[i] = n;\n            } else {\n              ixB[i+1] = n;\n            }\n\n            break;\n          }\n        }\n        res += _A(ixA) * _B(ixB);\n      }\n\n      res = res*alpha;\n    "},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("M")+" int M;\n    "+this.getVarModifier("N")+" int N;\n    "+this.getVarModifier("O")+" int O;\n    "+this.getVarModifier("rank")+" int rank;\n    "+this.getVarModifier("aTranspose")+" int aTranspose;\n    "+this.getVarModifier("bTranspose")+" int bTranspose;\n    "+this.getVarModifier("alpha")+" float alpha;\n    "+this.getVarModifier("beta")+" float beta;\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      "+this.getMainBody()+"\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A","B"]},e.prototype.getUniformAttrs=function(){return[{name:"M"},{name:"N"},{name:"O"},{name:"rank"},{name:"aTranspose"},{name:"bTranspose"},{name:"alpha",type:"float"},{name:"beta",type:"float"}]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{A:t.a,B:t.b});var e=t.a.shape.length,n=t.aTranspose?t.a.shape[e-1]:t.a.shape[e-2],r=t.aTranspose?t.a.shape[e-2]:t.a.shape[e-1],o=t.bTranspose?t.b.shape[e-2]:t.b.shape[e-1],i=t.a.shape.slice(0,e-2),a=ge(i,[n,o]),u={M:n,N:r,O:o,rank:e,aTranspose:t.aTranspose?1:0,bTranspose:t.bTranspose?1:0,alpha:t.alpha,beta:t.beta};return this.compute(a,{A:t.a,B:t.b},u)},e.prototype.getOutputShape=function(t){var e=t.a.shape.length,n=t.aTranspose?t.a.shape[e-1]:t.a.shape[e-2],r=t.bTranspose?t.b.shape[e-2]:t.b.shape[e-1],o=t.a.shape.slice(0,e-2);return ge(o,[n,r])},e.prototype.compile=function(e){if(void 0!==e.shapeA){var n=e.shapeA.length;if(e.rank=n,this.maxRank=n,void 0!==e.aTranspose){var r=e.aTranspose?e.shapeA[n-1]:e.shapeA[n-2],o=e.aTranspose?e.shapeA[n-2]:e.shapeA[n-1];e.M=r,e.N=o,e.aTranspose=e.aTranspose?1:0}}if(void 0!==e.shapeB&&void 0!==e.bTranspose){n=e.shapeB.length;var i=e.bTranspose?e.shapeB[n-2]:e.shapeB[n-1];e.O=i,e.bTranspose=e.bTranspose?1:0}t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype),r=t.a.shape.length,o=t.aTranspose?t.a.shape[r-1]:t.a.shape[r-2],i=t.aTranspose?t.a.shape[r-2]:t.a.shape[r-1],a=t.bTranspose?t.b.shape[r-2]:t.b.shape[r-1];return{shapeA:t.a.shape,widthA:t.a.memory.width,heightA:t.a.memory.height,shapeB:t.b.shape,widthB:t.b.memory.width,heightB:t.b.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,M:o,N:i,O:a,aTranspose:t.aTranspose?1:0,bTranspose:t.bTranspose?1:0,alpha:t.alpha,beta:t.beta,rank:r}},e.prototype.getInputInfoString=function(t){return t.a.shape+"-"+t.b.shape+"-"+t.aTranspose+"-"+t.bTranspose+"-"+t.alpha+"-"+t.beta},e}(lt),_e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ve(e,t),e.prototype.getTextureNames=function(){return["A","B","C"]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      "+this.getMainBody()+"\n\n      res += beta*_C(index);\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{A:t.a,B:t.b,C:t.c});var e=t.a.shape.length,n=t.aTranspose?t.a.shape[e-1]:t.a.shape[e-2],r=t.aTranspose?t.a.shape[e-2]:t.a.shape[e-1],o=t.bTranspose?t.b.shape[e-2]:t.b.shape[e-1],i=t.a.shape.slice(0,e-2),a=ge(i,[n,o]),u={M:n,N:r,O:o,rank:e,aTranspose:t.aTranspose?1:0,bTranspose:t.bTranspose?1:0,alpha:t.alpha,beta:t.beta};return this.compute(a,{A:t.a,B:t.b,C:t.c},u)},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return we(we({},n),{shapeC:e.c.shape,widthC:e.c.memory.width,heightC:e.c.memory.height})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.c.shape},e}(be),xe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oe=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return xe(e,t),e.prototype.getOp=function(t,e){return"pow("+t+", "+e+")"},e}(St),ke=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Se=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return ke(e,t),e.prototype.operation=function(t){return"sqrt("+t+")"},e}(yt),Ae=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pe=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Ae(e,t),e.prototype.operation=function(t){return"log("+t+")"},e}(yt),je=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Me=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return je(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("mappedStrides")+" int mappedStrides["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"mappedStrides",length:this.maxRank}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      return getValueAt(index, mappedStrides, widthA, heightA, A);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A"]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{A:t.A});for(var e=t.A.shape.length,n=this.getOutputShape(t),r=k(t.A.shape),o=new Array(e),i=0;i<e;i++)o[i]=r[t.permutation[i]];return this.compute(n,{A:t.A},{mappedStrides:this.pad(o)})},e.prototype.getOutputShape=function(t){for(var e=t.A.shape.length,n=new Array(e),r=0;r<e;r++)n[r]=t.A.shape[t.permutation[r]];return n},e.prototype.compile=function(e){if(void 0!==e.shapeA&&(this.maxRank=e.shapeA.length,void 0!==e.permutation)){for(var n=e.shapeA.length,r=k(e.shapeA),o=new Array(n),i=0;i<n;i++)o[i]=r[e.permutation[i]];e.mappedStrides=o,delete e.permutation}t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){for(var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype),r=t.A.shape.length,o=k(t.A.shape),i=new Array(r),a=0;a<r;a++)i[a]=o[t.permutation[a]];return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,mappedStrides:i}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.permutation},e}(lt),Te=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ie=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Te(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("repeats")+" int repeats["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"repeats",length:this.maxRank}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inIndex["+this.maxRank+"];\n      "+this.initIndex("inIndex")+"\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (repeats[i] == -1) {\n          break;\n        }\n        int d = index[i] / shapeA[i];\n        inIndex[i] = index[i] - d*shapeA[i];\n      }\n\n      return _A(inIndex);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getOutputShape=function(t){for(var e=t.A.shape.length,n=new Array(e),r=0;r<e;r++)n[r]=t.A.shape[r]*t.repeats[r];return n},e.prototype.getTextureNames=function(){return["A"]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{A:t.A});var e=this.getOutputShape(t);return this.compute(e,{A:t.A},{repeats:this.copyPad(t.repeats)})},e.prototype.compile=function(e){void 0!==e.shapeA&&(this.maxRank=e.shapeA.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,repeats:t.repeats}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.repeats},e}(lt),Ce=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ge=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Ve=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Ce(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inputIx["+this.maxRank+"];\n      "+this.initIndex("inputIx")+"\n      if (mode == 0) {\n        float res = value;\n\n        int outOfBounds = 0;\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (index[i] == -1) {\n            break;\n          }\n          inputIx[i] = index[i] - pads[i];\n          if (inputIx[i] < 0 || inputIx[i] >= shapeX[i]) {\n            outOfBounds = 1;\n            break;\n          }\n        }\n\n        if (outOfBounds == 0) {\n          res = _X(inputIx);\n        }\n\n        return res;\n      } else if (mode == 1) {\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (index[i] == -1) {\n            break;\n          }\n          inputIx[i] = index[i] - pads[i];\n          if (inputIx[i] < 0) {\n            inputIx[i] = -inputIx[i];\n          } else if (inputIx[i] >= shapeX[i]) {\n            inputIx[i] = 2*shapeX[i] - inputIx[i] - 2;\n          }\n        }\n\n        return _X(inputIx);\n      } else {\n        for (int i = 0; i < "+this.maxRank+"; i++) {\n          if (index[i] == -1) {\n            break;\n          }\n          inputIx[i] = index[i] - pads[i];\n          if (inputIx[i] < 0) {\n            inputIx[i] = 0;\n          } else if (inputIx[i] >= shapeX[i]) {\n            inputIx[i] = shapeX[i] - 1;\n          }\n        }\n\n        return _X(inputIx);\n      }\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("pads")+" int pads["+2*this.maxRank+"];\n    "+this.getVarModifier("value")+" float value;\n    "+this.getVarModifier("mode")+" int mode;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"value",type:"float"},{name:"pads",length:2*this.maxRank},{name:"mode"}]},e.prototype.getModeFlag=function(t){return"constant"===t?0:"reflect"===t?1:2},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{X:t.input});var e=this.getOutputShape(t);return this.compute(e,{X:t.input},{pads:this.copyPad(t.pads,2*this.maxRank),value:t.value,mode:this.getModeFlag(t.mode)})},e.prototype.getOutputShape=function(t){for(var e=t.input.shape.length,n=Ge(t.input.shape),r=0;r<e;r++)n[r]+=t.pads[r]+t.pads[r+e];return n},e.prototype.compile=function(e){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),void 0!==e.mode&&"string"===typeof e.mode&&(e.mode=this.getModeFlag(e.mode)),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,pads:t.pads,mode:this.getModeFlag(t.mode),value:t.value}},e.prototype.getInputInfoString=function(t){return t.input.shape+"-"+t.pads+"-"+t.mode+"-"+t.value},e}(lt),Ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Re=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Xe=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Ee(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inIx["+this.maxRank+"];\n      "+this.initIndex("inIx")+"\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (index[i] == -1) {\n          break;\n        }\n\n        inIx[i] = index[i]*steps[i] + offsets[i];\n      }\n\n      return _X(inIx);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("offsets")+" int offsets["+this.maxRank+"];\n    "+this.getVarModifier("steps")+" int steps["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"offsets",length:this.maxRank},{name:"steps",length:this.maxRank}]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{X:t.X});for(var e=t.X.shape.length,n=Re(t.X.shape),r=new Array(e).fill(0),o=new Array(e).fill(1),i=0,a=0;a<e&&i<t.axes.length;a++)a===t.axes[i]&&(n[a]=Math.ceil((t.ends[i]-t.starts[i])/t.steps[i]),r[a]=t.starts[i],o[a]=t.steps[i],i++);return this.compute(n,{X:t.X},{offsets:this.pad(r),steps:this.pad(o)})},e.prototype.getOutputShape=function(t){for(var e=t.X.shape.length,n=Re(t.X.shape),r=0,o=0;o<e&&r<t.axes.length;o++)o===t.axes[r]&&(n[o]=Math.ceil((t.ends[r]-t.starts[r])/t.steps[r]),r++);return n},e.prototype.compile=function(e){if(void 0!==e.shapeX&&(this.maxRank=e.shapeX.length,void 0!==e.axes&&void 0!==e.starts&&void 0!==e.ends&&void 0!==e.steps)){for(var n=e.shapeX.length,r=new Array(n).fill(0),o=new Array(n).fill(1),i=0,a=0;a<n&&i<e.axes.length;a++)a===e.axes[i]&&(r[a]=e.starts[i],o[a]=e.steps[i],i++);e.offsets=r,e.steps=o,delete e.starts,delete e.ends,delete e.axes}t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){for(var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype),r=t.X.shape.length,o=Re(t.X.shape),i=new Array(r).fill(0),a=new Array(r).fill(1),u=0,s=0;s<r&&u<t.axes.length;s++)s===t.axes[u]&&(o[s]=Math.ceil((t.ends[u]-t.starts[u])/t.steps[u]),i[s]=t.starts[u],a[s]=t.steps[u],u++);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,offsets:i,steps:a}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.axes+"-"+t.starts+"-"+t.ends+"-"+t.steps},e}(lt),Be=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),De=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Ue=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Be(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int inIx["+this.maxRank+"];\n      "+this.initIndex("inIx")+"\n\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (index[i] == -1) {\n          break;\n        }\n\n        inIx[i] = int(floor(float(index[i]) / scales[i]));\n      }\n\n      return _X(inIx);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("scales")+" float scales["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"scales",length:this.maxRank,type:"float"}]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{X:t.X});var e=this.getOutputShape(t);return this.compute(e,{X:t.X},{scales:this.copyPad(t.scales)})},e.prototype.getOutputShape=function(t){for(var e=t.X.shape.length,n=De(t.X.shape),r=0;r<e;r++)n[r]=Math.floor(n[r]*t.scales[r]);return n},e.prototype.compile=function(e){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,scales:t.scales}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.scales},e}(lt),We=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ze=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return We(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("epsilon")+" float epsilon;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"epsilon",type:"float"}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int["+this.maxRank+"] index) {\n      float result = _X(index) - _Mean(index);\n      result = result / sqrt(_Variance(index) + epsilon);\n      result = result * _Scale(index) + _Bias(index);\n      return result;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getOutputShape=function(t){return t.X.shape},e.prototype.getTextureNames=function(){return["X","Mean","Variance","Scale","Bias"]},e.prototype.calc=function(t){return this.compute(t.X.shape,{X:t.X,Mean:t.Mean,Variance:t.Variance,Scale:t.Scale,Bias:t.Bias},{epsilon:t.epsilon})},e.prototype.compile=function(e){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeBias:t.Bias.shape,widthBias:t.Bias.memory.width,heightBias:t.Bias.memory.height,shapeMean:t.Mean.shape,widthMean:t.Mean.memory.width,heightMean:t.Mean.memory.height,shapeScale:t.Scale.shape,widthScale:t.Scale.memory.width,heightScale:t.Scale.memory.height,shapeVariance:t.Variance.shape,widthVariance:t.Variance.memory.width,heightVariance:t.Variance.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,epsilon:t.epsilon}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.Mean.shape+"-"+t.Variance.shape+"-"+t.Scale.shape+"-"+t.Bias.shape+"-"+t.epsilon},e}(lt),Le=function(){function t(t,e){void 0===e&&(e=2),this.getOp=t,this.minCallsToCompile=e,this.opDict={}}return t.prototype.getDefault=function(t){var e="default-"+t;if(void 0===this.opDict[e]){var n=this.getOp(t);n.compile({}),this.opDict[e]={infoString:e,numCalls:0,operation:n}}return this.opDict[e]},t.prototype.calc=function(t,e){var n=this.getDefault(e),r=n.operation.getInputInfoString(t);void 0===this.opDict[r]&&(this.opDict[r]={infoString:r,numCalls:0});var o=this.opDict[r];if(o.numCalls++,o.numCalls>=this.minCallsToCompile){if(void 0===o.operation){o.operation=this.getOp(e);var i=n.operation.getCompilationInfo(t);o.operation.compile(i)}return o.operation.calc(t)}return n.numCalls++,n.operation.calc(t)},t}(),Fe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ne=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Fe(e,t),e.prototype.operation=function(t){return"sign("+t+")"},e}(yt),qe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),He=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return qe(e,t),e.prototype.operation=function(t){return"-"+t},e}(yt),Je=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ke=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Je(e,t),e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      float val = _X(index);\n      if (doMin == 1 && val < minVal) {\n        return 0.0;\n      }\n      if (doMax == 1 && val > maxVal) {\n        return 0.0;\n      }\n      return _Grad(index);\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X","Grad"]},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("minVal")+" float minVal;\n    "+this.getVarModifier("maxVal")+" float maxVal;\n    "+this.getVarModifier("doMin")+" int doMin;\n    "+this.getVarModifier("doMax")+" int doMax;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"minVal",type:"float"},{name:"maxVal",type:"float"},{name:"doMin"},{name:"doMax"}]},e.prototype.calc=function(t){return this.fullyStatic&&void 0!==this.outputShape?this.compute(this.outputShape,{X:t.input,Grad:t.grad}):this.compute(t.input.shape,{X:t.input,Grad:t.grad},{minVal:void 0!==t.minVal?t.minVal:0,maxVal:void 0!==t.maxVal?t.maxVal:0,doMin:void 0!==t.minVal?1:0,doMax:void 0!==t.maxVal?1:0})},e.prototype.getOutputShape=function(t){return t.input.shape},e.prototype.compile=function(e){void 0!==e.shapeX&&(this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=at.getAllocationDimensions(t.input.size,this.dtype);return{shapeX:t.input.shape,widthX:t.input.memory.width,heightX:t.input.memory.height,shapeGrad:t.grad.shape,widthGrad:t.grad.memory.width,heightGrad:t.grad.memory.height,shapeOutput:t.input.shape,widthOutput:e.width,heightOutput:e.height,minVal:void 0!==t.minVal?t.minVal:0,maxVal:void 0!==t.maxVal?t.maxVal:0,doMin:void 0!==t.minVal?1:0,doMax:void 0!==t.maxVal?1:0}},e.prototype.getInputInfoString=function(t){return t.input.shape+"-"+t.minVal+"-"+t.maxVal},e}(lt),Ye=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qe=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o}return Ye(e,t),e.prototype.updateInputIx=function(){return"\n    for (int d = 0; d < "+(this.maxRank-2)+"; d++) {\n      int stride = strides[d];\n      int pad = pads[d];\n      int dilation = dilations[d];\n      if (stride == -1) {\n        break;\n      }\n\n      int trans_kernel_ix = shapeW[d + 2] - kernelIx[d + 2] - 1;\n\n      inputIx[d+2] = index[d + 2] - pad + trans_kernel_ix * dilation;\n\n      int divS = inputIx[d+2] / stride;\n      int resS = inputIx[d+2] - divS*stride;\n\n      if (resS != 0) {\n        skip = true;\n        break;\n      }\n      inputIx[d+2] = divS;\n\n      if (inputIx[d+2] < 0 || inputIx[d+2] >= shapeX[d+2]) {\n        skip = true;\n        break;\n      }\n    }\n    "},e.prototype.getMainBody=function(){return"\n    int n = index[0];\n    int m = index[1];\n\n    int kernelIx["+this.maxRank+"];\n    "+this.initIndex("kernelIx")+"\n    for (int i = 0; i < "+this.maxRank+"; i++) {\n      if (i >= dataRank) {\n        break;\n      }\n      kernelIx[i+2] = 0;\n    }\n    kernelIx[0] = m;\n    int inputIx["+this.maxRank+"];\n    "+this.initIndex("inputIx")+"\n    inputIx[0] = n;\n\n    for (int cg = 0; cg < "+this.maxIterations+"; cg++) {\n      if (cg >= CG) {\n        break;\n      }\n      int c = m * CG + cg;\n      int d = c/C;\n      c = c - d*C;\n      inputIx[1] = c;\n      kernelIx[1] = cg;\n      for (int kIx = 0; kIx < "+this.maxIterations+"; kIx++) {\n        if (kIx >= kernelSize) {\n          break;\n        }\n\n        bool skip = false;\n\n        "+this.updateInputIx()+"\n\n        if (!skip) {\n          res += _X(inputIx) * _W(kernelIx);\n        }\n\n        "+this.incrementIndex("kernelIx","shapeW")+"\n      }\n    }\n    "},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("CG")+" int CG;\n    "+this.getVarModifier("kernelSize")+" int kernelSize;\n    "+this.getVarModifier("dataRank")+" int dataRank;\n    "+this.getVarModifier("C")+" int C;\n    "+this.getVarModifier("dilations")+" int dilations["+this.maxRank+"];\n    "+this.getVarModifier("pads")+" int pads["+this.maxRank+"];\n    "+this.getVarModifier("strides")+" int strides["+this.maxRank+"];\n    "},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      float res = 0.0;\n\n      "+this.getMainBody()+"\n\n      return res;\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["X","W"]},e.prototype.getUniformAttrs=function(){return[{name:"CG"},{name:"kernelSize"},{name:"C"},{name:"dataRank"},{name:"pads",length:2*this.maxRank},{name:"strides",length:this.maxRank},{name:"dilations",length:this.maxRank}]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{X:t.X,W:t.W});var e=t.X.shape[0],n=t.X.shape[1],r=t.X.shape.slice(2),o=t.W.shape.slice(2),i=t.W.shape[0],a=t.W.shape[1],u=O(o),s=D(r,o,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),t.dilations,t.strides),p=[e,i];return p=p.concat(s),this.compute(p,{X:t.X,W:t.W},{CG:a,kernelSize:u,C:n,dataRank:r.length,pads:this.copyPad(t.pads,2*this.maxRank),strides:this.copyPad(t.strides),dilations:this.copyPad(t.dilations)})},e.prototype.getOutputShape=function(t){var e=t.X.shape[0],n=t.X.shape.slice(2),r=t.W.shape.slice(2),o=t.W.shape[0],i=D(n,r,t.pads.slice(0,t.pads.length/2),t.pads.slice(t.pads.length/2),t.dilations,t.strides),a=[e,o];return a=a.concat(i)},e.prototype.compile=function(e){void 0!==e.shapeW&&(e.CG=e.shapeW[1],e.kernelSize=O(e.shapeW.slice(2)),e.dataRank=e.shapeW.length-2,this.maxRank=e.shapeW.length),void 0!==e.shapeX&&(e.C=e.shapeX[1],e.dataRank=e.shapeX.length-2,this.maxRank=e.shapeX.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype),r=O(t.W.shape.slice(2)),o=t.X.shape[1],i=t.X.shape.slice(2);return{shapeX:t.X.shape,widthX:t.X.memory.width,heightX:t.X.memory.height,shapeW:t.W.shape,widthW:t.W.memory.width,heightW:t.W.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,pads:t.pads,dilations:t.dilations,strides:t.strides,CG:t.W.shape[1],kernelSize:r,dataRank:i.length,C:o}},e.prototype.getInputInfoString=function(t){return t.X.shape+"-"+t.W.shape+"-"+t.dilations+"-"+t.pads+"-"+t.dilations+"-"+t.strides},e}(lt),Ze=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$e=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Ze(e,t),e.prototype.operation=function(t){return"1.0/(1.0 + exp(-"+t+"))"},e}(yt),tn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),en=function(){return(en=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},nn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return tn(e,t),e.prototype.operation=function(t){return"factor*"+t+" + add"},e.prototype.calc=function(t){return this.compute(t.input.shape,{X:t.input},{factor:t.factor,add:t.add})},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return en(en({},n),{factor:e.factor,add:e.add})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.factor+"-"+e.add},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("factor")+" float factor;\n    "+this.getVarModifier("add")+" float add;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"factor",type:"float"},{name:"add",type:"float"}]},e}(yt),rn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),on=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return rn(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("starts")+" int starts["+this.maxRank+"];\n    "},e.prototype.getUniformAttrs=function(){return[{name:"starts",length:this.maxRank}]},e.prototype.getFragmentShader=function(t){return"\n    float process(int index["+this.maxRank+"]) {\n      int valueIx["+this.maxRank+"];\n      "+this.initIndex("valueIx")+"\n\n      int inValues = 1;\n\n      for (int i = 0; i < "+this.maxRank+"; i++) {\n        if (index[i] == -1) {\n          break;\n        }\n\n        if (index[i] < starts[i] || index[i] >= (starts[i] + shapeValues[i])) {\n          inValues = 0;\n          break;\n        } else {\n          valueIx[i] = index[i] - starts[i];\n        }\n      }\n\n      if (inValues == 1) {\n        return _Values(valueIx);\n      } else {\n        return _A(index);\n      }\n    }\n\n    "+this.getDefaultMain()+"\n    "},e.prototype.getTextureNames=function(){return["A","Values"]},e.prototype.calc=function(t){if(this.fullyStatic&&void 0!==this.outputShape)return this.compute(this.outputShape,{A:t.A,Values:t.Values});var e=this.getOutputShape(t);return this.compute(e,{A:t.A,Values:t.Values},{starts:this.pad(t.starts)})},e.prototype.getOutputShape=function(t){return t.A.shape},e.prototype.compile=function(e){void 0!==e.shapeA&&(this.maxRank=e.shapeA.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeA:t.A.shape,widthA:t.A.memory.width,heightA:t.A.memory.height,shapeValues:t.Values.shape,widthValues:t.Values.memory.width,heightValues:t.Values.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,starts:t.starts}},e.prototype.getInputInfoString=function(t){return t.A.shape+"-"+t.Values.shape+"-"+t.starts},e}(lt),an=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),un=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return an(e,t),e.prototype.operation=function(t){return"sin("+t+")"},e}(yt),sn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return an(e,t),e.prototype.operation=function(t){return"asin("+t+")"},e}(yt),pn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return an(e,t),e.prototype.operation=function(t){return"(exp("+t+") - exp(-"+t+"))/2.0"},e}(yt),cn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ln=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return cn(e,t),e.prototype.operation=function(t){return"cos("+t+")"},e}(yt),hn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return cn(e,t),e.prototype.operation=function(t){return"acos("+t+")"},e}(yt),fn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return cn(e,t),e.prototype.operation=function(t){return"(1.0 + exp(-2.0*"+t+"))/(2.0*exp(-"+t+"))"},e}(yt),dn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return dn(e,t),e.prototype.operation=function(t){return"tan("+t+")"},e}(yt),mn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return dn(e,t),e.prototype.operation=function(t){return"atan("+t+")"},e}(yt),vn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return dn(e,t),e.prototype.operation=function(t){return"(exp(2.0*"+t+") - 1.0)/(exp(2.0*"+t+") + 1.0)"},e}(yt),wn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return wn(e,t),e.prototype.update=function(t,e){return t+" + "+e},e.prototype.post=function(t){return t+" = log("+t+");"},e.prototype.init=function(t){return""+t},e}(Wt),bn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return bn(e,t),e.prototype.update=function(t,e){return"exp("+t+") + "+e},e.prototype.post=function(t){return t+" = log("+t+");"},e.prototype.init=function(t){return"exp("+t+")"},e}(Wt),xn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),On=function(){return(On=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},kn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return xn(e,t),e.prototype.operation=function(t){return"max(vec4(0.0,0.0,0.0,0.0), min(vec4(1.0,1.0,1.0,1.0), alpha*"+t+" + beta))"},e.prototype.calc=function(t){return this.compute(t.input.shape,{X:t.input},{alpha:t.alpha,beta:t.beta})},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return On(On({},n),{alpha:e.alpha,beta:e.beta})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.alpha+"-"+e.beta},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("alpha")+" float alpha;\n    "+this.getVarModifier("beta")+" float beta;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"alpha",type:"float"},{name:"beta",type:"float"}]},e}(yt),Sn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),An=function(){return(An=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Pn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Sn(e,t),e.prototype.operation=function(t){throw new Error("Method not implemented.")},e.prototype.getFragmentShader=function(t){return"\n    void main() {\n      initVars();\n\n      if (power < 0.0) {\n        gl_FragColor = vec4(factor,factor,factor,factor) / pow(texture2D(X, uv), vec4(-power,-power,-power,-power));\n      } else {\n        gl_FragColor = pow(texture2D(X, uv), vec4(power,power,power,power)) * factor;\n      }\n    }\n    "},e.prototype.calc=function(t){return this.compute(t.input.shape,{X:t.input},{factor:t.factor,power:t.power})},e.prototype.getCompilationInfo=function(e){var n=t.prototype.getCompilationInfo.call(this,e);return An(An({},n),{factor:e.factor,power:e.power})},e.prototype.getInputInfoString=function(e){return t.prototype.getInputInfoString.call(this,e)+"-"+e.factor+"-"+e.power},e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("factor")+" float factor;\n    "+this.getVarModifier("power")+" float power;\n    "},e.prototype.getUniformAttrs=function(){return[{name:"factor",type:"float"},{name:"power",type:"float"}]},e}(yt),jn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mn=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return jn(e,t),e.prototype.operation=function(t){return"floor("+t+"+vec4(0.5))"},e}(yt),Tn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),In=function(t){function e(e,n,r){var o=t.call(this,r||"float32")||this;return o.shape=n,o.deleted=!1,o.size=O(n),o.memory=e instanceof Array?at.allocateTexture(e,o.dtype):e,o}return Tn(e,t),e.range=function(t,n,r,o){for(var i=Math.max(Math.ceil((n-t)/r),0),a=new Array(i),u=0;u<i;u++)a[u]=t+u*r;return new e(a,[i],o)},e.fromData=function(t){var n=it.texture({data:t,format:"rgba",type:at.getColorType("float32")}),r=at.allocateFramebuffer(n,"float32"),o=n.width;return new e(r,[n.height,o,4],"float32")},e.prototype.cast=function(t){if("float64"===t)throw new Error("The WebGL backend does not support float64 tensors");return Xr.calc({input:this},t)},e.prototype.getValues=function(){var t=this;if("float32"===this.dtype)return new Promise((function(e){it({framebuffer:t.memory.frameBuffer})((function(){var n=new Float32Array(t.memory.size);n=it.read(n),e(n.subarray(0,t.size))}))}));throw new Error("Reading values only supported for data type float32")},e.prototype.getShape=function(){return this.shape},e.prototype.constantLike=function(t){return new e(new Array(this.size).fill(t),this.shape,this.dtype)},e.prototype.singleConstant=function(t){return new e([t],[1],this.dtype)},e.prototype.delete=function(){this.deleted||(this.deleted=!0,at.deallocate(this.memory),this.memory=void 0)},e.prototype.copy=function(){return Xr.calc({input:this},this.dtype)},e.prototype.exp=function(){return Nn.calc({input:this},this.dtype)},e.prototype.log=function(){return cr.calc({input:this},this.dtype)},e.prototype.sqrt=function(){return pr.calc({input:this},this.dtype)},e.prototype.abs=function(){return qn.calc({input:this},this.dtype)},e.prototype.sin=function(){return Hn.calc({input:this},this.dtype)},e.prototype.cos=function(){return Jn.calc({input:this},this.dtype)},e.prototype.tan=function(){return Kn.calc({input:this},this.dtype)},e.prototype.asin=function(){return Yn.calc({input:this},this.dtype)},e.prototype.acos=function(){return Qn.calc({input:this},this.dtype)},e.prototype.atan=function(){return Zn.calc({input:this},this.dtype)},e.prototype.sinh=function(){return $n.calc({input:this},this.dtype)},e.prototype.cosh=function(){return tr.calc({input:this},this.dtype)},e.prototype.tanh=function(){return er.calc({input:this},this.dtype)},e.prototype.asinh=function(){throw new Error("Method not implemented")},e.prototype.acosh=function(){throw new Error("Method not implemented")},e.prototype.atanh=function(){throw new Error("Method not implemented")},e.prototype.sigmoid=function(){return nr.calc({input:this},this.dtype)},e.prototype.hardSigmoid=function(t,e){return rr.calc({input:this,alpha:t,beta:e},this.dtype)},e.prototype.floor=function(){return ir.calc({input:this},this.dtype)},e.prototype.ceil=function(){return or.calc({input:this},this.dtype)},e.prototype.round=function(){return ar.calc({input:this},this.dtype)},e.prototype.negate=function(){return lr.calc({input:this},this.dtype)},e.prototype.addMultiplyScalar=function(t,e){return hr.calc({input:this,factor:t,add:e},this.dtype)},e.prototype.powerScalar=function(t,e){return fr.calc({input:this,factor:e,power:t},this.dtype)},e.prototype.sign=function(){return dr.calc({input:this},this.dtype)},e.prototype.setValues=function(t,n){if(!(t instanceof e))throw new Error("Can only set GPU values to GPU tensor");return Rr.calc({A:this,Values:t,starts:n},this.dtype)},e.prototype.add_impl=function(t,n,r,o,i){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add GPU tensor to GPU tensor");return _r.calc({A:t,B:n,outputShape:r,alpha:o,beta:i},this.dtype)},e.prototype.subtract_impl=function(t,n,r,o,i){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only subtract GPU tensor from GPU tensor");return xr.calc({A:t,B:n,outputShape:r,alpha:o,beta:i},this.dtype)},e.prototype.multiply_impl=function(t,n,r,o){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only multiply GPU tensor with GPU tensor");return Or.calc({A:t,B:n,outputShape:r,alpha:o},this.dtype)},e.prototype.divide_impl=function(t,n,r,o){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only divide GPU tensor by GPU tensor");return kr.calc({A:t,B:n,outputShape:r,alpha:o},this.dtype)},e.prototype.power_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only take GPU tensor to power of GPU tensor");return Sr.calc({A:t,B:n,outputShape:r},this.dtype)},e.prototype.matMul=function(t){if(!(t instanceof e))throw new Error("Can only matrix multiply GPU tensor to GPU tensor");return zn.calc({A:this,B:t},this.dtype)},e.prototype.gemm_impl=function(t,n,r,o,i,a){if(!(t instanceof e&&(void 0===a||a instanceof e)))throw new Error("Can only do gemm with CPU tensors");return void 0===a?Ln.calc({a:this,b:t,aTranspose:n,bTranspose:r,alpha:o,beta:i},this.dtype):Fn.calc({a:this,b:t,c:a,aTranspose:n,bTranspose:r,alpha:o,beta:i},this.dtype)},e.prototype.sum_impl=function(t,e){return Mr.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.sumSquare_impl=function(t,e){return jr.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.reduceMean_impl=function(t,e){return Ar.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.reduceMeanSquare_impl=function(t,e){return Pr.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.reduceLogSum_impl=function(t,e){return Gr.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.reduceLogSumExp_impl=function(t,e){return Vr.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.product_impl=function(t,e){return Tr.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.max_impl=function(t,e){return Ir.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.min_impl=function(t,e){return Cr.calc({X:this,axes:t,keepDims:e},this.dtype)},e.prototype.conv_impl=function(t,n,r,o,i,a,u){if(!(t instanceof e)||void 0!==u&&!(u instanceof e))throw new Error("Can only do convolution of GPU tensor with GPU tensor");return void 0===u?yr.calc({X:this,W:t,pads:o,dilations:n,strides:i,activation:a},this.dtype):vr.calc({X:this,W:t,B:u,pads:o,dilations:n,strides:i,activation:a},this.dtype)},e.prototype.convTranspose_impl=function(t,n,r,o,i){if(!(t instanceof e))throw new Error("Can only do transpose convolution of GPU tensor with GPU tensor");return wr.calc({X:this,W:t,pads:o,dilations:n,strides:i},this.dtype)},e.prototype.averagePool_impl=function(t,e,n,r){return mr.calc({X:this,includePad:r,kernelShape:t,pads:e,strides:n},this.dtype)},e.prototype.reshape_impl=function(t,n){return n?Xr.calc({input:this,outputShape:t},this.dtype):new e(this.memory,t,this.dtype)},e.prototype.concat=function(t,n){if(!(t instanceof e))throw new Error("Can only concat GPU tensor to GPU tensor");return n<0&&(n+=this.shape.length),Er.calc({A:this,B:t,axis:n},this.dtype)},e.prototype.transpose_impl=function(t){return Ur.calc({A:this,permutation:t},this.dtype)},e.prototype.clip=function(t,e){return ur.calc({input:this,minVal:t,maxVal:e},this.dtype)},e.prototype.clipBackward=function(t,e,n){return sr.calc({input:this,minVal:e,maxVal:n,grad:t},this.dtype)},e.prototype.repeat=function(t){return Wr.calc({A:this,repeats:t},this.dtype)},e.prototype.expand=function(t){var e=this.alignShapes(this.shape,t),n=e[0],r=(e[1],e[2]);return A(this.shape,r)?this.copy():Br.calc({input:this.reshape(n,!1),outputShape:r},this.dtype)},e.prototype.pad_impl=function(t,e,n){return gr.calc({input:this,pads:t,mode:e,value:n},this.dtype)},e.prototype.gather=function(t,e){return Dr.calc({X:this,axis:t,indices:e},this.dtype)},e.prototype.slice_impl=function(t,e,n,r){return zr.calc({X:this,starts:t,ends:e,axes:n,steps:r},this.dtype)},e.prototype.upsample=function(t){return br.calc({X:this,scales:t},this.dtype)},e.prototype.normalize=function(t,n,r,o,i){if(!(t instanceof e)||!(n instanceof e)||!(o instanceof e)||!(i instanceof e))throw new Error("Can only normalize with CPU tensors");return Lr.calc({X:this,Mean:t,Variance:n,Scale:o,Bias:i,epsilon:r},this.dtype)},e}(C);function Cn(t,e,n){return new In(t,e,n)}var Gn,Vn,En,Rn,Xn,Bn,Dn,Un,Wn,zn=new Le((function(t){return new ft(Cn,t)})),Ln=new Le((function(t){return new be(Cn,t)})),Fn=new Le((function(t){return new _e(Cn,t)})),Nn=new Le((function(t){return new vt(Cn,t)})),qn=new Le((function(t){return new Ot(Cn,t)})),Hn=new Le((function(t){return new un(Cn,t)})),Jn=new Le((function(t){return new ln(Cn,t)})),Kn=new Le((function(t){return new yn(Cn,t)})),Yn=new Le((function(t){return new sn(Cn,t)})),Qn=new Le((function(t){return new hn(Cn,t)})),Zn=new Le((function(t){return new mn(Cn,t)})),$n=new Le((function(t){return new pn(Cn,t)})),tr=new Le((function(t){return new fn(Cn,t)})),er=new Le((function(t){return new vn(Cn,t)})),nr=new Le((function(t){return new $e(Cn,t)})),rr=new Le((function(t){return new kn(Cn,t)})),or=new Le((function(t){return new re(Cn,t)})),ir=new Le((function(t){return new ue(Cn,t)})),ar=new Le((function(t){return new Mn(Cn,t)})),ur=new Le((function(t){return new ie(Cn,t)})),sr=new Le((function(t){return new Ke(Cn,t)})),pr=new Le((function(t){return new Se(Cn,t)})),cr=new Le((function(t){return new Pe(Cn,t)})),lr=new Le((function(t){return new He(Cn,t)})),hr=new Le((function(t){return new nn(Cn,t)})),fr=new Le((function(t){return new Pn(Cn,t)})),dr=new Le((function(t){return new Ne(Cn,t)})),yr=new Le((function(t){return new bt(Cn,t)})),mr=new Le((function(t){return new Dt(Cn,t)})),vr=new Le((function(t){return new _t(Cn,t)})),wr=new Le((function(t){return new Qe(Cn,t)})),gr=new Le((function(t){return new Ve(Cn,t)})),br=new Le((function(t){return new Ue(Cn,t)})),_r=new Le((function(t){return new jt(Cn,t)})),xr=new Le((function(t){return new Vt(Cn,t)})),Or=new Le((function(t){return new It(Cn,t)})),kr=new Le((function(t){return new Xt(Cn,t)})),Sr=new Le((function(t){return new Oe(Cn,t)})),Ar=new Le((function(t){return new Lt(Cn,t)})),Pr=new Le((function(t){return new Nt(Cn,t)})),jr=new Le((function(t){return new Ht(Cn,t)})),Mr=new Le((function(t){return new Kt(Cn,t)})),Tr=new Le((function(t){return new Qt(Cn,t)})),Ir=new Le((function(t){return new $t(Cn,t)})),Cr=new Le((function(t){return new ee(Cn,t)})),Gr=new Le((function(t){return new gn(Cn,t)})),Vr=new Le((function(t){return new _n(Cn,t)})),Er=new Le((function(t){return new ce(Cn,t)})),Rr=new Le((function(t){return new on(Cn,t)})),Xr=new Le((function(t){return new he(Cn,t)})),Br=new Le((function(t){return new de(Cn,t)})),Dr=new Le((function(t){return new me(Cn,t)})),Ur=new Le((function(t){return new Me(Cn,t)})),Wr=new Le((function(t){return new Ie(Cn,t)})),zr=new Le((function(t){return new Xe(Cn,t)})),Lr=new Le((function(t){return new ze(Cn,t)})),Fr=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nr=new Promise((function(t){n.e(3).then(n.bind(null,46)).then((function(e){Gn=e.TensorF32,Vn=e.TensorF64,En=e.TensorI32,Rn=e.TensorI16,Xn=e.TensorI8,Bn=e.TensorU32,Dn=e.TensorU16,Un=e.TensorU8,Wn={float64:Vn,float32:Gn,int32:En,int16:Rn,int8:Xn,uint32:Bn,uint16:Dn,uint8:Un},t()}))})),qr=function(t){function e(e,n,r){var o=t.call(this,r||"float32")||this;if(e instanceof Array){if(void 0===n)throw new Error("Need the shape when creating a Wasm tensor from values");var i=new I[o.dtype](e);o.wasmTensor=Wn[o.dtype].create(n,i)}else o.wasmTensor=e;return o}return Fr(e,t),e.range=function(t,n,r){for(var o=Math.max(Math.ceil((n-t)/r),0),i=new Array(o),a=0;a<o;a++)i[a]=t+a*r;return new e(i,new Uint32Array([o]))},e.prototype.cast=function(t){throw new Error("Method not implemented.")},e.prototype.getValues=function(){return Promise.resolve(this.wasmTensor.get_vals())},e.prototype.getShape=function(){return Array.from(this.wasmTensor.get_shape())},e.prototype.constantLike=function(t){return new e([t],this.wasmTensor.get_shape(),this.dtype)},e.prototype.singleConstant=function(t){return new e([t],new Uint32Array([1]),this.dtype)},e.prototype.delete=function(){void 0!==this.wasmTensor&&(this.wasmTensor.free(),this.wasmTensor=void 0)},e.prototype.copy=function(){return new e(this.wasmTensor.copy(),void 0,this.dtype)},e.prototype.exp=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Exp can only be called on float tensors");return new e(this.wasmTensor.exp())},e.prototype.log=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Log can only be called on float tensors");return new e(this.wasmTensor.log())},e.prototype.sqrt=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Sqrt can only be called on float tensors");return new e(this.wasmTensor.sqrt())},e.prototype.abs=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn)&&!(this.wasmTensor instanceof En)&&!(this.wasmTensor instanceof Rn)&&!(this.wasmTensor instanceof Xn))throw new Error("Abs can only be called on signed tensors");return new e(this.wasmTensor.abs())},e.prototype.sin=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Sin can only be called on float tensors");return new e(this.wasmTensor.sin())},e.prototype.cos=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Cos can only be called on float tensors");return new e(this.wasmTensor.cos())},e.prototype.tan=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Tan can only be called on float tensors");return new e(this.wasmTensor.tan())},e.prototype.asin=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Asin can only be called on float tensors");return new e(this.wasmTensor.asin())},e.prototype.acos=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Acos can only be called on float tensors");return new e(this.wasmTensor.acos())},e.prototype.atan=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Atan can only be called on float tensors");return new e(this.wasmTensor.atan())},e.prototype.sinh=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Sinh can only be called on float tensors");return new e(this.wasmTensor.sinh())},e.prototype.cosh=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Cosh can only be called on float tensors");return new e(this.wasmTensor.cosh())},e.prototype.tanh=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Tanh can only be called on float tensors");return new e(this.wasmTensor.tanh())},e.prototype.asinh=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Asinh can only be called on float tensors");return new e(this.wasmTensor.asinh())},e.prototype.acosh=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Acosh can only be called on float tensors");return new e(this.wasmTensor.acosh())},e.prototype.atanh=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Atanh can only be called on float tensors");return new e(this.wasmTensor.atanh())},e.prototype.sigmoid=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Sigmoid can only be called on float tensors");return new e(this.wasmTensor.sigmoid())},e.prototype.hardSigmoid=function(t,n){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("HardSigmoid can only be called on float tensors");return new e(this.wasmTensor.hard_sigmoid(t,n))},e.prototype.negate=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn)&&!(this.wasmTensor instanceof En)&&!(this.wasmTensor instanceof Rn)&&!(this.wasmTensor instanceof Xn))throw new Error("Negate can only be called on signed tensors");return new e(this.wasmTensor.negate())},e.prototype.powerScalar=function(t,n){return new e(this.wasmTensor.power_scalar(t,n))},e.prototype.addMultiplyScalar=function(t,n){return new e(this.wasmTensor.add_multiply_scalar(t,n))},e.prototype.sign=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn)&&!(this.wasmTensor instanceof En)&&!(this.wasmTensor instanceof Rn)&&!(this.wasmTensor instanceof Xn))throw new Error("Sign can only be called on signed tensors");return new e(this.wasmTensor.sign())},e.prototype.setValues=function(t,n){if(!(t instanceof e))throw new Error("Can only set WASM values to WASM values");return new e(this.wasmTensor.set_values(t.wasmTensor,new Uint32Array(n)))},e.prototype.add_impl=function(t,n,r,o,i){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add WASM tensor to WASM tensor");return new e(t.wasmTensor.addition(n.wasmTensor,o,i))},e.prototype.subtract_impl=function(t,n,r,o,i){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only subtract WASM tensor from WASM tensor");return new e(t.wasmTensor.subtraction(n.wasmTensor,o,i))},e.prototype.multiply_impl=function(t,n,r,o){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only multiply WASM tensor with WASM tensor");return new e(t.wasmTensor.multiply(n.wasmTensor,o))},e.prototype.divide_impl=function(t,n,r,o){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only divide WASM tensor by WASM tensor");return new e(t.wasmTensor.divide(n.wasmTensor,o))},e.prototype.power_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only take WASM tensor to power of WASM tensor");return new e(t.wasmTensor.power(n.wasmTensor))},e.prototype.matMul=function(t){if(!(t instanceof e))throw new Error("Can only add WASM tensor to WASM tensor");return new e(this.wasmTensor.matmul(t.wasmTensor))},e.prototype.gemm_impl=function(t,n,r,o,i,a){if(!(t instanceof e&&(void 0===a||a instanceof e)))throw new Error("Can only do gemm with CPU tensors");return new e(void 0!==a?this.wasmTensor.gemm_with_c(t.wasmTensor,n,r,o,a.wasmTensor,i):this.wasmTensor.gemm(t.wasmTensor,n,r,o))},e.prototype.sum_impl=function(t,n){return new e(this.wasmTensor.sum(new Uint32Array(t),n))},e.prototype.sumSquare_impl=function(t,n){return new e(this.wasmTensor.sum_square(new Uint32Array(t),n))},e.prototype.product_impl=function(t,n){return new e(this.wasmTensor.product(new Uint32Array(t),n))},e.prototype.max_impl=function(t,n){return new e(this.wasmTensor.max(new Uint32Array(t),n))},e.prototype.min_impl=function(t,n){return new e(this.wasmTensor.min(new Uint32Array(t),n))},e.prototype.reduceMean_impl=function(t,n){return new e(this.wasmTensor.reduce_mean(new Uint32Array(t),n))},e.prototype.reduceMeanSquare_impl=function(t,n){return new e(this.wasmTensor.reduce_mean_square(new Uint32Array(t),n))},e.prototype.reduceLogSum_impl=function(t,n){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("ReduceLogSum can only be called on float tensors");return new e(this.wasmTensor.reduce_log_sum(new Uint32Array(t),n))},e.prototype.reduceLogSumExp_impl=function(t,n){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("ReduceLogSumExp can only be called on float tensors");return new e(this.wasmTensor.reduce_log_sum_exp(new Uint32Array(t),n))},e.prototype.getActivationFlag=function(t){return"id"===t?0:"relu"===t?1:2},e.prototype.conv_impl=function(t,n,r,o,i,a,u){if(!(t instanceof e)||void 0!==u&&!(u instanceof e))throw new Error("Can only do convolution of WASM tensor with WASM tensor");var s=this.getActivationFlag(a);return new e(void 0!==u?this.wasmTensor.conv_with_bias(t.wasmTensor,u.wasmTensor,new Uint32Array(n),r,new Uint32Array(o),new Uint32Array(i),s):this.wasmTensor.conv(t.wasmTensor,new Uint32Array(n),r,new Uint32Array(o),new Uint32Array(i),s))},e.prototype.convTranspose_impl=function(t,n,r,o,i){if(!(t instanceof e))throw new Error("Can only do transpose convolution of WASM tensor with WASM tensor");return new e(this.wasmTensor.conv_transpose(t.wasmTensor,new Uint32Array(n),r,new Uint32Array(o),new Uint32Array(i)))},e.prototype.averagePool_impl=function(t,n,r,o){return new e(this.wasmTensor.average_pool(new Uint32Array(t),new Uint32Array(n),new Uint32Array(r),o))},e.prototype.reshape_impl=function(t){var n=new Uint32Array(t);return new e(this.wasmTensor.reshape(n),n)},e.prototype.concat=function(t,n){if(!(t instanceof e))throw new Error("Can only concat WASM tensor to WASM tensor");return n<0&&(n+=this.getShape().length),new e(this.wasmTensor.concat(t.wasmTensor,n))},e.prototype.transpose_impl=function(t){return new e(this.wasmTensor.transpose(new Uint32Array(t)))},e.prototype.clip=function(t,n){return void 0!==t&&void 0!==n?new e(this.wasmTensor.clip(t,n)):void 0!==t?new e(this.wasmTensor.clip_min(t)):void 0!==n?new e(this.wasmTensor.clip_max(n)):this.copy()},e.prototype.clipBackward=function(t,n,r){if(!(t instanceof e))throw new Error("Can only do grad backward with Wasm tensor");return void 0!==n&&void 0!==r?new e(this.wasmTensor.clip_backward(n,r,t.wasmTensor)):void 0!==n?new e(this.wasmTensor.clip_min_backward(n,t.wasmTensor)):void 0!==r?new e(this.wasmTensor.clip_max_backward(r,t.wasmTensor)):this.copy()},e.prototype.repeat=function(t){return new e(this.wasmTensor.repeat(new Uint32Array(t)))},e.prototype.expand=function(t){var n=this.getShape(),r=this.alignShapes(n,t),o=r[0],i=(r[1],r[2]);return A(n,i)?this.copy():new e(this.reshape(o,!1).wasmTensor.expand(new Uint32Array(i)))},e.prototype.pad_impl=function(t,n,r){return new e(this.wasmTensor.pad(new Uint32Array(t),e.padModeToInt[n],r))},e.prototype.gather=function(t,n){return new e(this.wasmTensor.gather(t,n.values,new Uint32Array(n.shape)))},e.prototype.floor=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Floor can only be called on float tensors");return new e(this.wasmTensor.floor())},e.prototype.ceil=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Ceil can only be called on float tensors");return new e(this.wasmTensor.ceil())},e.prototype.round=function(){if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Round can only be called on float tensors");return new e(this.wasmTensor.round())},e.prototype.slice_impl=function(t,n,r,o){return new e(this.wasmTensor.slice(new Uint32Array(t),new Uint32Array(n),new Uint32Array(r),new Int32Array(o)))},e.prototype.upsample=function(t){return new e(this.wasmTensor.upsample(new Float32Array(t)))},e.prototype.normalize=function(t,n,r,o,i){if(!(t instanceof e)||!(n instanceof e)||!(o instanceof e)||!(i instanceof e))throw new Error("Can only normalize with WASM tensors");if(!(this.wasmTensor instanceof Vn)&&!(this.wasmTensor instanceof Gn))throw new Error("Normalize can only be called on float tensors");return new e(this.wasmTensor.normalize(t.wasmTensor,n.wasmTensor,r,o.wasmTensor,i.wasmTensor))},e.padModeToInt={constant:0,reflect:1,edge:2},e}(C),Hr=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.sign(),n=t.multiply(e);e.delete(),this.input.backward(n)||n.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Jr=function(){function t(t,e){this.input=t,this.exp=e}return t.prototype.backward=function(t){var e=t.multiply(this.exp);this.input.backward(e)||e.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Kr=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=t.divide(this.input.value);this.input.backward(e)||e.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Yr=function(){function t(t,e){this.a=t,this.b=e}return t.prototype.backward=function(t){if(!this.b.noGrad){var e=this.a.value.gemm(t,!0,!1);this.b.backward(e)||e.delete()}if(!this.a.noGrad){var n=t.gemm(this.b.value,!1,!0);this.a.backward(n)||n.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete(),this.b.isLeaf()||this.b.delete()},t}(),Qr=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=t.negate();this.input.backward(e)||e.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Zr=function(){function t(t,e){this.input=t,this.sqrt=e}return t.prototype.backward=function(t){var e=t.divide(this.sqrt,.5);this.input.backward(e)||e.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),$r=function(){function t(t,e,n){this.a=t,this.b=e,this.axis=n}return t.prototype.backward=function(t){var e=this.axis;if(e<0&&(e+=this.a.getShape().length),!this.a.noGrad){var n=t.slice([0],[this.a.getShape()[e]],[e]);this.a.backward(n)||n.delete()}if(!this.b.noGrad){var r=t.slice([this.a.getShape()[e]],[t.getShape()[e]],[e]);this.b.backward(r)||r.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete(),this.b.isLeaf()||this.b.delete()},t}(),to=function(){function t(t,e,n){this.input=t,this.min=e,this.max=n}return t.prototype.backward=function(t){var e=this.input.value.clipBackward(t,this.min,this.max);this.input.backward(e)||e.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),eo=function(){function t(t,e){this.a=t,this.repeats=e}return t.prototype.backward=function(t){for(var e=this.a.getShape(),n=[],r=[],o=0;o<e.length;o++)n.push(this.repeats[o],e[o]),r.push(2*o);var i=t.reshape(n,!1).sum(r,!1);this.a.backward(i)||i.delete()},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete()},t}(),no=function(){function t(t,e){this.a=t,this.shape=e}return t.prototype.backward=function(t){for(var e=this.a.value.alignShapes(this.a.getShape(),this.shape),n=e[0],r=e[1],o=(e[2],[]),i=0;i<n.length;i++)n[i]<r[i]&&o.push(i);var a=t.sum(o).reshape(this.a.getShape());this.a.backward(a)||a.delete()},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete()},t}(),ro=function(){function t(t){this.a=t}return t.prototype.backward=function(t){var e=this.a.getShape();if(!this.a.noGrad){var n=t.reshape(e);this.a.backward(n)||n.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete()},t}(),oo=function(){function t(t,e,n,r,o){this.a=t,this.b=e,this.shape=n,this.alpha=r,this.beta=o}return t.prototype.backward=function(t){for(var e=this.a.getShape(),n=this.b.getShape(),r=[],o=[],i=0;i<this.shape.length;i++)e[i]<this.shape[i]&&r.push(i),n[i]<this.shape[i]&&o.push(i);if(!this.a.noGrad){var a=void 0;if(0===r.length)a=1===this.alpha?t.reshape(e):t.multiplyScalar(this.alpha).reshape(e,!1);else if(1===this.alpha)a=t.sum(r).reshape(e,!1);else{var u=(p=t.sum(r)).multiplyScalar(this.alpha);p.delete(),a=u.reshape(e,!1)}this.a.backward(a)||a.delete()}if(!this.b.noGrad){var s=void 0;if(0===o.length)s=1===this.beta?t.reshape(n):t.multiplyScalar(this.beta).reshape(n,!1);else if(1===this.beta)s=t.sum(o).reshape(n,!1);else{var p;u=(p=t.sum(o)).multiplyScalar(this.beta);p.delete(),s=u.reshape(n,!1)}this.b.backward(s)||s.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete(),this.b.isLeaf()||this.b.delete()},t}(),io=function(){function t(t,e,n,r,o){this.a=t,this.b=e,this.shape=n,this.alpha=r,this.beta=o}return t.prototype.backward=function(t){for(var e=this.a.getShape(),n=this.b.getShape(),r=[],o=[],i=0;i<this.shape.length;i++)e[i]<this.shape[i]&&r.push(i),n[i]<this.shape[i]&&o.push(i);if(!this.a.noGrad){var a=void 0;if(0===r.length)a=1===this.alpha?t.reshape(e):t.multiplyScalar(this.alpha).reshape(e,!1);else if(1===this.alpha)a=t.sum(r).reshape(e,!1);else{var u=(p=t.sum(r)).multiplyScalar(this.alpha);p.delete(),a=u.reshape(e,!1)}this.a.backward(a)||a.delete()}if(!this.b.noGrad){var s=void 0;if(0===o.length)s=t.multiplyScalar(-this.beta).reshape(n,!1);else{var p;u=(p=t.sum(o)).multiplyScalar(-this.beta);p.delete(),s=u.reshape(n,!1)}this.b.backward(s)||s.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete(),this.b.isLeaf()||this.b.delete()},t}(),ao=function(){function t(t,e,n,r){this.a=t,this.b=e,this.shape=n,this.alpha=r}return t.prototype.backward=function(t){for(var e=this.a.getShape(),n=this.b.getShape(),r=[],o=[],i=0;i<this.shape.length;i++)e[i]<this.shape[i]&&r.push(i),n[i]<this.shape[i]&&o.push(i);if(!this.a.noGrad){var a=void 0;if(0===r.length)a=t.multiply(this.b.value,this.alpha).reshape(e,!1);else{var u=(p=t.multiply(this.b.value,this.alpha)).sum(r);p.delete(),a=u.reshape(e,!1)}this.a.backward(a)||a.delete()}if(!this.b.noGrad){var s=void 0;if(0===o.length)s=t.multiply(this.a.value,this.alpha).reshape(n,!1);else{var p;u=(p=t.multiply(this.a.value,this.alpha)).sum(o);p.delete(),s=u.reshape(n,!1)}this.b.backward(s)||s.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete(),this.b.isLeaf()||this.b.delete()},t}(),uo=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},so=function(){function t(t,e,n,r,o,i,a){this.x=t,this.w=e,this.strides=n,this.padding=r,this.dilations=o,this.group=i,this.b=a}return t.prototype.backward=function(t){if(!this.w.noGrad){var e=this.x.value.conv(t,void 0,this.strides,this.group,this.padding,this.dilations);this.w.backward(e)||e.delete()}if(void 0!==this.b&&!this.b.noGrad){for(var n=[0],r=0;r<this.dilations.length;r++)n.push(r+2);var o=t.sum(n);this.b.backward(o)||o.delete()}if(!this.x.noGrad){var i=this.w.getShape(),a=[];for(r=0;r<this.dilations.length;r++)a.push(i[r+2]-this.padding[r]+this.dilations[r]-2);a=uo(a,a);var u=t.convTranspose(this.w.value,this.dilations,this.group,a,this.strides);this.x.backward(u)||u.delete()}},t.prototype.delete=function(){this.x.isLeaf()||this.x.delete(),this.w.isLeaf()||this.w.delete(),void 0===this.b||this.b.isLeaf()||this.b.delete()},t}(),po=function(){function t(t,e,n,r,o){this.a=t,this.b=e,this.divResult=n,this.shape=r,this.alpha=o}return t.prototype.backward=function(t){for(var e=this.a.getShape(),n=this.b.getShape(),r=[],o=[],i=0;i<this.shape.length;i++)e[i]<this.shape[i]&&r.push(i),n[i]<this.shape[i]&&o.push(i);if(!this.a.noGrad){var a=void 0;if(0===r.length)a=t.divide(this.b.value,this.alpha).reshape(e,!1);else{var u=t.divide(this.b.value,this.alpha),s=u.sum(r);u.delete(),a=s.reshape(e,!1)}this.a.backward(a)||a.delete()}if(!this.b.noGrad){var p=void 0;if(0===o.length){var c=(l=t.multiply(this.divResult)).divide(this.b.value,-this.alpha);l.delete(),p=c.reshape(n,!1)}else{var l;c=(l=t.multiply(this.divResult)).divide(this.b.value,-this.alpha);l.delete();s=c.sum(o);c.delete(),p=s.reshape(n,!1)}this.b.backward(p)||p.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete(),this.b.isLeaf()||this.b.delete()},t}(),co=function(){function t(t,e,n,r){this.a=t,this.b=e,this.powerResult=n,this.shape=r}return t.prototype.backward=function(t){for(var e=this.a.getShape(),n=this.b.getShape(),r=[],o=[],i=0;i<this.shape.length;i++)e[i]<this.shape[i]&&r.push(i),n[i]<this.shape[i]&&o.push(i);if(!this.a.noGrad){var a=void 0;if(0===r.length){var u=(p=this.powerResult.multiply(this.b.value)).divide(this.a.value);p.delete();var s=t.multiply(u);u.delete(),a=s.reshape(e,!1)}else{var p;u=(p=this.powerResult.multiply(this.b.value)).divide(this.a.value);p.delete();s=t.multiply(u);u.delete();var c=s.sum(r);s.delete(),a=c.reshape(e,!1)}this.a.backward(a)||a.delete()}if(!this.b.noGrad){var l=void 0;if(0===o.length){var h=this.a.value.log(),f=this.powerResult.multiply(h);h.delete(),l=t.multiply(f),f.delete(),l=l.reshape(n,!1)}else{h=this.a.value.log(),f=this.powerResult.multiply(h);h.delete();var d=t.multiply(f);f.delete();c=d.sum(o);d.delete(),l=c.reshape(n,!1)}this.b.backward(l)||l.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete(),this.b.isLeaf()||this.b.delete()},t}(),lo=function(){function t(t,e,n,r,o,i,a){this.a=t,this.b=e,this.transA=n,this.transB=r,this.alpha=o,this.beta=i,this.c=a}return t.prototype.backward=function(t){if(!this.b.noGrad){var e=void 0;e=this.transB?t.gemm(this.a.value,!0,this.transA,this.alpha):this.a.value.gemm(t,!this.transA,!1,this.alpha),this.b.backward(e)||e.delete()}if(!this.a.noGrad){var n=void 0;n=this.transA?this.b.value.gemm(t,this.transB,!0,this.alpha):t.gemm(this.b.value,!1,!this.transB,this.alpha),this.a.backward(n)||n.delete()}if(void 0!==this.c&&!this.c.noGrad){for(var r=t.getShape(),o=this.c.getShape(),i=[],a=0;a<r.length;a++)o[a]<r[a]&&i.push(a);var u=t.sum(i).reshape(o,!1);if(1!==this.beta){var s=u;u=u.multiplyScalar(this.beta),s.delete()}this.c.backward(u)||u.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete(),this.b.isLeaf()||this.b.delete(),void 0===this.c||this.c.isLeaf()||this.c.delete()},t}(),ho=function(){function t(t,e){this.a=t,this.permutation=e}return t.prototype.backward=function(t){for(var e=new Array(this.permutation.length),n=0;n<this.permutation.length;n++)e[this.permutation[n]]=n;var r=t.transpose(e);this.a.backward(r)||r.delete()},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete()},t}(),fo=function(){function t(t,e,n){this.input=t,this.sumDims=e,this.keepDims=n}return t.prototype.backward=function(t){var e=this.input.value.getShape();if(!this.keepDims){for(var n=[],r=0,o=0;o<e.length;o++)r<this.sumDims.length&&this.sumDims[r]===o?(n.push(1),r++):n.push(e[o]);t=t.reshape(n,!1)}t=t.expand(e),this.input.backward(t)||t.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),yo=function(){function t(t,e,n){this.input=t,this.sumDims=e,this.keepDims=n}return t.prototype.backward=function(t){var e=this.input.value.getShape();if(!this.keepDims){for(var n=[],r=0,o=0;o<e.length;o++)r<this.sumDims.length&&this.sumDims[r]===o?(n.push(1),r++):n.push(e[o]);t=t.reshape(n,!1)}var i=t.expand(e),a=i.multiply(this.input.value,2);i.delete(),this.input.backward(a)||a.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),mo=function(){function t(t,e){this.input=t,this.scalar=e}return t.prototype.backward=function(t){var e=t.multiplyScalar(this.scalar);this.input.backward(e)||e.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),vo=function(){function t(t,e,n){this.input=t,this.sumDims=e,this.keepDims=n}return t.prototype.backward=function(t){var e=this.input.value.getShape();if(!this.keepDims){for(var n=[],r=0,o=0;o<e.length;o++)r<this.sumDims.length&&this.sumDims[r]===o?(n.push(1),r++):n.push(e[o]);t=t.reshape(n,!1)}var i=1;for(o=0;o<this.sumDims.length;o++)i*=e[this.sumDims[o]];var a=t.multiplyScalar(1/i),u=a.expand(e);a.delete,this.input.backward(u)||t.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),wo=function(){function t(t,e,n){this.input=t,this.sumDims=e,this.keepDims=n}return t.prototype.backward=function(t){var e=this.input.value.getShape();if(!this.keepDims){for(var n=[],r=0,o=0;o<e.length;o++)r<this.sumDims.length&&this.sumDims[r]===o?(n.push(1),r++):n.push(e[o]);t=t.reshape(n,!1)}var i=1;for(o=0;o<this.sumDims.length;o++)i*=e[this.sumDims[o]];var a=t.expand(e),u=a.multiply(this.input.value,2/i);a.delete(),this.input.backward(u)||u.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),go=function(){function t(t,e,n,r,o){if(this.a=t,this.starts=e,this.ends=n,this.axes=r,this.steps=o,void 0!==o.find((function(t){return 1!==t})))throw new Error("Slice backward pass only supports step size of 1")}return t.prototype.backward=function(t){if(!this.a.noGrad){for(var e=this.a.getShape(),n=e.length,r=new Array(2*n).fill(0),o=0;o<this.axes.length;o++)r[this.axes[o]]=this.starts[o],r[n+this.axes[o]]=e[this.axes[o]]-this.ends[o];var i=t.pad(r,"constant",0);this.a.backward(i)||i.delete()}},t.prototype.delete=function(){this.a.isLeaf()||this.a.delete()},t}(),bo=function(){function t(t,e,n,r,o){this.x=t}return t.prototype.backward=function(t){throw new Error("Backward pass not implemented for average pool")},t.prototype.delete=function(){this.x.isLeaf()||this.x.delete()},t}(),_o=function(){function t(t,e,n,r){this.x=t,this.pads=e,this.mode=n,this.value=r}return t.prototype.backward=function(t){throw new Error("Backward pass not implemented for pad")},t.prototype.delete=function(){this.x.isLeaf()||this.x.delete()},t}(),xo=function(){function t(t,e,n,r){this.input=t,this.product=e,this.sumDims=n,this.keepDims=r}return t.prototype.backward=function(t){var e=this.input.value.getShape(),n=t.multiply(this.product);if(!this.keepDims){for(var r=[],o=0,i=0;i<e.length;i++)o<this.sumDims.length&&this.sumDims[o]===i?(r.push(1),o++):r.push(e[i]);n=n.reshape(r,!1)}var a=n.expand(e);n.delete();var u=a.divide(this.input.value);a.delete(),this.input.backward(u)||u.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Oo=function(){function t(t,e){this.input=t,this.sigmoid=e}return t.prototype.backward=function(t){var e=this.sigmoid.addMultiplyScalar(-1,1),n=this.sigmoid.multiply(e);e.delete();var r=n.multiply(t);n.delete(),this.input.backward(r)||r.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),ko=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.cos(),n=t.multiply(e);e.delete(),this.input.backward(n)||n.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),So=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.multiply(this.input.value),n=e.addMultiplyScalar(-1,1);e.delete();var r=n.sqrt();n.delete();var o=t.divide(r);r.delete(),this.input.backward(o)||o.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Ao=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.cosh(),n=t.multiply(e);e.delete(),this.input.backward(n)||n.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Po=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.multiply(this.input.value),n=e.addMultiplyScalar(1,1);e.delete();var r=n.sqrt();n.delete();var o=t.divide(r);r.delete(),this.input.backward(o)||o.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),jo=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.sin(),n=t.multiply(e,-1);e.delete(),this.input.backward(n)||n.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Mo=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.multiply(this.input.value),n=e.addMultiplyScalar(-1,1);e.delete();var r=n.sqrt();n.delete();var o=t.divide(r,-1);r.delete(),this.input.backward(o)||o.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),To=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.sinh(),n=t.multiply(e);e.delete(),this.input.backward(n)||n.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Io=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.multiply(this.input.value),n=e.addMultiplyScalar(1,-1);e.delete();var r=n.sqrt();n.delete();var o=t.divide(r);r.delete(),this.input.backward(o)||o.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Co=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.cos(),n=e.multiply(e);e.delete();var r=t.divide(n);n.delete(),this.input.backward(r)||r.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Go=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.multiply(this.input.value),n=e.addMultiplyScalar(1,1);e.delete();var r=t.divide(n);n.delete(),this.input.backward(r)||r.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Vo=function(){function t(t,e){this.input=t,this.tanH=e}return t.prototype.backward=function(t){var e=this.tanH.multiply(this.tanH),n=e.addMultiplyScalar(-1,1);e.delete();var r=t.multiply(n);n.delete(),this.input.backward(r)||r.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Eo=function(){function t(t){this.input=t}return t.prototype.backward=function(t){var e=this.input.value.multiply(this.input.value),n=e.addMultiplyScalar(-1,1);e.delete();var r=t.divide(n);n.delete(),this.input.backward(r)||r.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Ro=function(){function t(t,e,n){this.input=t,this.sumDims=e,this.keepDims=n}return t.prototype.backward=function(t){var e=this.input.value.getShape(),n=this.input.value.sum(this.sumDims,this.keepDims),r=t.divide(n);if(n.delete(),!this.keepDims){for(var o=[],i=0,a=0;a<e.length;a++)i<this.sumDims.length&&this.sumDims[i]===a?(o.push(1),i++):o.push(e[a]);r=r.reshape(o,!1)}var u=r.expand(e);r.delete(),this.input.backward(u)||u.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Xo=function(){function t(t,e,n){this.input=t,this.sumDims=e,this.keepDims=n}return t.prototype.backward=function(t){var e=this.input.value.getShape(),n=this.input.value.exp(),r=n.sum(this.sumDims,!0),o=n.divide(r);if(n.delete(),r.delete(),!this.keepDims){for(var i=[],a=0,u=0;u<e.length;u++)a<this.sumDims.length&&this.sumDims[a]===u?(i.push(1),a++):i.push(e[u]);t=t.reshape(i,!1)}var s=t.expand(e),p=s.multiply(o);s.delete(),this.input.backward(p)||p.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Bo=function(){function t(t,e,n){this.input=t,this.power=e,this.factor=n}return t.prototype.backward=function(t){var e=this.input.value.powerScalar(this.power-1,this.factor*this.power),n=t.multiply(e);e.delete(),this.input.backward(n)||n.delete()},t.prototype.delete=function(){this.input.isLeaf()||this.input.delete()},t}(),Do=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Uo=function(t){function e(e,n){var r=t.call(this,e.dtype)||this;return r.value=e,void 0===n&&(n={}),r.grad=n.grad,void 0!==n.backEdge&&(r.backEdge=n.backEdge),r.noGrad=n.noGrad||!1,r}return Do(e,t),e.create=function(t,n,r,o,i){return void 0===i&&(i="float32"),new e("CPU"===r?new Q(t,n):"WASM"===r?new qr(n,new Uint32Array(t),i):new In(n,t,i),o)},e.fromData=function(t,n){return new e(In.fromData(t),n)},e.prototype.cast=function(t){throw new Error("Method not implemented.")},e.prototype.backward=function(t){if(void 0===t){var e=this.value.getShape();if(1!==e.length||1!==e[0])throw new Error("Backward without an input gradient can only be done for tensors with shape [1]");t=this.value}var n=!1;if(void 0!==this.grad){var r=this.grad;this.grad=this.grad.add(t),r.delete()}else this.grad=t,n=!0;return void 0!==this.backEdge&&this.backEdge.backward(t),n},e.prototype.isLeaf=function(){return void 0===this.backEdge},e.prototype.constantLike=function(t){return new e(this.value.constantLike(t),{noGrad:!0})},e.prototype.singleConstant=function(t){return new e(this.value.singleConstant(t),{noGrad:!0})},e.prototype.getValues=function(){return this.value.getValues()},e.prototype.getShape=function(){return this.value.getShape()},e.prototype.delete=function(){this.value.delete(),void 0!==this.grad&&this.grad.delete(),void 0!==this.backEdge&&this.backEdge.delete()},e.prototype.reshape_impl=function(t,n){return new e(this.value.reshape(t),{backEdge:this.noGrad?void 0:new ro(this),noGrad:this.noGrad})},e.prototype.exp=function(){var t=this.value.exp();return new e(t,{backEdge:this.noGrad?void 0:new Jr(this,t),noGrad:this.noGrad})},e.prototype.log=function(){return new e(this.value.log(),{backEdge:this.noGrad?void 0:new Kr(this),noGrad:this.noGrad})},e.prototype.sqrt=function(){var t=this.value.sqrt();return new e(t,{backEdge:this.noGrad?void 0:new Zr(this,t),noGrad:this.noGrad})},e.prototype.abs=function(){return new e(this.value.abs(),{backEdge:this.noGrad?void 0:new Hr(this),noGrad:this.noGrad})},e.prototype.sin=function(){return new e(this.value.sin(),{backEdge:this.noGrad?void 0:new ko(this),noGrad:this.noGrad})},e.prototype.cos=function(){return new e(this.value.cos(),{backEdge:this.noGrad?void 0:new jo(this),noGrad:this.noGrad})},e.prototype.tan=function(){return new e(this.value.tan(),{backEdge:this.noGrad?void 0:new Co(this),noGrad:this.noGrad})},e.prototype.asin=function(){return new e(this.value.asin(),{backEdge:this.noGrad?void 0:new So(this),noGrad:this.noGrad})},e.prototype.acos=function(){return new e(this.value.acos(),{backEdge:this.noGrad?void 0:new Mo(this),noGrad:this.noGrad})},e.prototype.atan=function(){return new e(this.value.atan(),{backEdge:this.noGrad?void 0:new Go(this),noGrad:this.noGrad})},e.prototype.sinh=function(){return new e(this.value.sinh(),{backEdge:this.noGrad?void 0:new Ao(this),noGrad:this.noGrad})},e.prototype.cosh=function(){return new e(this.value.cosh(),{backEdge:this.noGrad?void 0:new To(this),noGrad:this.noGrad})},e.prototype.tanh=function(){var t=this.value.tanh();return new e(t,{backEdge:this.noGrad?void 0:new Vo(this,t),noGrad:this.noGrad})},e.prototype.asinh=function(){return new e(this.value.asinh(),{backEdge:this.noGrad?void 0:new Po(this),noGrad:this.noGrad})},e.prototype.acosh=function(){return new e(this.value.acosh(),{backEdge:this.noGrad?void 0:new Io(this),noGrad:this.noGrad})},e.prototype.atanh=function(){return new e(this.value.atanh(),{backEdge:this.noGrad?void 0:new Eo(this),noGrad:this.noGrad})},e.prototype.sigmoid=function(){var t=this.value.sigmoid();return new e(t,{backEdge:this.noGrad?void 0:new Oo(this,t),noGrad:this.noGrad})},e.prototype.hardSigmoid=function(t,e){throw new Error("Method not implemented.")},e.prototype.sign=function(){return new e(this.value.sign())},e.prototype.negate=function(){return new e(this.value.negate(),{backEdge:this.noGrad?void 0:new Qr(this),noGrad:this.noGrad})},e.prototype.addMultiplyScalar=function(t,n){return new e(this.value.addMultiplyScalar(t,n),{backEdge:this.noGrad?void 0:new mo(this,t),noGrad:this.noGrad})},e.prototype.powerScalar=function(t,n){return new e(this.value.powerScalar(t,n),{backEdge:this.noGrad?void 0:new Bo(this,t,n),noGrad:this.noGrad})},e.prototype.setValues=function(t,e){throw new Error("Method not implemented.")},e.prototype.matMul=function(t){if(!(t instanceof e))throw new Error("MatMul can only be done with another variable");var n=this.noGrad&&t.noGrad;return new e(this.value.matMul(t.value),{backEdge:n?void 0:new Yr(this,t),noGrad:n})},e.prototype.concat=function(t,n){if(!(t instanceof e))throw new Error("Concat can only be done with another variable");var r=this.noGrad&&t.noGrad;return new e(this.value.concat(t.value,n),{backEdge:r?void 0:new $r(this,t,n),noGrad:r})},e.prototype.clip=function(t,n){return new e(this.value.clip(t,n),{backEdge:this.noGrad?void 0:new to(this,t,n),noGrad:this.noGrad})},e.prototype.clipBackward=function(t,e,n){throw new Error("Clip backward not implemented for Variable")},e.prototype.repeat=function(t){return new e(this.value.repeat(t),{backEdge:this.noGrad?void 0:new eo(this,t),noGrad:this.noGrad})},e.prototype.expand=function(t){return new e(this.value.expand(t),{backEdge:this.noGrad?void 0:new no(this,t),noGrad:this.noGrad})},e.prototype.copy=function(){return new e(this.value.copy(),{grad:void 0!==this.grad?this.grad.copy():void 0})},e.prototype.gather=function(t,e){throw new Error("Method not implemented.")},e.prototype.floor=function(){return new e(this.value.floor())},e.prototype.ceil=function(){return new e(this.value.ceil())},e.prototype.round=function(){return new e(this.value.round())},e.prototype.upsample=function(t){throw new Error("Method not implemented.")},e.prototype.normalize=function(t,e,n,r,o){throw new Error("Method not implemented.")},e.prototype.add_impl=function(t,n,r,o,i){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add Variable tensor to Variable tensor");var a=t.noGrad&&n.noGrad;return new e(t.value.add_impl(t.value,n.value,r,o,i),{backEdge:a?void 0:new oo(t,n,r,o,i),noGrad:a})},e.prototype.subtract_impl=function(t,n,r,o,i){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add Variable tensor to Variable tensor");var a=t.noGrad&&n.noGrad;return new e(t.value.subtract_impl(t.value,n.value,r,o,i),{backEdge:a?void 0:new io(t,n,r,o,i),noGrad:a})},e.prototype.multiply_impl=function(t,n,r,o){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only add Variable tensor to Variable tensor");var i=t.noGrad&&n.noGrad;return new e(t.value.multiply_impl(t.value,n.value,r,o),{backEdge:i?void 0:new ao(t,n,r,o),noGrad:i})},e.prototype.divide_impl=function(t,n,r,o){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only divide Variable tensor by Variable tensor");var i=t.value.divide_impl(t.value,n.value,r,o),a=t.noGrad&&n.noGrad;return new e(i,{backEdge:a?void 0:new po(t,n,i,r,o),noGrad:a})},e.prototype.power_impl=function(t,n,r){if(!(n instanceof e)||!(t instanceof e))throw new Error("Can only take Variable tensor to power of Variable tensor");var o=t.value.power_impl(t.value,n.value,r),i=t.noGrad&&n.noGrad;return new e(o,{backEdge:i?void 0:new co(t,n,o,r),noGrad:i})},e.prototype.gemm_impl=function(t,n,r,o,i,a){if(!(t instanceof e)||void 0!==a&&!(a instanceof e))throw new Error("Can only do gemm with variable tensors");var u=this.noGrad&&t.noGrad&&(void 0===a||a.noGrad);return new e(this.value.gemm_impl(t.value,n,r,o,i,void 0!==a?a.value:void 0),{backEdge:u?void 0:new lo(this,t,n,r,o,i,a),noGrad:u})},e.prototype.sum_impl=function(t,n){return new e(this.value.sum(t,n),{backEdge:this.noGrad?void 0:new fo(this,t,n),noGrad:this.noGrad})},e.prototype.sumSquare_impl=function(t,n){return new e(this.value.sumSquare(t,n),{backEdge:this.noGrad?void 0:new yo(this,t,n),noGrad:this.noGrad})},e.prototype.product_impl=function(t,n){var r=this.value.product(t,n);return new e(r,{backEdge:this.noGrad?void 0:new xo(this,r,t,n),noGrad:this.noGrad})},e.prototype.max_impl=function(t,e){throw new Error("Method not implemented.")},e.prototype.min_impl=function(t,e){throw new Error("Method not implemented.")},e.prototype.reduceMean_impl=function(t,n){return new e(this.value.reduceMean(t,n),{backEdge:this.noGrad?void 0:new vo(this,t,n),noGrad:this.noGrad})},e.prototype.reduceMeanSquare_impl=function(t,n){return new e(this.value.reduceMeanSquare(t,n),{backEdge:this.noGrad?void 0:new wo(this,t,n),noGrad:this.noGrad})},e.prototype.reduceLogSum_impl=function(t,n){return new e(this.value.reduceLogSum(t,n),{backEdge:this.noGrad?void 0:new Ro(this,t,n),noGrad:this.noGrad})},e.prototype.reduceLogSumExp_impl=function(t,n){return new e(this.value.reduceLogSumExp(t,n),{backEdge:this.noGrad?void 0:new Xo(this,t,n),noGrad:this.noGrad})},e.prototype.conv_impl=function(t,n,r,o,i,a,u){if(!(t instanceof e)||void 0!==u&&!(u instanceof e))throw new Error("Can only do convolution with variable as kernel and bias");if("id"!==a)throw new Error("Activation has to be ID for convolution with variables");var s=this.noGrad&&t.noGrad&&(void 0===u||u.noGrad);return new e(this.value.conv(t.value,void 0!==u?u.value:void 0,n,r,o,i),{backEdge:s?void 0:new so(this,t,i,o,n,r,u),noGrad:s})},e.prototype.convTranspose_impl=function(t,e,n,r,o){throw new Error("Method not implemented.")},e.prototype.pad_impl=function(t,n,r){return new e(this.value.pad(t,n,r),{backEdge:this.noGrad?void 0:new _o(this,t,n,r),noGrad:this.noGrad})},e.prototype.averagePool_impl=function(t,n,r,o){return new e(this.value.averagePool(t,n,r,o),{backEdge:this.noGrad?void 0:new bo(this,t,n,r,o),noGrad:this.noGrad})},e.prototype.transpose_impl=function(t){return new e(this.value.transpose(t),{backEdge:this.noGrad?void 0:new ho(this,t),noGrad:this.noGrad})},e.prototype.slice_impl=function(t,n,r,o){return new e(this.value.slice(t,n,r,o),{backEdge:this.noGrad?void 0:new go(this,t,n,r,o),noGrad:this.noGrad})},e}(C),Wo=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},zo=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function Lo(t){return Wo(this,void 0,void 0,(function(){var e,n,r,o,i;return zo(this,(function(a){switch(a.label){case 0:return t instanceof Uo?(e=Uo.bind,[4,Lo(t.value)]):[3,5];case 1:return n=[void 0,a.sent()],i={},void 0===t.grad?[3,3]:[4,Lo(t.grad)];case 2:return r=a.sent(),[3,4];case 3:r=void 0,a.label=4;case 4:return[2,new(e.apply(Uo,n.concat([(i.grad=r,i)])))];case 5:return t instanceof Q?[2,t]:[4,t.getValues()];case 6:return o=a.sent(),[2,new Q(t.getShape(),o,t.dtype)]}}))}))}function Fo(t){return Wo(this,void 0,void 0,(function(){var e,n,r,o,i;return zo(this,(function(a){switch(a.label){case 0:if("float16"===t.dtype)throw new Error("Cant represent float16 tensor on Wasm backend");return t instanceof Uo?(e=Uo.bind,[4,Fo(t.value)]):[3,5];case 1:return n=[void 0,a.sent()],i={},void 0===t.grad?[3,3]:[4,Fo(t.grad)];case 2:return r=a.sent(),[3,4];case 3:r=void 0,a.label=4;case 4:return[2,new(e.apply(Uo,n.concat([(i.grad=r,i)])))];case 5:return t instanceof qr?[2,t]:[4,t.getValues()];case 6:return o=a.sent(),t instanceof Q&&o instanceof Int32Array?[2,t]:[2,new qr(Array.from(o),new Uint32Array(t.getShape()),t.dtype)]}}))}))}function No(t){return Wo(this,void 0,void 0,(function(){var e,n,r,o,i;return zo(this,(function(a){switch(a.label){case 0:if("float64"===t.dtype)throw new Error("Cant represent float64 tensor on WebGL backend");return t instanceof Uo?(e=Uo.bind,[4,No(t.value)]):[3,5];case 1:return n=[void 0,a.sent()],i={},void 0===t.grad?[3,3]:[4,No(t.grad)];case 2:return r=a.sent(),[3,4];case 3:r=void 0,a.label=4;case 4:return[2,new(e.apply(Uo,n.concat([(i.grad=r,i)])))];case 5:return t instanceof In?[2,t]:[4,t.getValues()];case 6:return o=a.sent(),t instanceof Q&&o instanceof Int32Array?[2,t]:[2,new In(Array.from(o),t.getShape(),t.dtype)]}}))}))}var qo=n(1),Ho=n.n(qo),Jo=n(14),Ko=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Yo=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Qo=function(){function t(){this.backend="CPU",this.mode="train"}return t.prototype.getSubModules=function(){for(var e=[],n=0,r=Object.keys(this);n<r.length;n++){var o=r[n];this[o]instanceof t&&e.push(this[o])}return e},t.prototype.getParameters=function(){for(var t=[],e=0,n=Object.keys(this);e<n.length;e++){var r=n[e];this[r]instanceof Uo&&t.push(this[r])}for(var o=0,i=this.getSubModules();o<i.length;o++){var a=i[o].getParameters();t=t.concat(a)}return t},t.prototype.toBackend=function(t){return"CPU"===t?this.toCPU():"WASM"===t?this.toWASM():this.toGPU()},t.prototype.toCPU=function(){return Ko(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return Yo(this,(function(s){switch(s.label){case 0:t=this.getSubModules(),e=0,n=t,s.label=1;case 1:return e<n.length?[4,n[e].toCPU()]:[3,4];case 2:s.sent(),s.label=3;case 3:return e++,[3,1];case 4:r=0,o=Object.keys(this),s.label=5;case 5:return r<o.length?this[i=o[r]]instanceof C?(a=this,u=i,[4,Lo(this[i])]):[3,7]:[3,8];case 6:a[u]=s.sent(),s.label=7;case 7:return r++,[3,5];case 8:return this.backend="CPU",[2]}}))}))},t.prototype.toWASM=function(){return Ko(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return Yo(this,(function(s){switch(s.label){case 0:t=this.getSubModules(),e=0,n=t,s.label=1;case 1:return e<n.length?[4,n[e].toWASM()]:[3,4];case 2:s.sent(),s.label=3;case 3:return e++,[3,1];case 4:r=0,o=Object.keys(this),s.label=5;case 5:return r<o.length?this[i=o[r]]instanceof C?(a=this,u=i,[4,Fo(this[i])]):[3,7]:[3,8];case 6:a[u]=s.sent(),s.label=7;case 7:return r++,[3,5];case 8:return this.backend="WASM",[2]}}))}))},t.prototype.toGPU=function(){return Ko(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return Yo(this,(function(s){switch(s.label){case 0:t=this.getSubModules(),e=0,n=t,s.label=1;case 1:return e<n.length?[4,n[e].toGPU()]:[3,4];case 2:s.sent(),s.label=3;case 3:return e++,[3,1];case 4:r=0,o=Object.keys(this),s.label=5;case 5:return r<o.length?this[i=o[r]]instanceof C?(a=this,u=i,[4,No(this[i])]):[3,7]:[3,8];case 6:a[u]=s.sent(),s.label=7;case 7:return r++,[3,5];case 8:return this.backend="GPU",[2]}}))}))},t}(),Zo=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$o=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},ti=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ei=function(t){function e(e,n,r,o,i,a){var u=t.call(this)||this;u.attributes={},u.mode=a;for(var s=0;s<e.length;s++)u.attributes[e[s].name]=e[s];u.inputs=n,u.outputs=r,u.onnxVersion=i,u.variableInputs=0;for(s=0;s<u.inputs.length;s++)void 0===o[u.inputs[s]]&&u.variableInputs++;return u}return Zo(e,t),e.prototype.initialize=function(t){},e.prototype.getAttribute=function(t){return this.attributes[t]},e.prototype.getAttributeString=function(t){var e=this.attributes[t];if(void 0!==e){var n=e.s;return void 0!==n&&null!==n?new TextDecoder("utf-8").decode(n):void 0}},e.prototype.getAttributeInts=function(t){if(void 0!==this.attributes[t]){var e=this.attributes[t].ints;if(void 0!==e&&null!==e){for(var n=0;n<e.length;n++)Ho.a.isLong(e[n])&&(e[n]=e[n].toNumber());return e}}},e.prototype.getAttributeInt=function(t){var e=this.attributes[t];if(void 0!==e){var n=e.i;return Ho.a.isLong(n)&&(n=n.toNumber()),n}},e.prototype.getAttributeFloat=function(t){var e=this.attributes[t];if(void 0!==e)return e.f},e.prototype.getAttributeFloats=function(t){var e=this.attributes[t];if(void 0!==e)return e.floats},e.prototype.getAttributeTensor=function(t){var e=this.attributes[t];if(void 0!==e)return e.t},e.prototype.toValues=function(t){return $o(this,void 0,void 0,(function(){var e,n,r;return ti(this,(function(o){switch(o.label){case 0:return t instanceof Q?[3,2]:(console.warn("Tensor for values not on CPU, need to transfer!"),[4,Lo(t)]);case 1:t=o.sent(),o.label=2;case 2:for(e=t,n=new Array(e.size),r=0;r<e.size;r++)n[r]=e.get(r);return[2,n]}}))}))},e.prototype.toCPU=function(){return $o(this,void 0,void 0,(function(){return ti(this,(function(t){return[2]}))}))},e.prototype.toWASM=function(){return $o(this,void 0,void 0,(function(){return ti(this,(function(t){return[2]}))}))},e.prototype.toGPU=function(){return $o(this,void 0,void 0,(function(){return ti(this,(function(t){return[2]}))}))},e}(Qo);function ni(t,e){if(void 0===e&&(e=!1),void 0!==t.segment&&null!==t.segment)throw new Error("Handling of tensor proto segment not yet implemented");var n=t.dims;if(void 0===n||null===n)throw new Error("Tensor shape must be specified");for(var r=0;r<n.length;r++)Ho.a.isLong(n[r])&&(n[r]=n[r].toNumber());0===n.length&&(n=[1]);var o=O(n);if(1===t.dataType){if(t.floatData&&t.floatData.length>0)return new Q(n,t.floatData);if(t.rawData&&t.rawData.length>0){var i=t.rawData.buffer.slice(t.rawData.byteOffset,t.rawData.byteOffset+t.rawData.byteLength),a=new Float32Array(i);return new Q(n,a,e?"float16":"float32")}if(0===o)return new Q(n);throw new Error("Cant process float tensor without float or raw data")}if(7===t.dataType){if(t.rawData&&t.rawData.length>0){for(a=new Int32Array(t.rawData.length/8),r=0;r<t.rawData.length;r+=8){var u=Ho.a.fromBytesLE(Array.from(t.rawData.slice(r,r+8))).toNumber();a[r/8]=u}return new Q(n,a,"int32")}throw new Error("Cant process int64 tensor without raw data")}throw new Error("Handling of tensor type "+t.dataType+" not yet implemented")}var ri=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},ii=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ai=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this,s=u.getAttributeTensor("value");if(void 0===s||null===s)throw new Error('Constant needs tensor value, but attribute "value" was not defined');return u.tensor=ni(s),"train"===a&&void 0!==u.tensor&&(u.tensor=new Uo(u.tensor)),u}return ri(e,t),e.prototype.forward=function(t){return oi(this,void 0,void 0,(function(){return ii(this,(function(t){if(void 0!==this.tensor)return[2,[this.tensor]];throw new Error("Constant without tensor value doesnt work")}))}))},e.prototype.toCPU=function(){return oi(this,void 0,void 0,(function(){var t;return ii(this,(function(e){switch(e.label){case 0:return void 0===this.tensor?[3,2]:(t=this,[4,Lo(this.tensor)]);case 1:t.tensor=e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.toWASM=function(){return oi(this,void 0,void 0,(function(){var t;return ii(this,(function(e){switch(e.label){case 0:return void 0===this.tensor?[3,2]:(t=this,[4,Fo(this.tensor)]);case 1:t.tensor=e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.toGPU=function(){return oi(this,void 0,void 0,(function(){var t;return ii(this,(function(e){switch(e.label){case 0:return void 0===this.tensor?[3,2]:(t=this,[4,No(this.tensor)]);case 1:t.tensor=e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.getType=function(){return"Constant"},e.prototype.delete=function(){void 0!==this.tensor&&this.tensor.delete()},e}(ei),ui=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),si=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},pi=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ci=function(t){function e(e,n,r,o,i,a,u,s,p){var c=t.call(this,e,n,r,o,i,a)||this;if(void 0!==c.getAttributeString("autoPad"))throw new Error("Autopad in conv not supported yet");return void 0===p&&(p="id"),c.activation=p,c.group=c.getAttributeInt("group")||1,c.dilations=c.getAttributeInts("dilations"),c.pads=c.getAttributeInts("pads"),c.strides=c.getAttributeInts("strides"),c.kernel=u,c.bias=s,"train"===a&&void 0!==c.kernel&&(c.kernel=new Uo(c.kernel)),"train"===a&&void 0!==c.bias&&(c.bias=new Uo(c.bias)),c}return ui(e,t),e.prototype.forward=function(t){return si(this,void 0,void 0,(function(){var e,n,r;return pi(this,(function(o){return e=t[0],n=void 0!==this.kernel?this.kernel:t[1],r=t.length>2?t[2]:this.bias,[2,[e.conv(n,r,this.dilations,this.group,this.pads,this.strides,this.activation)]]}))}))},e.prototype.getDilations=function(t){return void 0!==this.dilations?this.dilations:new Array(t).fill(1)},e.prototype.getPads=function(t){return void 0!==this.pads?this.pads:new Array(2*t).fill(0)},e.prototype.getStrides=function(t){return void 0!==this.strides?this.strides:new Array(t).fill(1)},e.prototype.getType=function(){return"Conv"},e.prototype.toCPU=function(){return si(this,void 0,void 0,(function(){var t,e;return pi(this,(function(n){switch(n.label){case 0:return void 0===this.kernel?[3,2]:(t=this,[4,Lo(this.kernel)]);case 1:t.kernel=n.sent(),n.label=2;case 2:return void 0===this.bias?[3,4]:(e=this,[4,Lo(this.bias)]);case 3:e.bias=n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype.toWASM=function(){return si(this,void 0,void 0,(function(){var t,e;return pi(this,(function(n){switch(n.label){case 0:return void 0===this.kernel?[3,2]:(t=this,[4,Fo(this.kernel)]);case 1:t.kernel=n.sent(),n.label=2;case 2:return void 0===this.bias?[3,4]:(e=this,[4,Fo(this.bias)]);case 3:e.bias=n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype.toGPU=function(){return si(this,void 0,void 0,(function(){var t,e;return pi(this,(function(n){switch(n.label){case 0:return void 0===this.kernel?[3,2]:(t=this,[4,No(this.kernel)]);case 1:t.kernel=n.sent(),n.label=2;case 2:return void 0===this.bias?[3,4]:(e=this,[4,No(this.bias)]);case 3:e.bias=n.sent(),n.label=4;case 4:return[2]}}))}))},e.prototype.delete=function(){void 0!==this.kernel&&this.kernel.delete(),void 0!==this.bias&&this.bias.delete()},e}(ei),li=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hi=function(){},fi=function(t){function e(e){var n=t.call(this)||this;return n.nodeTypes=e,n}return li(e,t),e.prototype.findApplications=function(t){var e=[],n=t.getNodes();for(var r in Object.keys(n)){var o=n[r];if(void 0!==o&&o.getType()===this.nodeTypes[0]){var i=this.checkApplication(t,r);void 0!==i&&e.push(i)}}return e},e.prototype.checkApplication=function(t,e){for(var n=t.getNodes(),r=[e],o=n[e],i=[o],a=1;a<this.nodeTypes.length;a++){var u=t.getNodeWithInput(o.outputs[0]);if(void 0===u)return;var s=n[u];if(s.getType()!==this.nodeTypes[a])return;r.push(u),o=s,i.push(o)}return this.canApply(i)?r:void 0},e.prototype.canApply=function(t){return!0},e}(hi),di=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yi=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},mi=function(t){function e(){return t.call(this,["Conv","BatchNormalization"])||this}return di(e,t),e.prototype.apply=function(t,e,n,r){var o=t[0],i=t[1],a=e(o.inputs[1]),u=e(o.inputs[2]),s=e(i.inputs[1]),p=e(i.inputs[2]),c=e(i.inputs[3]),l=e(i.inputs[4]).add(i.epsTensor).sqrt(),h=s.divide(l);l.delete();var f=p.subtract(c.multiply(h)),d=yi(h.getShape(),new Array(a.getShape().length-h.getShape().length).fill(1)),y=a.multiply(h.reshape(d,!1)),m=f;if(void 0!==u){var v=u.multiply(h);m=m.add(v),v.delete()}return new ci(Object.entries(o.attributes).map((function(t){return t[1]})),[o.inputs[0]],i.outputs,n,r,o.mode,y,m)},e}(fi),vi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wi=function(t){function e(){return t.call(this,["Conv","Relu"])||this}return vi(e,t),e.prototype.apply=function(t,e,n,r){var o=t[0],i=t[1];return new ci(Object.entries(o.attributes).map((function(t){return t[1]})),o.inputs,i.outputs,n,r,o.mode,o.kernel,o.bias,"relu")},e}(fi),gi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),bi=function(t){function e(){return t.call(this,["Conv","Clip"])||this}return gi(e,t),e.prototype.apply=function(t,e,n,r){var o=t[0],i=t[1];return new ci(Object.entries(o.attributes).map((function(t){return t[1]})),o.inputs,i.outputs,n,r,o.mode,o.kernel,o.bias,"relu6")},e.prototype.canApply=function(t){var e=t[1];return 0===e.min&&6===e.max},e}(fi),_i=[new mi,new wi,new bi],xi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Oi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},ki=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Si=function(t){function e(e,n,r,o,i,a,u){var s=t.call(this,e,n,r,o,i,u)||this;return s.name=a,s}return xi(e,t),e.prototype.forward=function(t){return Oi(this,void 0,void 0,(function(){var e,n;return ki(this,(function(r){if(this.onnxVersion<13&&this.onnxVersion>=7)return e=t[0],n=t[1],[2,[this.compute(e,n)]];throw new Error(this.name+" not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return this.name},e.prototype.delete=function(){},e}(ei),Ai=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pi=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Add",a)||this}return Ai(e,t),e.prototype.compute=function(t,e){return t.add(e)},e}(Si),ji=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ti=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ii=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Ci=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.epsilon=u.getAttributeFloat("epsilon")||1e-5,u.momentum=u.getAttributeFloat("momentum")||.9,u.epsTensor=new Q([1],[u.epsilon]),"train"===a&&(u.epsTensor=new Uo(u.epsTensor)),u}return ji(e,t),e.prototype.forward=function(t){return Mi(this,void 0,void 0,(function(){var e,n,r,o,i,a,u;return Ti(this,(function(s){return e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=n.getShape()[0],u=Ii([1,a],new Array(e.getShape().length-2).fill(1)),n=n.reshape(u,!1),r=r.reshape(u,!1),o=o.reshape(u,!1),i=i.reshape(u,!1),[2,[e.normalize(o,i,this.epsilon,n,r)]]}))}))},e.prototype.getType=function(){return"BatchNormalization"},e.prototype.toCPU=function(){return Mi(this,void 0,void 0,(function(){var t;return Ti(this,(function(e){switch(e.label){case 0:return t=this,[4,Lo(this.epsTensor)];case 1:return t.epsTensor=e.sent(),[2]}}))}))},e.prototype.toWASM=function(){return Mi(this,void 0,void 0,(function(){var t;return Ti(this,(function(e){switch(e.label){case 0:return t=this,[4,Fo(this.epsTensor)];case 1:return t.epsTensor=e.sent(),[2]}}))}))},e.prototype.toGPU=function(){return Mi(this,void 0,void 0,(function(){var t;return Ti(this,(function(e){switch(e.label){case 0:return t=this,[4,No(this.epsTensor)];case 1:return t.epsTensor=e.sent(),[2]}}))}))},e.prototype.delete=function(){this.epsTensor.delete()},e}(ei),Gi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ei=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ri=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.to=u.getAttributeString("to"),u}return Gi(e,t),e.prototype.forward=function(t){return Vi(this,void 0,void 0,(function(){return Ei(this,(function(e){return[2,[t[0].cast(this.to)]]}))}))},e.prototype.getType=function(){return"Cast"},e.prototype.delete=function(){},e}(ei),Xi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Di=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ui=function(t){function e(e,n,r,o,i,a,u){var s=t.call(this,e,n,r,o,i,u)||this;return s.name=a,s}return Xi(e,t),e.prototype.forward=function(t){return Bi(this,void 0,void 0,(function(){var e;return Di(this,(function(n){return e=t[0],[2,[this.compute(e)]]}))}))},e.prototype.getType=function(){return this.name},e.prototype.delete=function(){},e}(ei),Wi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zi=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Ceil",a)||this}return Wi(e,t),e.prototype.compute=function(t){return t.ceil()},e}(Ui),Li=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ni=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},qi=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return i<11&&(u.min=u.getAttributeFloat("min"),u.max=u.getAttributeFloat("max")),u}return Li(e,t),e.prototype.forward=function(t){return Fi(this,void 0,void 0,(function(){var e,n,r;return Ni(this,(function(o){if(e=t[0],this.onnxVersion<11)return[2,[e.clip(this.min,this.max)]];if(n=t.length>1?t[1]:void 0,r=t.length>2?t[2]:void 0,void 0===n&&void 0===r)return[2,[e.copy()]];throw new Error("Clip with onnx version >= 11 not yet implemented")}))}))},e.prototype.getType=function(){return"Clip"},e.prototype.delete=function(){},e}(ei),Hi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ji=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ki=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Yi=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return i<13&&(u.axis=u.getAttributeInt("axis")),u}return Hi(e,t),e.prototype.forward=function(t){return Ji(this,void 0,void 0,(function(){var e,n,r;return Ki(this,(function(o){if(t.length,this.onnxVersion<13&&void 0!==this.axis){for(e=t[0],n=1;n<t.length;n++)r=e.concat(t[n],this.axis),n>1&&e.delete(),e=r;return[2,[e]]}throw new Error("Concat not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Concat"},e.prototype.delete=function(){},e}(ei),Qi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zi=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},$i=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ta=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;if(i<11){var s=u.getAttributeTensor("value");null!==s&&void 0!==s&&(u.tensor=ni(s))}return u}return Qi(e,t),e.prototype.forward=function(t){return Zi(this,void 0,void 0,(function(){var e,n,r,o,i;return $i(this,(function(a){if(e=t[0],this.onnxVersion<11&&void 0!==this.tensor){if(!(e instanceof Q))throw new Error("ConstantOfShape needs cpu tensor as shape tensor");for(n=new Array(e.size),r=0;r<e.size;r++)n[r]=e.get(r);return o=O(n),i=new Float32Array(o).fill(this.tensor.get(0)),[2,[new Q(n,i,this.tensor.dtype)]]}throw new Error("ConstantOfShape not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"ConstantOfShape"},e.prototype.delete=function(){void 0!==this.tensor&&this.tensor.delete()},e}(ei),ea=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),na=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Div",a)||this}return ea(e,t),e.prototype.compute=function(t,e){return t.divide(e)},e}(Si),ra=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oa=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Exp",a)||this}return ra(e,t),e.prototype.compute=function(t){return t.exp()},e}(Ui),ia=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),aa=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},ua=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},sa=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return ia(e,t),e.prototype.forward=function(t){return aa(this,void 0,void 0,(function(){var e,n,r,o;return ua(this,(function(i){if(this.onnxVersion<13){if(e=t[0],!((n=t[1])instanceof Q))throw new Error("Expand needs cpu tensor as shape tensor");for(r=new Array(n.size),o=0;o<n.size;o++)r[o]=n.get(o);return[2,[e.expand(r)]]}throw new Error("Expand not yet implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Expand"},e.prototype.delete=function(){},e}(ei),pa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ca=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Floor",a)||this}return pa(e,t),e.prototype.compute=function(t){return t.floor()},e}(Ui),la=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ha=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},fa=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},da=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.axis=u.getAttributeInt("axis")||0,u}return la(e,t),e.prototype.forward=function(t){return ha(this,void 0,void 0,(function(){var e,n;return fa(this,(function(r){if(e=t[0],!((n=t[1])instanceof Q))throw new Error("Gather requires CPU tensor for the indices");return[2,[e.gather(this.axis,n)]]}))}))},e.prototype.getType=function(){return"Gather"},e.prototype.delete=function(){},e}(ei),ya=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ma=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},va=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},wa=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;u.alpha=u.getAttributeFloat("alpha")||1,u.beta=u.getAttributeFloat("beta")||1;var s=u.getAttributeInt("transA"),p=u.getAttributeInt("transB");return u.transA=1===s,u.transB=1===p,u}return ya(e,t),e.prototype.forward=function(t){return ma(this,void 0,void 0,(function(){var e,n,r;return va(this,(function(o){return e=t[0],n=t[1],r=t[2],[2,[e.gemm(n,this.transA,this.transB,this.alpha,r,this.beta)]]}))}))},e.prototype.getType=function(){return"Gemm"},e.prototype.delete=function(){},e}(ei),ga=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ba=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},_a=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},xa=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Oa=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.epsilon=u.getAttributeFloat("epsilon")||1e-5,u}return ga(e,t),e.prototype.forward=function(t){return ba(this,void 0,void 0,(function(){var e,n,r,o,i,a,u,s,p,c,l,h;return _a(this,(function(f){for(e=t[0],n=t[1],r=t[2],o=e.getShape().length-2,i=n.getShape()[0],a=xa([1,i],new Array(o).fill(1)),n=n.reshape(a,!1),r=r.reshape(a,!1),u=new Array(e.getShape().length-2),s=0;s<o;s++)u[s]=s+2;return p=e.reduceMean(u,!0),ot.flush(),c=e.subtract(p),ot.flush(),l=c.reduceMeanSquare(u,!0),ot.flush(),h=e.normalize(p,l,this.epsilon,n,r),p.delete(),c.delete(),l.delete(),[2,[h]]}))}))},e.prototype.getType=function(){return"InstanceNormalization"},e.prototype.delete=function(){},e}(ei),ka=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sa=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Aa=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Pa=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return ka(e,t),e.prototype.forward=function(t){return Sa(this,void 0,void 0,(function(){var e,n;return Aa(this,(function(r){if(e=t[0],n=t[1],this.onnxVersion<13){if(e.getShape().length!==n.getShape().length)throw new Error("Automatic broadcasting in MatMul not supported yet");return[2,[e.gemm(n)]]}throw new Error("Matmul with onnx version "+this.onnxVersion+" not yet implemented")}))}))},e.prototype.getType=function(){return"MatMul"},e.prototype.delete=function(){},e}(ei),ja=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ma=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Mul",a)||this}return ja(e,t),e.prototype.compute=function(t,e){return t.multiply(e)},e}(Si),Ta=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ia=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ca=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ga=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.padMode=u.getAttributeString("mode")||"constant",u.pads=u.getAttributeInts("pads"),u.value=u.getAttributeFloat("value")||0,u}return Ta(e,t),e.prototype.forward=function(t){return Ia(this,void 0,void 0,(function(){return Ca(this,(function(e){if(this.onnxVersion<11)return[2,[t[0].pad(this.pads,this.padMode,this.value)]];throw new Error("Pad not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Pad"},e.prototype.delete=function(){},e}(ei),Va=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ea=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ra=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Xa=function(t){function e(e,n,r,o,i,a,u){var s=t.call(this,e,n,r,o,i,u)||this;s.axes=s.getAttributeInts("axes");var p=s.getAttributeInt("keepdims");return s.keepDims=1===p||void 0===p,s.name=a,s}return Va(e,t),e.prototype.getAxes=function(t){if(void 0!==this.axes)return this.axes;for(var e=t.getShape().length,n=new Array(e),r=0;r<e;r++)n[r]=r;return n},e.prototype.forward=function(t){return Ea(this,void 0,void 0,(function(){return Ra(this,(function(e){if(this.onnxVersion<13)return[2,[this.calc(t[0])]];throw new Error(this.name+" is not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return this.name},e.prototype.delete=function(){},e}(ei),Ba=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Da=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceMax",a)||this}return Ba(e,t),e.prototype.calc=function(t){return t.max(this.axes,this.keepDims)},e}(Xa),Ua=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wa=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceMean",a)||this}return Ua(e,t),e.prototype.calc=function(t){return t.reduceMean(this.axes,this.keepDims)},e}(Xa),za=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),La=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceSum",a)||this}return za(e,t),e.prototype.calc=function(t){return t.sum(this.axes,this.keepDims)},e}(Xa),Fa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Na=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceSumSquare",a)||this}return Fa(e,t),e.prototype.calc=function(t){return t.sumSquare(this.axes,this.keepDims)},e}(Xa),qa=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ha=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.max=void 0,u.min=0,u}return qa(e,t),e.prototype.getType=function(){return"Relu"},e}(qi),Ja=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ka=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ya=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Qa=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return Ja(e,t),e.prototype.forward=function(t){return Ka(this,void 0,void 0,(function(){var e,n,r,o;return Ya(this,(function(i){if(e=t[0],!((n=t[1])instanceof Q))throw new Error("Reshape only works with CPU tensor as shape tensor");if(this.onnxVersion<13){for(r=new Array(n.size),o=0;o<n.size;o++)r[o]=n.get(o);return[2,[e.reshape(r)]]}throw new Error("Reshape with onnx version "+this.onnxVersion+" not yet implemented")}))}))},e.prototype.getType=function(){return"Reshape"},e.prototype.delete=function(){},e}(ei),Za=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$a=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},tu=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},eu=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},nu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return Za(e,t),e.prototype.forward=function(t){return $a(this,void 0,void 0,(function(){var e,n;return tu(this,(function(r){if(this.onnxVersion<13)return e=t[0],n=e.getShape(),[2,[new Q([n.length],eu(n),"int32")]];throw new Error("Shape not implemented for onnx version "+this.onnxVersion)}))}))},e.prototype.getType=function(){return"Shape"},e.prototype.delete=function(){},e}(ei),ru=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ou=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},iu=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},au=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.axes=u.getAttributeInts("axes"),u.starts=u.getAttributeInts("starts"),u.ends=u.getAttributeInts("ends"),u}return ru(e,t),e.prototype.forward=function(t){return ou(this,void 0,void 0,(function(){var e,n,r,o,i,a,u,s,p,c,l;return iu(this,(function(h){switch(h.label){case 0:if(!(this.onnxVersion<10))return[3,1];if(void 0===this.starts||void 0===this.ends)throw new Error("Slice with onnx version < 10 needs starts and ends defined as attributes");return[2,[(e=t[0]).slice(this.starts,this.ends,this.axes)]];case 1:return e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],[4,this.toValues(n)];case 2:return a=h.sent(),[4,this.toValues(r)];case 3:return u=h.sent(),void 0===o?[3,5]:[4,this.toValues(o)];case 4:return p=h.sent(),[3,6];case 5:p=void 0,h.label=6;case 6:return s=p,void 0===i?[3,8]:[4,this.toValues(i)];case 7:return l=h.sent(),[3,9];case 8:l=void 0,h.label=9;case 9:return c=l,[2,[e.slice(a,u,s,c)]]}}))}))},e.prototype.getType=function(){return"Slice"},e.prototype.delete=function(){},e}(ei),uu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),su=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},pu=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},cu=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.axis=u.getAttributeInt("axis"),u}return uu(e,t),e.prototype.forward=function(t){return su(this,void 0,void 0,(function(){var e,n,r,o,i,a,u,s,p,c;return pu(this,(function(l){return e=t[0],n=e.getShape(),void 0===(r=this.axis)&&(r=this.onnxVersion<13?1:n.length-1),o=n.slice(0,r).reduce((function(t,e){return t*e}),1),i=e.reshape([o,-1],!1),a=i.max(1,!0),u=i.subtract(a),s=u.exp(),p=s.sum(1,!0),c=s.divide(p),a.delete(),u.delete(),s.delete(),p.delete(),[2,[c.reshape(n,!1)]]}))}))},e.prototype.getType=function(){return"Softmax"},e.prototype.delete=function(){},e}(ei),lu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Sub",a)||this}return lu(e,t),e.prototype.compute=function(t,e){return t.subtract(e)},e}(Si),fu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),du=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},yu=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},mu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return fu(e,t),e.prototype.forward=function(t){return du(this,void 0,void 0,(function(){var e,n,r,o;return yu(this,(function(i){if(e=t[0],!((n=t[1])instanceof Q))throw new Error("Tile only works with CPU tensor as repeats");if(this.onnxVersion<13&&this.onnxVersion>=6){for(r=new Array(n.size),o=0;o<n.size;o++)r[o]=n.get(o);return[2,[e.repeat(r)]]}throw new Error("Tile with onnx version "+this.onnxVersion+" not yet implemented")}))}))},e.prototype.getType=function(){return"Tile"},e.prototype.delete=function(){},e}(ei),vu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wu=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},gu=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},bu=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.permutation=u.getAttributeInts("perm"),u}return vu(e,t),e.prototype.forward=function(t){return wu(this,void 0,void 0,(function(){return gu(this,(function(e){return[2,[t[0].transpose(this.permutation)]]}))}))},e.prototype.getType=function(){return"Transpose"},e.prototype.delete=function(){},e}(ei),_u=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xu=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Ou=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ku=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return i<13&&(u.axes=u.getAttributeInts("axes")),u}return _u(e,t),e.prototype.forward=function(t){return xu(this,void 0,void 0,(function(){var e,n,r,o,i;return Ou(this,(function(a){if(e=t[0],this.onnxVersion<13&&void 0!==this.axes){for(n=e.getShape(),r=[],o=0,i=0;i<n.length;i++)o<this.axes.length&&this.axes[o]===i&&(r.push(1),o++),r.push(n[i]);return this.axes[this.axes.length-1]===n.length&&r.push(1),[2,[e.reshape(r)]]}throw new Error("Unsqueeze with onnx version "+this.onnxVersion+" not yet implemented")}))}))},e.prototype.getType=function(){return"Unsqueeze"},e.prototype.delete=function(){},e}(ei),Su=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Au=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Pu=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ju=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;if(u.sampleMode=u.getAttributeString("mode"),"nearest"!==u.sampleMode)throw new Error("Upsampling only supported with nearest neighbor sampling");if(u.onnxVersion<9){var s=u.getAttributeFloats("scales");if(void 0===s||null===s)throw new Error("Upsample node with onnx version "+u.onnxVersion+" is missing scales attribute");u.scales=s}return u}return Su(e,t),e.prototype.getScales=function(t){return Au(this,void 0,void 0,(function(){var e,n,r;return Pu(this,(function(o){switch(o.label){case 0:return this.onnxVersion<9?[2,this.scales]:t instanceof Q?[3,2]:(console.warn("Scales tensor for upsample not on CPU, need to transfer!"),[4,Lo(t)]);case 1:t=o.sent(),o.label=2;case 2:for(e=t,n=new Array(e.size),r=0;r<e.size;r++)n[r]=e.get(r);return[2,n]}}))}))},e.prototype.forward=function(t){return Au(this,void 0,void 0,(function(){var e,n,r;return Pu(this,(function(o){switch(o.label){case 0:return e=t[0],n=t[1],[4,this.getScales(n)];case 1:return r=o.sent(),[2,[e.upsample(r)]]}}))}))},e.prototype.getType=function(){return"Upsample"},e.prototype.delete=function(){},e}(ei),Mu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tu=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Iu=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Cu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return Mu(e,t),e.prototype.forward=function(t){return Tu(this,void 0,void 0,(function(){var e,n,r;return Iu(this,(function(o){for(e=t[0],n=new Array(e.getShape().length-2),r=0;r<e.getShape().length-2;r++)n[r]=r+2;return[2,[e.reduceMean(n,!0)]]}))}))},e.prototype.getType=function(){return"GlobalAveragePool"},e.prototype.delete=function(){},e}(ei),Gu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Abs",a)||this}return Gu(e,t),e.prototype.compute=function(t){return t.abs()},e}(Ui),Eu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ru=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Log",a)||this}return Eu(e,t),e.prototype.compute=function(t){return t.log()},e}(Ui),Xu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Sqrt",a)||this}return Xu(e,t),e.prototype.compute=function(t){return t.sqrt()},e}(Ui),Du=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Uu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Sign",a)||this}return Du(e,t),e.prototype.compute=function(t){return t.sign()},e}(Ui),Wu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),zu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Tan",a)||this}return Wu(e,t),e.prototype.compute=function(t){return t.tan()},e}(Ui),Lu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Atan",a)||this}return Wu(e,t),e.prototype.compute=function(t){return t.atan()},e}(Ui),Fu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"TanH",a)||this}return Wu(e,t),e.prototype.compute=function(t){return t.tanh()},e}(Ui),Nu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ATanH",a)||this}return Wu(e,t),e.prototype.compute=function(t){return t.atanh()},e}(Ui),qu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Cos",a)||this}return qu(e,t),e.prototype.compute=function(t){return t.cos()},e}(Ui),Ju=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Acos",a)||this}return qu(e,t),e.prototype.compute=function(t){return t.acos()},e}(Ui),Ku=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Cosh",a)||this}return qu(e,t),e.prototype.compute=function(t){return t.cosh()},e}(Ui),Yu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"AcosH",a)||this}return qu(e,t),e.prototype.compute=function(t){return t.acosh()},e}(Ui),Qu=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zu=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Sin",a)||this}return Qu(e,t),e.prototype.compute=function(t){return t.sin()},e}(Ui),$u=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Asin",a)||this}return Qu(e,t),e.prototype.compute=function(t){return t.asin()},e}(Ui),ts=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Sinh",a)||this}return Qu(e,t),e.prototype.compute=function(t){return t.sinh()},e}(Ui),es=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Asinh",a)||this}return Qu(e,t),e.prototype.compute=function(t){return t.asinh()},e}(Ui),ns=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),rs=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Sigmoid",a)||this}return ns(e,t),e.prototype.compute=function(t){return t.sigmoid()},e}(Ui),os=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),is=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceMin",a)||this}return os(e,t),e.prototype.calc=function(t){return t.min(this.axes,this.keepDims)},e}(Xa),as=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),us=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceProd",a)||this}return as(e,t),e.prototype.calc=function(t){return t.product(this.axes,this.keepDims)},e}(Xa),ss=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ps=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceLogSum",a)||this}return ss(e,t),e.prototype.calc=function(t){return t.reduceLogSum(this.axes,this.keepDims)},e}(Xa),cs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ls=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceLogSumExp",a)||this}return cs(e,t),e.prototype.calc=function(t){return t.reduceLogSumExp(this.axes,this.keepDims)},e}(Xa),hs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fs=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceL2",a)||this}return hs(e,t),e.prototype.calc=function(t){var e=t.sumSquare(this.axes,this.keepDims),n=e.sqrt();return e.delete(),n},e}(Xa),ds=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ys=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"ReduceL1",a)||this}return ds(e,t),e.prototype.calc=function(t){var e=t.abs(),n=e.sum(this.axes,this.keepDims);return e.delete(),n},e}(Xa),ms=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vs=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Pow",a)||this}return ms(e,t),e.prototype.compute=function(t,e){return t.power(e)},e}(Si),ws=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gs=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Identity",a)||this}return ws(e,t),e.prototype.compute=function(t){return t.copy()},e}(Ui),bs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_s=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,"HardSigmoid",a)||this;return u.alpha=u.getAttributeFloat("alpha")||.2,u.beta=u.getAttributeFloat("beta")||.5,u}return bs(e,t),e.prototype.compute=function(t){return t.hardSigmoid(this.alpha,this.beta)},e}(Ui),xs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Os=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Neg",a)||this}return xs(e,t),e.prototype.compute=function(t){return t.negate()},e}(Ui),ks=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ss=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Reciprocal",a)||this}return ks(e,t),e.prototype.compute=function(t){return t.powerScalar(-1,1)},e}(Ui),As=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ps=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},js=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ms=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return As(e,t),e.prototype.forward=function(t){return Ps(this,void 0,void 0,(function(){return js(this,(function(e){return[2,[t[0].squeeze()]]}))}))},e.prototype.getType=function(){return"Squeeze"},e.prototype.delete=function(){},e}(ei),Ts=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Is=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Cs=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Gs=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return Ts(e,t),e.prototype.forward=function(t){return Is(this,void 0,void 0,(function(){var e,n,r;return Cs(this,(function(o){return e=t[0],n=e.getShape(),r=O(n),[2,[new Q([1],[r],"uint32")]]}))}))},e.prototype.getType=function(){return"Size"},e.prototype.delete=function(){},e}(ei),Vs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Es=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Rs=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Xs=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.alpha=u.getAttributeFloat("alpha")||.01,u}return Vs(e,t),e.prototype.forward=function(t){return Es(this,void 0,void 0,(function(){var e,n,r,o;return Rs(this,(function(i){return e=t[0],n=e.clip(void 0,0),r=e.clip(0,void 0),o=n.add(r,this.alpha),n.delete(),r.delete(),[2,[o]]}))}))},e.prototype.delete=function(){},e.prototype.getType=function(){return"LeakyRelu"},e}(ei),Bs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ds=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Us=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ws=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.alpha=u.getAttributeFloat("alpha")||1,u}return Bs(e,t),e.prototype.forward=function(t){return Ds(this,void 0,void 0,(function(){var e,n,r,o,i,a;return Us(this,(function(u){return e=t[0],n=e.clip(void 0,0),r=e.clip(0,void 0),o=n.exp(),n.delete(),i=o.addMultiplyScalar(this.alpha,-this.alpha),o.delete(),a=i.add(r),i.delete(),r.delete(),[2,[a]]}))}))},e.prototype.delete=function(){},e.prototype.getType=function(){return"Elu"},e}(ei),zs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ls=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Fs=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ns=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return zs(e,t),e.prototype.forward=function(t){return Ls(this,void 0,void 0,(function(){var e,n,r,o,i,a;return Fs(this,(function(u){return e=t[0],n=t[1],r=e.clip(void 0,0),o=e.clip(0,void 0),i=r.multiply(n),r.delete(),a=i.add(o),i.delete(),o.delete(),[2,[a]]}))}))},e.prototype.delete=function(){},e.prototype.getType=function(){return"PRElu"},e}(ei),qs=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hs=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Js=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ks=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.alpha=u.getAttributeFloat("alpha")||1.6732631921768188,u.gamma=u.getAttributeFloat("gamma")||1.0507010221481323,u}return qs(e,t),e.prototype.forward=function(t){return Hs(this,void 0,void 0,(function(){var e,n,r,o,i,a;return Js(this,(function(u){return e=t[0],n=e.clip(void 0,0),r=e.clip(0,void 0),o=n.exp(),n.delete(),i=o.addMultiplyScalar(this.gamma*this.alpha,-this.alpha*this.gamma),o.delete(),a=i.add(r,1,this.gamma),i.delete(),r.delete(),[2,[a]]}))}))},e.prototype.delete=function(){},e.prototype.getType=function(){return"Selu"},e}(ei),Ys=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qs=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Zs=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},$s=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this,s=u.getAttributeInt("axis");return null!==s&&(u.axis=s),u}return Ys(e,t),e.prototype.forward=function(t){return Qs(this,void 0,void 0,(function(){return Zs(this,(function(e){return[2,[t[0].flatten(this.axis)]]}))}))},e.prototype.getType=function(){return"Flatten"},e.prototype.delete=function(){},e}(ei),tp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ep=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},np=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},rp=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return tp(e,t),e.prototype.forward=function(t){return ep(this,void 0,void 0,(function(){var e,n,r,o;return np(this,(function(i){return e=t[0],n=e.exp(),r=n.addScalar(1),n.delete(),o=r.log(),r.delete(),[2,[o]]}))}))},e.prototype.getType=function(){return"Softplus"},e.prototype.delete=function(){},e}(ei),op=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ip=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},ap=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},up=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return op(e,t),e.prototype.forward=function(t){return ip(this,void 0,void 0,(function(){var e,n,r,o;return ap(this,(function(i){return e=t[0],n=e.abs(),r=n.addScalar(1),n.delete(),o=e.divide(r),r.delete(),[2,[o]]}))}))},e.prototype.getType=function(){return"Softsign"},e.prototype.delete=function(){},e}(ei),sp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pp=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},cp=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},lp=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return sp(e,t),e.prototype.forward=function(t){return pp(this,void 0,void 0,(function(){var e,n,r;return cp(this,(function(o){for(t.length,e=t[0],n=1;n<t.length;n++)r=e.add(t[n]),n>1&&e.delete(),e=r;return[2,[e]]}))}))},e.prototype.getType=function(){return"Sum"},e.prototype.delete=function(){},e}(ei),hp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fp=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},dp=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},yp=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,a)||this}return hp(e,t),e.prototype.forward=function(t){return fp(this,void 0,void 0,(function(){var e,n,r,o;return dp(this,(function(i){for(t.length,e=t[0],n=1;n<t.length;n++)r=e.add(t[n]),n>1&&e.delete(),e=r;return o=e.multiplyScalar(1/t.length),t.length>2&&e.delete(),[2,[o]]}))}))},e.prototype.getType=function(){return"Mean"},e.prototype.delete=function(){},e}(ei),mp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vp=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},wp=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},gp=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.alpha=u.getAttributeFloat("alpha")||1,u}return mp(e,t),e.prototype.forward=function(t){return vp(this,void 0,void 0,(function(){var e,n,r,o,i,a,u;return wp(this,(function(s){return e=t[0],n=e.clip(void 0,0),r=e.clip(0,void 0),o=n.multiplyScalar(1/this.alpha),n.delete(),i=o.exp(),o.delete(),a=i.addMultiplyScalar(this.alpha,-this.alpha),i.delete(),u=a.add(r),a.delete(),r.delete(),[2,[u]]}))}))},e.prototype.delete=function(){},e.prototype.getType=function(){return"Celu"},e}(ei),bp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_p=function(t){function e(e,n,r,o,i,a){return t.call(this,e,n,r,o,i,"Round",a)||this}return bp(e,t),e.prototype.compute=function(t){return t.round()},e}(Ui),xp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Op=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},kp=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Sp=function(t){function e(e,n,r,o,i,a){var u=t.call(this,e,n,r,o,i,a)||this;return u.backend="CPU",u}return xp(e,t),e.prototype.forward=function(t){return Op(this,void 0,void 0,(function(){var e,n,r,o,i,a;return kp(this,(function(u){switch(u.label){case 0:return e=t[0],n=t[1],r=t[2],[4,this.toValues(e)];case 1:return o=u.sent()[0],[4,this.toValues(n)];case 2:return i=u.sent()[0],[4,this.toValues(r)];case 3:return a=u.sent()[0],"CPU"===this.backend?[2,[Q.range(o,i,a)]]:"WASM"===this.backend?[2,[qr.range(o,i,a)]]:[2,[In.range(o,i,a)]]}}))}))},e.prototype.delete=function(){},e.prototype.getType=function(){return"Range"},e.prototype.toCPU=function(){return Op(this,void 0,void 0,(function(){return kp(this,(function(t){return this.backend="CPU",[2]}))}))},e.prototype.toWASM=function(){return Op(this,void 0,void 0,(function(){return kp(this,(function(t){return this.backend="WASM",[2]}))}))},e.prototype.toGPU=function(){return Op(this,void 0,void 0,(function(){return kp(this,(function(t){return this.backend="GPU",[2]}))}))},e}(ei),Ap={Conv:function(t,e,n,r,o,i){return new ci(t,e,n,r,o,i)},BatchNormalization:function(t,e,n,r,o,i){return new Ci(t,e,n,r,o,i)},Clip:function(t,e,n,r,o,i){return new qi(t,e,n,r,o,i)},Add:function(t,e,n,r,o,i){return new Pi(t,e,n,r,o,i)},Pow:function(t,e,n,r,o,i){return new vs(t,e,n,r,o,i)},ReduceMean:function(t,e,n,r,o,i){return new Wa(t,e,n,r,o,i)},Gemm:function(t,e,n,r,o,i){return new wa(t,e,n,r,o,i)},Constant:function(t,e,n,r,o,i){return new ai(t,e,n,r,o,i)},Reshape:function(t,e,n,r,o,i){return new Qa(t,e,n,r,o,i)},Range:function(t,e,n,r,o,i){return new Sp(t,e,n,r,o,i)},Flatten:function(t,e,n,r,o,i){return new $s(t,e,n,r,o,i)},Tile:function(t,e,n,r,o,i){return new mu(t,e,n,r,o,i)},MatMul:function(t,e,n,r,o,i){return new Pa(t,e,n,r,o,i)},Exp:function(t,e,n,r,o,i){return new oa(t,e,n,r,o,i)},Log:function(t,e,n,r,o,i){return new Ru(t,e,n,r,o,i)},Sqrt:function(t,e,n,r,o,i){return new Bu(t,e,n,r,o,i)},Sign:function(t,e,n,r,o,i){return new Uu(t,e,n,r,o,i)},ReduceSum:function(t,e,n,r,o,i){return new La(t,e,n,r,o,i)},ReduceProd:function(t,e,n,r,o,i){return new us(t,e,n,r,o,i)},ReduceMax:function(t,e,n,r,o,i){return new Da(t,e,n,r,o,i)},ReduceMin:function(t,e,n,r,o,i){return new is(t,e,n,r,o,i)},ReduceSumSquare:function(t,e,n,r,o,i){return new Na(t,e,n,r,o,i)},ReduceL2:function(t,e,n,r,o,i){return new fs(t,e,n,r,o,i)},ReduceL1:function(t,e,n,r,o,i){return new ys(t,e,n,r,o,i)},ReduceLogSum:function(t,e,n,r,o,i){return new ps(t,e,n,r,o,i)},ReduceLogSumExp:function(t,e,n,r,o,i){return new ls(t,e,n,r,o,i)},Sub:function(t,e,n,r,o,i){return new hu(t,e,n,r,o,i)},Mul:function(t,e,n,r,o,i){return new Ma(t,e,n,r,o,i)},Div:function(t,e,n,r,o,i){return new na(t,e,n,r,o,i)},Unsqueeze:function(t,e,n,r,o,i){return new ku(t,e,n,r,o,i)},Concat:function(t,e,n,r,o,i){return new Yi(t,e,n,r,o,i)},Sum:function(t,e,n,r,o,i){return new lp(t,e,n,r,o,i)},Mean:function(t,e,n,r,o,i){return new yp(t,e,n,r,o,i)},ConstantOfShape:function(t,e,n,r,o,i){return new ta(t,e,n,r,o,i)},Expand:function(t,e,n,r,o,i){return new sa(t,e,n,r,o,i)},Squeeze:function(t,e,n,r,o,i){return new Ms(t,e,n,r,o,i)},InstanceNormalization:function(t,e,n,r,o,i){return new Oa(t,e,n,r,o,i)},Pad:function(t,e,n,r,o,i){return new Ga(t,e,n,r,o,i)},Relu:function(t,e,n,r,o,i){return new Ha(t,e,n,r,o,i)},LeakyRelu:function(t,e,n,r,o,i){return new Xs(t,e,n,r,o,i)},Elu:function(t,e,n,r,o,i){return new Ws(t,e,n,r,o,i)},PRelu:function(t,e,n,r,o,i){return new Ns(t,e,n,r,o,i)},Selu:function(t,e,n,r,o,i){return new Ks(t,e,n,r,o,i)},Celu:function(t,e,n,r,o,i){return new gp(t,e,n,r,o,i)},Shape:function(t,e,n,r,o,i){return new nu(t,e,n,r,o,i)},Size:function(t,e,n,r,o,i){return new Gs(t,e,n,r,o,i)},Gather:function(t,e,n,r,o,i){return new da(t,e,n,r,o,i)},Cast:function(t,e,n,r,o,i){return new Ri(t,e,n,r,o,i)},Floor:function(t,e,n,r,o,i){return new ca(t,e,n,r,o,i)},Ceil:function(t,e,n,r,o,i){return new zi(t,e,n,r,o,i)},Round:function(t,e,n,r,o,i){return new _p(t,e,n,r,o,i)},Abs:function(t,e,n,r,o,i){return new Vu(t,e,n,r,o,i)},Neg:function(t,e,n,r,o,i){return new Os(t,e,n,r,o,i)},Reciprocal:function(t,e,n,r,o,i){return new Ss(t,e,n,r,o,i)},Identity:function(t,e,n,r,o,i){return new gs(t,e,n,r,o,i)},Sigmoid:function(t,e,n,r,o,i){return new rs(t,e,n,r,o,i)},HardSigmoid:function(t,e,n,r,o,i){return new _s(t,e,n,r,o,i)},Sin:function(t,e,n,r,o,i){return new Zu(t,e,n,r,o,i)},Cos:function(t,e,n,r,o,i){return new Hu(t,e,n,r,o,i)},Tan:function(t,e,n,r,o,i){return new zu(t,e,n,r,o,i)},Asin:function(t,e,n,r,o,i){return new $u(t,e,n,r,o,i)},Acos:function(t,e,n,r,o,i){return new Ju(t,e,n,r,o,i)},Atan:function(t,e,n,r,o,i){return new Lu(t,e,n,r,o,i)},Sinh:function(t,e,n,r,o,i){return new ts(t,e,n,r,o,i)},Cosh:function(t,e,n,r,o,i){return new Ku(t,e,n,r,o,i)},Tanh:function(t,e,n,r,o,i){return new Fu(t,e,n,r,o,i)},Asinh:function(t,e,n,r,o,i){return new es(t,e,n,r,o,i)},Acosh:function(t,e,n,r,o,i){return new Yu(t,e,n,r,o,i)},Atanh:function(t,e,n,r,o,i){return new Nu(t,e,n,r,o,i)},Slice:function(t,e,n,r,o,i){return new au(t,e,n,r,o,i)},Upsample:function(t,e,n,r,o,i){return new ju(t,e,n,r,o,i)},Transpose:function(t,e,n,r,o,i){return new bu(t,e,n,r,o,i)},Softmax:function(t,e,n,r,o,i){return new cu(t,e,n,r,o,i)},Softplus:function(t,e,n,r,o,i){return new rp(t,e,n,r,o,i)},Softsign:function(t,e,n,r,o,i){return new up(t,e,n,r,o,i)},GlobalAveragePool:function(t,e,n,r,o,i){return new Cu(t,e,n,r,o,i)}},Pp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jp=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Mp=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Tp=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Ip=function(t){function e(e,n){var r,o=t.call(this)||this;o.inputSet=new Set,o.nodes={},o.nodeIds=[],o.defaultReady=[],o.intermediaries={},o.constants={},o.nodeIdCounter=1e4,void 0===n&&(n={}),o.noConvertConstants=new Set(void 0!==n.noConvertConstants?n.noConvertConstants:[]),o.noConvertNodes=new Set(void 0!==n.noConvertNodes?n.noConvertNodes:[]),o.mode=n.mode||"inference",o.precision=n.precision||32,r=e instanceof ArrayBuffer?new Uint8Array(e):e,o.modelProto=Jo.onnx.ModelProto.decode(r);var i=o.modelProto.opsetImport[0].version;Ho.a.isLong(i)&&(i=i.toNumber()),o.version=i,o.inputs=o.modelProto.graph.input;for(var a=0;a<o.inputs.length;a++)o.inputSet.add(o.inputs[a].name);return o.outputs=o.modelProto.graph.output.map((function(t){return t.name})),o.initializer(o.modelProto.graph.initializer),o.initNodes(o.modelProto),o}return Pp(e,t),e.prototype.initNodes=function(t){for(var e=this,n=0;n<t.graph.node.length;n++){var r=t.graph.node[n],o=Ap[r.opType];if(void 0===o)throw new Error("Node operator "+r.opType+" can not be resolved");var i=r.attribute||[],a=r.input||[],u=o(i,a,r.output||[],this.constants,this.version,this.mode);this.nodes[n]=u,this.nodeIds.push(n);for(var s=0;s<a.length;s++){var p=a[s];void 0===this.intermediaries[p]&&(this.intermediaries[p]={to:[],deletable:!0}),this.intermediaries[p].to.push(n)}0===u.variableInputs&&this.defaultReady.push(n),"Constant"===r.opType&&(void 0===this.intermediaries[r.output[0]]?this.intermediaries[r.output[0]]={to:[],deletable:!1}:this.intermediaries[r.output[0]].deletable=!1)}for(var c=0,l=this.nodeIds;c<l.length;c++){var h=l[c];this.nodes[h].initialize((function(t){return e.resolveConstant(t)}))}},e.prototype.initializer=function(t){for(var e=0;e<t.length;e++){var n=t[e],r=ni(n,16===this.precision);"train"===this.mode&&(r=new Uo(r)),this.constants[n.name]=r}},e.prototype.forward=function(t,e){return jp(this,void 0,void 0,(function(){var n,r,o,i,a,u,s,p,c,l,h,f,d,y,m=this;return Mp(this,(function(v){switch(v.label){case 0:for(n={},r={},o=0,i=this.nodeIds;o<i.length;o++)y=i[o],r[y]={variableInputs:0};a=Tp(this.defaultReady),this.initializeForward(t,n,r,a),v.label=1;case 1:if(!(a.length>0))return[3,8];u=a.shift(),s=this.nodes[u],p=this.getInputsToNode(s,n),c=p.inputs,l=p.toDelete,h=void 0,v.label=2;case 2:return v.trys.push([2,4,,5]),[4,s.forward(c)];case 3:return h=v.sent(),[3,5];case 4:throw f=v.sent(),console.error("Error occurred in node "+u+" with inputs "+s.inputs+" from nodes "+s.inputs.map((function(t){return m.getNodeWithOutput(t)}))),f;case 5:for(ot.flush(),this.propagateResults(s,n,h,r,a),y=0;y<l.length;y++)this.inputSet.has(l[y])||(n[l[y]].value.delete(),delete n[l[y]]);return void 0===e?[3,7]:[4,new Promise((function(t){setTimeout(t,e)}))];case 6:v.sent(),v.label=7;case 7:return[3,1];case 8:for(d=[],y=0;y<this.outputs.length;y++)d.push(n[this.outputs[y]].value);return[2,d]}}))}))},e.prototype.initializeForward=function(t,e,n,r){for(var o=0;o<t.length;o++){e[this.inputs[o].name]={value:t[o],used:0};for(var i=this.intermediaries[this.inputs[o].name],a=0;a<i.to.length;a++){var u=i.to[a];n[u].variableInputs++,n[u].variableInputs===this.nodes[u].variableInputs&&(r.push(u),delete n[u])}}},e.prototype.getInputsToNode=function(t,e){for(var n=[],r=[],o=0;o<t.inputs.length;o++){var i=t.inputs[o];if(void 0!==this.constants[i])n.push(this.constants[i]);else{var a=e[i];a.used++,a.used>=this.intermediaries[i].to.length&&this.intermediaries[i].deletable&&r.push(i),n.push(a.value)}}return{inputs:n,toDelete:r}},e.prototype.propagateResults=function(t,e,n,r,o){for(var i=0;i<t.outputs.length;i++){var a=t.outputs[i];e[a]={value:n[i],used:0};var u=this.intermediaries[a];if(void 0!==u)for(var s=0;s<u.to.length;s++){var p=u.to[s];r[p].variableInputs++,r[p].variableInputs===this.nodes[p].variableInputs&&(o.push(p),delete r[p])}}},e.prototype.toCPU=function(){return jp(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return Mp(this,(function(s){switch(s.label){case 0:for(e in t=[],this.constants)t.push(e);n=0,s.label=1;case 1:return n<t.length?(u=t[n],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,Lo(this.constants[u])])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return n++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toCPU()]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},e.prototype.toWASM=function(){return jp(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return Mp(this,(function(s){switch(s.label){case 0:for(e in t=[],this.constants)t.push(e);n=0,s.label=1;case 1:return n<t.length?(u=t[n],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,Fo(this.constants[u])])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return n++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toWASM()]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},e.prototype.toGPU=function(){return jp(this,void 0,void 0,(function(){var t,e,n,r,o,i,a,u;return Mp(this,(function(s){switch(s.label){case 0:for(e in t=[],this.constants)t.push(e);n=0,s.label=1;case 1:return n<t.length?(u=t[n],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,No(this.constants[u])])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return n++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toGPU()]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},e.prototype.optimize=function(){for(var t=this,e=0,n=_i;e<n.length;e++)for(var r=n[e],o=0,i=r.findApplications(this);o<i.length;o++){for(var a=i[o],u=a.map((function(e){return t.nodes[e]})),s=r.apply(u,(function(e){return t.resolveConstant(e)}),this.constants,this.version),p=new Set(s.outputs),c=0,l=a;c<l.length;c++){var h=l[c];this.removeNode(h,p)}this.insertNode(s)}this.prune()},e.prototype.prune=function(t){for(var e=this;;){var n=this.pruneIntermediaries(t);if(t=[],!(n.size>0))break;n.forEach((function(n){var r=e.removeNode(n,new Set);t=null===t||void 0===t?void 0:t.concat(r)}))}},e.prototype.pruneIntermediaries=function(t){var e=new Set;void 0===t&&(t=[]);for(var n=0;n<t.length;n++){var r=t[n],o=this.getNodeWithOutput(r);void 0!==o&&e.add(o);var i=this.getNodeWithInput(r);void 0!==i&&e.add(i)}var a=function(n){if(0===u.intermediaries[n].to.length&&void 0===u.outputs.find((function(t){return t===n}))){t.push(n);var r=u.getNodeWithOutput(n);void 0!==r&&e.add(r);var o=u.getNodeWithInput(n);void 0!==o&&e.add(o)}},u=this;for(var r in this.intermediaries)a(r);for(var s=0,p=t;s<p.length;s++){r=p[s];delete this.intermediaries[r]}return e},e.prototype.removeNode=function(t,e){for(var n=this.nodes[t],r=0,o=n.inputs;r<o.length;r++){var i=o[r];void 0!==this.intermediaries[i]&&(this.intermediaries[i].to=this.intermediaries[i].to.filter((function(e){return e.toString()!==t.toString()})))}var a=[];return e.has(n.outputs[0])||a.push(n.outputs[0]),this.nodeIds=this.nodeIds.filter((function(e){return e.toString()!==t.toString()})),this.nodes[t].delete(),delete this.nodes[t],this.defaultReady=this.defaultReady.filter((function(e){return e!==t})),a},e.prototype.insertNode=function(t){var e=this.nodeIdCounter++;this.nodeIds.push(e),this.nodes[e]=t;for(var n=0,r=t.inputs;n<r.length;n++){var o=r[n];this.intermediaries[o].to.push(e)}},e.prototype.getNodeWithOutput=function(t){for(var e=0,n=this.nodeIds;e<n.length;e++){var r=n[e];if(-1!==this.nodes[r].outputs.findIndex((function(e){return e===t})))return r}},e.prototype.getNodeWithInput=function(t){for(var e=0,n=this.nodeIds;e<n.length;e++){var r=n[e];if(-1!==this.nodes[r].inputs.findIndex((function(e){return e===t})))return r}},e.prototype.resolveConstant=function(t){if(void 0!==this.constants[t])return this.constants[t];var e=this.getNodeWithOutput(t),n=this.nodes[e];return n instanceof ai?n.tensor:void 0},e.prototype.getNodes=function(){return this.nodes},e.prototype.delete=function(){for(var t in this.constants)this.constants[t].delete();for(var e=0,n=this.nodeIds;e<n.length;e++){var r=n[e];this.nodes[r].delete()}},e.prototype.getSubModules=function(){for(var e=t.prototype.getSubModules.call(this),n=0,r=this.nodeIds;n<r.length;n++){var o=r[n];e.push(this.nodes[o])}return e},e.prototype.getParameters=function(){var e=t.prototype.getParameters.call(this);for(var n in this.constants)this.constants[n]instanceof Uo&&e.push(this.constants[n]);return e},e}(Qo),Cp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gp=function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(e){i(e)}}function u(t){try{s(r.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((r=r.apply(t,e||[])).next())}))},Vp=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ep=(function(t){function e(e,n,r){var o=t.call(this)||this;r=void 0===r||r;var i=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=1);for(var r=[],o=0;o<t;o+=2){var i=rt(),a=i[0],u=i[1];r.push(a*n+e),o<t-1&&r.push(u*n+e)}return r}(e*n,0,2/(e+n)),a=new Q([e,n],i);if(o.weights=new Uo(a),r){var u=new Array(n).fill(0),s=new Q([1,n],u);o.bias=new Uo(s)}return o}Cp(e,t),e.prototype.forward=function(t){return Gp(this,void 0,void 0,(function(){return Vp(this,(function(e){return[2,[t[0].gemm(this.weights,!1,!1,1,this.bias)]]}))}))}}(Qo),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Cp(e,t),e.prototype.forward=function(t){return Gp(this,void 0,void 0,(function(){return Vp(this,(function(e){return[2,[t[0].clip(0)]]}))}))}}(Qo),function(t){function e(e){var n=t.call(this)||this;return n.modules=e,n}Cp(e,t),e.prototype.forward=function(t){return Gp(this,void 0,void 0,(function(){var e,n,r,o;return Vp(this,(function(i){switch(i.label){case 0:e=t,n=0,i.label=1;case 1:return n<this.modules.length?(r=e,[4,this.modules[n].forward(e)]):[3,4];case 2:if(e=i.sent(),"inference"===this.mode&&n>0)for(o=0;o<r.length;o++)r[o].delete();i.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},e.prototype.getSubModules=function(){return t.prototype.getSubModules.call(this).concat(this.modules)}}(Qo),function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n.modules=e,n}Cp(e,t),e.prototype.forward=function(t){return Gp(this,void 0,void 0,(function(){return Vp(this,(function(t){throw new Error("Module dict does not support forward")}))}))},e.prototype.getSubModules=function(){var t=[];for(var e in this.modules)t.push(this.modules[e]);return t},e.prototype.get=function(t){return this.modules[t]},e.prototype.set=function(t,e){this.modules[t]=e}}(Qo),function(t){function e(e){void 0===e&&(e=[]);var n=t.call(this)||this;return n.modules=e,n}Cp(e,t),e.prototype.forward=function(t){return Gp(this,void 0,void 0,(function(){return Vp(this,(function(t){throw new Error("Module list does not support forward")}))}))},e.prototype.getSubModules=function(){return this.modules},e.prototype.get=function(t){return this.modules[t]},e.prototype.set=function(t,e){this.modules[t]=e},e.prototype.push=function(t){this.modules.push(t)},e.prototype.pop=function(){return this.modules.pop()}}(Qo),function(){function t(t){this.model=t,this.parameters=t.getParameters()}return t.prototype.zeroGrads=function(){for(var t=0,e=this.parameters;t<e.length;t++){var n=e[t];void 0!==n.grad&&(n.grad.delete(),n.grad=void 0)}},t}()),Rp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xp=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o}return Rp(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("beta1")+" float beta1;\n    "+this.getVarModifier("beta2")+" float beta2;\n    "+this.getVarModifier("t")+" int t;\n    "},e.prototype.getFragmentShader=function(t){return"\n    void main() {\n      initVars();\n\n      int pos = coordinateToPos(uv, widthOutput, heightOutput);\n\n      float m1 = getValueAtPos(pos, widthMoments, heightMoments, Moments);\n      float m2 = getValueAtPos(pos+2, widthMoments, heightMoments, Moments);\n      float grad = getValueAtPos(pos/4, widthGrad, heightGrad, Grad);\n\n      m1 = beta1*m1 + (1.0-beta1)*grad;\n      m2 = beta2*m2 + (1.0-beta2)*grad*grad;\n\n      float m1Corr = m1/(1.0-pow(beta1, float(t)));\n      float m2Corr = m2/(1.0-pow(beta2, float(t)));\n\n      gl_FragColor = vec4(m1,m1Corr,m2,m2Corr);\n    }\n    "},e.prototype.getTextureNames=function(){return["Grad","Moments"]},e.prototype.getUniformAttrs=function(){return[{name:"beta1",type:"float"},{name:"beta2",type:"float"},{name:"t",type:"int"}]},e.prototype.calc=function(t){return this.compute(t.Moments.shape,{Grad:t.Grad,Moments:t.Moments},{beta1:t.beta1,beta2:t.beta2,t:t.t})},e.prototype.getOutputShape=function(t){return t.Moments.shape},e.prototype.compile=function(e){void 0!==e.shapeMoments&&(this.maxRank=e.shapeMoments.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeGrad:t.Grad.shape,widthGrad:t.Grad.memory.width,heightGrad:t.Grad.memory.height,shapeMoments:t.Moments.shape,widthMoments:t.Moments.memory.width,heightMoments:t.Moments.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,beta1:t.beta1,beta2:t.beta2}},e.prototype.getInputInfoString=function(t){return t.Grad.shape+"-"+t.Moments.shape+"-"+t.beta1+"-"+t.beta2},e}(lt),Bp=new Le((function(t){return new Xp(Cn,t)})),Dp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Up=function(t){function e(e,n,r){var o=t.call(this,e,n,r)||this;return o.maxIterations=1e6,o}return Dp(e,t),e.prototype.getVariables=function(){return"\n    "+this.getVarModifier("alpha")+" float alpha;\n    "+this.getVarModifier("epsilon")+" float epsilon;\n    "},e.prototype.getFragmentShader=function(t){return"\n    float newVal(float m1Corr, float m2Corr, float value) {\n      return value - alpha*(m1Corr/(sqrt(m2Corr)+epsilon));\n    }\n\n    void main() {\n      initVars();\n\n      int pos = coordinateToPos(uv, widthOutput, heightOutput);\n\n      vec4 result = vec4(0,0,0,0);\n\n      float m1Corr = getValueAtPos(pos*4+1, widthMoments, heightMoments, Moments);\n      float m2Corr = getValueAtPos(pos*4+3, widthMoments, heightMoments, Moments);\n      float value = getValueAtPos(pos, widthValue, heightValue, Value);\n      result.r = newVal(m1Corr, m2Corr, value);\n\n      pos++;\n      m1Corr = getValueAtPos(pos*4+1, widthMoments, heightMoments, Moments);\n      m2Corr = getValueAtPos(pos*4+3, widthMoments, heightMoments, Moments);\n      value = getValueAtPos(pos, widthValue, heightValue, Value);\n      result.g = newVal(m1Corr, m2Corr, value);\n\n      pos++;\n      m1Corr = getValueAtPos(pos*4+1, widthMoments, heightMoments, Moments);\n      m2Corr = getValueAtPos(pos*4+3, widthMoments, heightMoments, Moments);\n      value = getValueAtPos(pos, widthValue, heightValue, Value);\n      result.b = newVal(m1Corr, m2Corr, value);\n\n      pos++;\n      m1Corr = getValueAtPos(pos*4+1, widthMoments, heightMoments, Moments);\n      m2Corr = getValueAtPos(pos*4+3, widthMoments, heightMoments, Moments);\n      value = getValueAtPos(pos, widthValue, heightValue, Value);\n      result.a = newVal(m1Corr, m2Corr, value);\n\n\n      gl_FragColor = result;\n    }\n    "},e.prototype.getTextureNames=function(){return["Value","Moments"]},e.prototype.getUniformAttrs=function(){return[{name:"alpha",type:"float"},{name:"epsilon",type:"float"}]},e.prototype.calc=function(t){return this.compute(t.Value.shape,{Value:t.Value,Moments:t.Moments},{alpha:t.alpha,epsilon:t.epsilon})},e.prototype.getOutputShape=function(t){return t.Value.shape},e.prototype.compile=function(e){void 0!==e.shapeMoments&&(this.maxRank=e.shapeMoments.length),t.prototype.compile.call(this,e)},e.prototype.getCompilationInfo=function(t){var e=this.getOutputShape(t),n=at.getAllocationDimensions(O(e),this.dtype);return{shapeValue:t.Value.shape,widthValue:t.Value.memory.width,heightValue:t.Value.memory.height,shapeMoments:t.Moments.shape,widthMoments:t.Moments.memory.width,heightMoments:t.Moments.memory.height,shapeOutput:e,widthOutput:n.width,heightOutput:n.height,alpha:t.alpha,epsilon:t.epsilon}},e.prototype.getInputInfoString=function(t){return t.Value.shape+"-"+t.Moments.shape+"-"+t.alpha+"-"+t.epsilon},e}(lt),Wp=new Le((function(t){return new Up(Cn,t)})),zp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lp=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Fp=(function(t){function e(e,n,r,o,i){void 0===n&&(n=.001),void 0===r&&(r=.9),void 0===o&&(o=.999),void 0===i&&(i=1e-7);var a=t.call(this,e)||this;a.lr=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.t=0;var u=a.parameters;if(u[0].value instanceof In){a.moments=new Array(u.length);for(var s=0;s<u.length;s++)a.moments[s]=new In(new Array(4*u[s].value.size).fill(0),Lp(u[s].getShape(),[4]),u[s].value.dtype)}else a.moment1=new Array(u.length).fill(void 0),a.moment2=new Array(u.length).fill(void 0);return a}zp(e,t),e.prototype.step=function(){if(this.t++,void 0!==this.moment1&&void 0!==this.moment2)for(var t=0;t<this.parameters.length;t++){if(void 0!==(a=this.parameters[t]).grad){var e=a.value,n=this.paramStep(a.value,a.grad,this.moment1[t],this.moment2[t]),r=n.newValue,o=n.moment1,i=n.moment2;a.value=r,this.moment1[t]=o,this.moment2[t]=i,e.delete()}}else if(void 0!==this.moments)for(t=0;t<this.parameters.length;t++){var a;if(void 0!==(a=this.parameters[t]).grad){e=a.value;var u=this.gpuParamStep(a.value,a.grad,this.moments[t]),s=(r=u.newValue,u.moments);a.value=r,this.moments[t]=s,e.delete()}}},e.prototype.updateMoments=function(t,e,n){var r,o;if(void 0===e)r=t.multiplyScalar(1-this.beta1);else{var i=e;r=e.add(t,this.beta1,1-this.beta1),i.delete()}if(void 0===n)o=t.multiply(t,1-this.beta2);else{var a=t.multiply(t),u=n;o=n.add(a,this.beta2,1-this.beta2),a.delete(),u.delete()}return{moment1New:r,moment2New:o}},e.prototype.getCorrectedMoments=function(t,e){return{correctMoment1:t.addMultiplyScalar(1/(1-Math.pow(this.beta1,this.t)),0),correctMoment2:e.addMultiplyScalar(1/(1-Math.pow(this.beta2,this.t)),0)}},e.prototype.paramStep=function(t,e,n,r){var o=this.updateMoments(e,n,r),i=o.moment1New,a=o.moment2New.addMultiplyScalar(1/(1-Math.pow(this.beta2,this.t)),this.epsilon),u=a.sqrt();a.delete();var s=i.divide(u,-this.lr/(1-Math.pow(this.beta1,this.t)));u.delete();var p=t.add(s);return s.delete(),{newValue:p,moment1:n,moment2:r}},e.prototype.gpuParamStep=function(t,e,n){var r=Bp.calc({Grad:e,Moments:n,beta1:this.beta1,beta2:this.beta2,t:this.t},t.dtype);return n.delete(),{newValue:Wp.calc({Value:t,Moments:r,alpha:this.lr,epsilon:this.epsilon},t.dtype),moments:r}}}(Ep),function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}());!function(t){function e(e,n){void 0===n&&(n=.001);var r=t.call(this,e)||this;return r.lr=n,r}Fp(e,t),e.prototype.step=function(){for(var t=0,e=this.parameters;t<e.length;t++){var n=e[t];if(void 0!==n.grad){var r=n.value;n.value=n.value.subtract(n.grad,1,this.lr),r.delete()}}}}(Ep);var Np=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qp=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Np(e,t),e.prototype.getOp=function(t,e){return e+" == 1.0 ? -1.0/"+t+" : 1.0/(1.0-"+t+")"},e}(St),Hp=new Le((function(t){return new qp(Cn,t)}));!function(){function t(t,e){this.x=t,this.y=e}t.prototype.backward=function(t){var e,n,r;if(t instanceof Q){var o=(n=this.x.value,r=this.y.value,R(n,r,(function(t,e){return 1===e?-1/t:1/(1-t)}),n.shape));e=t.multiply(o),o.delete()}else if(t instanceof qr){o=this.x.value.wasmTensor.bce_back(this.y.value.wasmTensor);e=new qr(t.wasmTensor.multiply(o,1),t.dtype),o.free()}else{o=Hp.calc({A:this.x.value,B:this.y.value,outputShape:this.x.getShape()},this.x.value.dtype);e=t.multiply(o),o.delete()}this.x.backward(e)||e.delete()},t.prototype.delete=function(){this.x.isLeaf()||this.x.delete(),this.y.isLeaf()||this.y.delete()}}();var Jp=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kp=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return Jp(e,t),e.prototype.getOp=function(t,e){return e+" == 1.0 ? -log("+t+") : -log(1.0-"+t+")"},e}(St);new Le((function(t){return new Kp(Cn,t)}));(function(){function t(t,e){this.model=t,this.gamma=e,this.parameters=t.getParameters()}t.prototype.getLoss=function(){for(var t=this.parameters[0].sumSquare(),e=this.gamma,n=1;n<this.parameters.length;n++)t=t.add(this.parameters[n].sumSquare(),e,this.gamma),e/=e;return t}})(),function(){function t(t,e){this.model=t,this.gamma=e,this.parameters=t.getParameters()}t.prototype.getLoss=function(){for(var t=this.parameters[0].abs().sum(),e=this.gamma,n=1;n<this.parameters.length;n++)t=t.add(this.parameters[n].abs().sum(),e,this.gamma),e/=e;return t}}();function Yp(){return(Yp=Object(w.a)(y.a.mark((function t(e){var n,r,o;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("models/".concat(e,".onnx"));case 2:return n=t.sent,t.next=5,n.arrayBuffer();case 5:return r=t.sent,o=new s.model.OnnxModel(r,{noConvertNodes:[69,98]}),t.next=9,o.toGPU();case 9:return t.abrupt("return",o);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Qp=["Tench","Goldfish","Great white shark","Tiger shark","Hammerhead","Electric ray","Stingray","Cock","Hen","Ostrich","Brambling","Goldfinch","House finch","Junco","Indigo bunting","Robin","Bulbul","Jay","Magpie","Chickadee","Water ouzel","Kite","Bald eagle","Vulture","Great grey owl","Europeafire salamander","Commonewt","Eft","Spotted salamander","Axolotl","Bullfrog","Tree frog","Tailed frog","Loggerhead","Leatherback turtle","Mud turtle","Terrapin","Box turtle","Banded gecko","Commoiguana","Americachameleon","Whiptail","Agama","Frilled lizard","Alligator lizard","Gila monster","Greelizard","Africachameleon","Komodo dragon","Africacrocodile","Americaalligator","Triceratops","Thunder snake","Ringneck snake","Hognose snake","Greesnake","King snake","Garter snake","Water snake","Vine snake","Night snake","Boa constrictor","Rock python","Indiacobra","Greemamba","Sea snake","Horned viper","Diamondback","Sidewinder","Trilobite","Harvestman","Scorpion","Black and gold gardespider","Barspider","Gardespider","Black widow","Tarantula","Wolf spider","Tick","Centipede","Black grouse","Ptarmigan","Ruffed grouse","Prairie chicken","Peacock","Quail","Partridge","Africagrey","Macaw","Sulphur-crested cockatoo","Lorikeet","Coucal","Bee eater","Hornbill","Hummingbird","Jacamar","Toucan","Drake","Red-breasted merganser","Goose","Black swan","Tusker","Echidna","Platypus","Wallaby","Koala","Wombat","Jellyfish","Sea anemone","Braicoral","Flatworm","Nematode","Conch","Snail","Slug","Sea slug","Chiton","Chambered nautilus","Dungeness crab","Rock crab","Fiddler crab","King crab","Americalobster","Spiny lobster","Crayfish","Hermit crab","Isopod","White stork","Black stork","Spoonbill","Flamingo","Little blue heron","Americaegret","Bittern","Crane","Limpkin","Europeagallinule","Americacoot","Bustard","Ruddy turnstone","Red-backed sandpiper","Redshank","Dowitcher","Oystercatcher","Pelican","King penguin","Albatross","Grey whale","Killer whale","Dugong","Sea lion","Chihuahua","Japanese spaniel","Maltese dog","Pekinese","Shih-Tzu","Blenheim spaniel","Papillon","Toy terrier","Rhodesiaridgeback","Afghahound","Basset","Beagle","Bloodhound","Bluetick","Black-and-tacoonhound","Walker hound","English foxhound","Redbone","Borzoi","Irish wolfhound","Italiagreyhound","Whippet","Ibizahound","Norwegiaelkhound","Otterhound","Saluki","Scottish deerhound","Weimaraner","Staffordshire bullterrier","AmericaStaffordshire terrier","Bedlingtoterrier","Border terrier","Kerry blue terrier","Irish terrier","Norfolk terrier","Norwich terrier","Yorkshire terrier","Wire-haired fox terrier","Lakeland terrier","Sealyham terrier","Airedale","Cairn","Australiaterrier","Dandie Dinmont","Bostobull","Miniature schnauzer","Giant schnauzer","Standard schnauzer","Scotch terrier","Tibetaterrier","Silky terrier","Soft-coated wheateterrier","West Highland white terrier","Lhasa","Flat-coated retriever","Curly-coated retriever","Golderetriever","Labrador retriever","Chesapeake Bay retriever","Germashort-haired pointer","Vizsla","English setter","Irish setter","Gordosetter","Brittany spaniel","Clumber","English springer","Welsh springer spaniel","Cocker spaniel","Sussex spaniel","Irish water spaniel","Kuvasz","Schipperke","Groenendael","Malinois","Briard","Kelpie","Komondor","Old English sheepdog","Shetland sheepdog","Collie","Border collie","Bouvier des Flandres","Rottweiler","Germashepherd","Doberman","Miniature pinscher","Greater Swiss Mountaidog","Bernese mountaidog","Appenzeller","EntleBucher","Boxer","Bull mastiff","Tibetamastiff","French bulldog","Great Dane","Saint Bernard","Eskimo dog","Malamute","Siberiahusky","Dalmatian","Affenpinscher","Basenji","Pug","Leonberg","Newfoundland","Great Pyrenees","Samoyed","Pomeranian","Chow","Keeshond","Brabancogriffon","Pembroke","Cardigan","Toy poodle","Miniature poodle","Standard poodle","Mexicahairless","Timber wolf","White wolf","Red wolf","Coyote","Dingo","Dhole","Africahunting dog","Hyena","Red fox","Kit fox","Arctic fox","Grey fox","Tabby","Tiger cat","Persiacat","Siamese cat","Egyptiacat","Cougar","Lynx","Leopard","Snow leopard","Jaguar","Lion","Tiger","Cheetah","Browbear","Americablack bear","Ice bear","Sloth bear","Mongoose","Meerkat","Tiger beetle","Ladybug","Ground beetle","Long-horned beetle","Leaf beetle","Dung beetle","Rhinoceros beetle","Weevil","Fly","Bee","Ant","Grasshopper","Cricket","Walking stick","Cockroach","Mantis","Cicada","Leafhopper","Lacewing","Dragonfly's darning needle","Damselfly","Admiral","Ringlet","Monarch","Cabbage butterfly","Sulphur butterfly","Lycaenid","Starfish","Sea urchin","Sea cucumber","Wood rabbit","Hare","Angora","Hamster","Porcupine","Fox squirrel","Marmot","Beaver","Guinea pig","Sorrel","Zebra","Hog","Wild boar","Warthog","Hippopotamus","Ox","Water buffalo","Bison","Ram","Bighorn","Ibex","Hartebeest","Impala","Gazelle","Arabiacamel","Llama","Weasel","Mink","Polecat","Black-footed ferret","Otter","Skunk","Badger","Armadillo","Three-toed sloth","Orangutan","Gorilla","Chimpanzee","Gibbon","Siamang","Guenon","Patas","Baboon","Macaque","Langur","Colobus","Proboscis monkey","Marmoset","Capuchin","Howler monkey","Titi","Spider monkey","Squirrel monkey","Madagascar cat","Indri","Indiaelephant","Africaelephant","Lesser panda","Giant panda","Barracouta","Eel","Coho","Rock beauty","Anemone fish","Sturgeon","Gar","Lionfish","Puffer","Abacus","Abaya","Academic gown's robe","Accordion","Acoustic guitar","Aircraft carrier","Airliner","Airship","Altar","Ambulance","Amphibian","Analog clock","Apiary","Apron","Ashcan","Assault rifle","Backpack","Bakery","Balance beam","Balloon","Ballpoint","Band Aid","Banjo","Bannister","Barbell","Barber chair","Barbershop","Barn","Barometer","Barrel","Barrow","Baseball","Basketball","Bassinet","Bassoon","Bathing cap","Bath towel","Bathtub","Beach wagon","Beacon","Beaker","Bearskin","Beer bottle","Beer glass","Bell cote","Bib","Bicycle-built-for-two","Bikini","Binder","Binoculars","Birdhouse","Boathouse","Bobsled","Bolo tie","Bonnet","Bookcase","Bookshop","Bottlecap","Bow","Bow tie","Brass","Brassiere","Breakwater","Breastplate","Broom","Bucket","Buckle","Bulletproof vest","Bullet train","Butcher shop","Cab","Caldron","Candle","Cannon","Canoe","Caopener","Cardigan","Car mirror","Carousel","Carpenter's kit","Carton","Car wheel","Cash machine","Cassette","Cassette player","Castle","Catamaran","CD player","Cello","Cellular telephone","Chain","Chainlink fence","Chaimail","Chaisaw","Chest","Chiffonier","Chime","China cabinet","Christmas stocking","Church","Cinema","Cleaver","Cliff dwelling","Cloak","Clog","Cocktail shaker","Coffee mug","Coffeepot","Coil","Combinatiolock","Computer keyboard","Confectionery","Container ship","Convertible","Corkscrew","Cornet","Cowboy boot","Cowboy hat","Cradle","Crane","Crash helmet","Crate","Crib","Crock Pot","Croquet ball","Crutch","Cuirass","Dam","Desk","Desktop computer","Dial telephone","Diaper","Digital clock","Digital watch","Dining table","Dishrag","Dishwasher","Disk brake","Dock","Dogsled","Dome","Doormat","Drilling platform","Drum","Drumstick","Dumbbell","Dutch oven","Electric fan","Electric guitar","Electric locomotive","Entertainment center","Envelope","Espresso maker","Face powder","Feather boa","File","Fireboat","Fire engine","Fire screen","Flagpole","Flute","Folding chair","Football helmet","Forklift","Fountain","Fountaipen","Four-poster","Freight car","French horn","Frying pan","Fur coat","Garbage truck","Gasmask","Gas pump","Goblet","Go-kart","Golf ball","Golfcart","Gondola","Gong","Gown","Grand piano","Greenhouse","Grille","Grocery store","Guillotine","Hair slide","Hair spray","Half track","Hammer","Hamper","Hand blower","Hand-held computer","Handkerchief","Hard disc","Harmonica","Harp","Harvester","Hatchet","Holster","Home theater","Honeycomb","Hook","Hoopskirt","Horizontal bar","Horse cart","Hourglass","IPod","Iron","Jack-o'-lantern","Jean","Jeep","Jersey","Jigsaw puzzle","Jinrikisha","Joystick","Kimono","Knee pad","Knot","Lab coat","Ladle","Lampshade","Laptop","Lawmower","Lens cap","Letter opener","Library","Lifeboat","Lighter","Limousine","Liner","Lipstick","Loafer","Lotion","Loudspeaker","Loupe's loupe","Lumbermill","Magnetic compass","Mailbag","Mailbox","Maillot","Maillot","Manhole cover","Maraca","Marimba","Mask","Matchstick","Maypole","Maze","Measuring cup","Medicine chest","Megalith","Microphone","Microwave","Military uniform","Milk can","Minibus","Miniskirt","Minivan","Missile","Mitten","Mixing bowl","Mobile home","Model T","Modem","Monastery","Monitor","Moped","Mortar","Mortarboard","Mosque","Mosquito net","Motor scooter","Mountaibike","Mountaitent","Mouse","Mousetrap","Moving van","Muzzle","Nail","Neck brace","Necklace","Nipple","Notebook","Obelisk","Oboe","Ocarina","Odometer","Oil filter","Organ","Oscilloscope","Overskirt","Oxcart","Oxygemask","Packet","Paddle","Paddlewheel","Padlock","Paintbrush","Pajama's","Palace","Panpipe","Paper towel","Parachute","Parallel bars","Park bench","Parking meter","Passenger car","Patio","Pay-phone","Pedestal","Pencil box","Pencil sharpener","Perfume","Petri dish","Photocopier","Pick","Pickelhaube","Picket fence","Pickup","Pier","Piggy bank","Pill bottle","Pillow","Ping-pong ball","Pinwheel","Pirate","Pitcher","Plane's plane","Planetarium","Plastic bag","Plate rack","Plow","Plunger's helper","Polaroid camera","Pole","Police van","Poncho","Pool table","Pop bottle","Pot","Potter's wheel","Power drill","Prayer rug","Printer","Prison","Projectile","Projector","Puck","Punching bag","Purse","Quill","Quilt","Racer","Racket","Radiator","Radio","Radio telescope","Raibarrel","Recreational vehicle.V.","Reel","Reflex camera","Refrigerator","Remote control","Restaurant","Revolver","Rifle","Rocking chair","Rotisserie","Rubber eraser","Rugby ball","Rule","Running shoe","Safe","Safety pin","Saltshaker","Sandal","Sarong","Sax","Scabbard","Scale","School bus","Schooner","Scoreboard","Screen","Screw","Screwdriver","Seat belt","Sewing machine","Shield","Shoe shop","Shoji","Shopping basket","Shopping cart","Shovel","Shower cap","Shower curtain","Ski","Ski mask","Sleeping bag","Slide rule","Sliding door","Slot","Snorkel","Snowmobile","Snowplow","Soap dispenser","Soccer ball","Sock","Solar dish","Sombrero","Soup bowl","Space bar","Space heater","Space shuttle","Spatula","Speedboat","Spider web's web","Spindle","Sports car","Spotlight","Stage","Steam locomotive","Steel arch bridge","Steel drum","Stethoscope","Stole","Stone wall","Stopwatch","Stove","Strainer","Streetcar","Stretcher","Studio couch","Stupa","Submarine","Suit","Sundial","Sunglass","Sunglasses","Sunscreen","Suspensiobridge","Swab","Sweatshirt","Swimming trunks","Swing","Switch","Syringe","Table lamp","Tank","Tape player","Teapot","Teddy","Television","Tennis ball","Thatch","Theater curtain","Thimble","Thresher","Throne","Tile roof","Toaster","Tobacco shop","Toilet seat","Torch","Totem pole","Tow truck","Toyshop","Tractor","Trailer truck","Tray","Trench coat","Tricycle","Trimaran","Tripod","Triumphal arch","Trolleybus","Trombone","Tub","Turnstile","Typewriter keyboard","Umbrella","Unicycle","Upright","Vacuum","Vase","Vault","Velvet","Vending machine","Vestment","Viaduct","Violin","Volleyball","Waffle iron","Wall clock","Wallet","Wardrobe","Warplane","Washbasin","Washer","Water bottle","Water jug","Water tower","Whiskey jug","Whistle","Wig","Window screen","Window shade","Windsor tie","Wine bottle","Wing","Wok","Woodespoon","Wool","Worm fence","Wreck","Yawl","Yurt","Web site","Comic book","Crossword puzzle","Street sign","Traffic light","Book jacket","Menu","Plate","Guacamole","Consomme","Hot pot","Trifle","Ice cream","Ice lolly","French loaf","Bagel","Pretzel","Cheeseburger","Hotdog","Mashed potato","Head cabbage","Broccoli","Cauliflower","Zucchini","Spaghetti squash","Acorsquash","Butternut squash","Cucumber","Artichoke","Bell pepper","Cardoon","Mushroom","Granny Smith","Strawberry","Orange","Lemon","Fig","Pineapple","Banana","Jackfruit","Custard apple","Pomegranate","Hay","Carbonara","Chocolate sauce","Dough","Meat loaf","Pizza","Potpie","Burrito","Red wine","Espresso","Cup","Eggnog","Alp","Bubble","Cliff","Coral reef","Geyser","Lakeside","Promontory","Sandbar","Seashore","Valley","Volcano","Ballplayer","Groom","Scuba diver","Rapeseed","Daisy","Yellow lady's slipper","Corn","Acorn","Hip","Buckeye","Coral fungus","Agaric","Gyromitra","Stinkhorn","Earthstar","Hen-of-the-woods","Bolete","Ear","Toilet tissue"],Zp=["n01440764_tench.JPEG","n03160309_dam.JPEG","n03216828_dock.JPEG","n03670208_limousine.JPEG","n04548280_wall_clock.JPEG","n04552348_warplane.JPEG","n04599235_wool.JPEG","n06874185_traffic_light.JPEG","n07873807_pizza.JPEG","n07920052_espresso.JPEG","n09193705_alp.JPEG","n12620546_hip.JPEG"],$p=function(t){Object(_.a)(n,t);var e=Object(x.a)(n);function n(t){var r;return Object(g.a)(this,n),(r=e.call(this,t)).model=void 0,r.mean=new a.gpu.GPUTensor([.485,.456,.406],[3,1,1]),r.std=new a.gpu.GPUTensor([.229,.224,.225],[3,1,1]),function(t){return Yp.apply(this,arguments)}("mobilenet").then((function(t){r.model=t,console.log("Got model")})),r.setState({showResult:!1,results:[]}),r}return Object(b.a)(n,[{key:"getImageData",value:function(){var t=Object(w.a)(y.a.mark((function t(){var e,n,r,o,i,u,s,p,c,l,h,f,d,w,g,b,_,x,O,k=this;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=document.getElementById("img"),console.log("Reading pixels"),r=a.gpu.GPUTensor.fromData(n),o=r.shape.slice(0,2),i=Object(v.a)(o,2),u=i[0],s=i[1],p=Math.min(s,u),c=Math.floor(p/2),l=Math.floor(s/2)-c,h=Math.floor(u/2)-c,f=r.slice([h,l,0],[h+p,l+p,3],[0,1,2]),r.delete(),d=224/p,w=f.upsample([d,d,1]),f.delete(),g=w.getShape()[0],this.setState(Object(m.a)({},this.state)),b=w.transpose([2,0,1]),w.delete(),_=b.subtract(this.mean),b.delete(),x=_.divide(this.std),_.delete(),O=x.reshape([1,3,g,g],!1),null===(e=this.model)||void 0===e||e.forward([O]).then((function(t){return k.handleResult(t[0])}));case 23:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleResult",value:function(){var t=Object(w.a)(y.a.mark((function t(e){var n,r,o;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Got result",e),n=e.softmax(1),e.delete(),t.next=5,n.getValues();case 5:r=t.sent,o=(o=Array.from(r).map((function(t,e){return{prob:t,name:Qp[e]}}))).sort((function(t,e){return e.prob-t.prob})),this.setState(Object(m.a)(Object(m.a)({},this.state),{},{showResult:!0,results:o.slice(0,5)}));case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fileSelected",value:function(t){this.setState(Object(m.a)(Object(m.a)({},this.state),{},{img:URL.createObjectURL(t.target.files[0]),showResult:!1,results:[]}))}},{key:"setImage",value:function(t){this.setState(Object(m.a)(Object(m.a)({},this.state),{},{img:"img/"+t,showResult:!1,results:[]}))}},{key:"render",value:function(){var t,e=this,n=!1;this.state&&(t=this.state.img,n=this.state.showResult);return Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)("h1",{children:"MobilenNet Classification"}),Object(p.jsx)("label",{htmlFor:"file",children:"Choose an image:"})," ",Object(p.jsx)("input",{type:"file",id:"file",onChange:function(t){return e.fileSelected(t)}}),Object(p.jsx)("br",{}),"Or use one of the examples:",Object(p.jsx)("table",{children:Object(p.jsx)("tr",{children:Zp.map((function(t){return Object(p.jsx)("td",{children:Object(p.jsx)("img",{src:"img/"+t,height:50,onClick:function(){return e.setImage(t)},className:"exampleImage",alt:"Example"})})}))})}),void 0!==t?Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("table",{children:Object(p.jsxs)("tr",{children:[Object(p.jsxs)("td",{children:[Object(p.jsx)("img",{id:"img",src:this.state.img,alt:"Your upload",width:400}),Object(p.jsx)("br",{}),Object(p.jsx)("button",{onClick:function(){return e.getImageData()},children:"Run"}),Object(p.jsx)("br",{})]}),Object(p.jsx)("td",{className:"resultList",children:n?this.renderResults():Object(p.jsx)(p.Fragment,{})})]})})}):Object(p.jsx)(p.Fragment,{})]})}},{key:"renderResults",value:function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("table",{children:this.state.results.map((function(t){return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{className:"resultName",children:t.name}),Object(p.jsx)("td",{children:Object(p.jsx)("div",{style:{width:400*t.prob},children:Object(p.jsx)("div",{className:"result",children:400*t.prob>50?Math.round(100*t.prob)+"%":Object(p.jsx)(p.Fragment,{})})})})]},t.name)}))})})}}]),n}(l.a.Component),tc=function(t){t&&t instanceof Function&&n.e(4).then(n.bind(null,47)).then((function(e){var n=e.getCLS,r=e.getFID,o=e.getFCP,i=e.getLCP,a=e.getTTFB;n(t),r(t),o(t),i(t),a(t)}))};f.a.render(Object(p.jsx)(l.a.StrictMode,{children:Object(p.jsx)($p,{})}),document.getElementById("root")),tc()}},[[42,1,2]]]);
//# sourceMappingURL=main.e49302e1.chunk.js.map