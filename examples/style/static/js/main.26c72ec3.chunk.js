(this.webpackJsonpstyle=this.webpackJsonpstyle||[]).push([[0],{23:function(t,n,e){},25:function(t,n,e){},42:function(t,n,e){"use strict";e.r(n);var r={};e.r(r),e.d(r,"CPUTensor",(function(){return Q}));var o={};e.r(o),e.d(o,"GPUTensor",(function(){return Ke}));var i={};e.r(i),e.d(i,"wasmLoaded",(function(){return We})),e.d(i,"WASMTensor",(function(){return Le}));var a={};e.r(a),e.d(a,"cpu",(function(){return r})),e.d(a,"gpu",(function(){return o})),e.d(a,"wasm",(function(){return i}));var u={};e.r(u),e.d(u,"OnnxModel",(function(){return Gi}));var s={};e.r(s),e.d(s,"model",(function(){return u}));var c=e(0),l=e(4),f=e.n(l),p=e(10),h=e.n(p),y=(e(23),e(5)),d=e.n(y),v=e(6),w=e(1),b=e(15),g=e(11),m=e(12),x=e(17),_=e(16);e(25);function k(t){if(0===t.length)return 0;for(var n=1,e=0;e<t.length;e+=1)n*=t[e];return n}function O(t){var n=t.length;if(0===n)return[];if(1===n)return[1];var e=new Array(n);e[n-1]=1,1===t[n-1]&&(e[n-1]=0);for(var r=1,o=n-2;o>=0;o-=1)r=t[o+1]*r,1===t[o]?e[o]=0:e[o]=r;return e}function A(t,n,e){for(var r=0,o=0;o<t.length;o+=1){if(e&&(t[o]<0||t[o]>=e[o]&&1!==e[o]))throw new Error("Invalid index");r+=t[o]*n[o]}return r}function P(t,n){if(t.length!==n.length)return!1;for(var e=0;e<t.length;e+=1)if(t[e]!==n[e])return!1;return!0}function S(t,n){for(var e=t.length-1;e>=0&&(t[e]+=1,t[e]>=n[e]);e--)t[e]=0}var T=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},I=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},j=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},C=function(){function t(){}return t.prototype.compare=function(t,n){return T(this,void 0,void 0,(function(){var e,r,o;return I(this,(function(i){switch(i.label){case 0:return P(this.getShape(),t.getShape())?[4,this.getValues()]:[2,!1];case 1:return e=i.sent(),[4,t.getValues()];case 2:if(r=i.sent(),void 0!==n){for(o=0;o<e.length;o+=1)if(Math.abs(e[o]-r[o])>n)return[2,!1]}else for(o=0;o<e.length;o+=1)if(e[o]!==r[o])return[2,!1];return[2,!0]}}))}))},t.prototype.getAxes=function(t){var n,e=this.getShape();if(void 0===t){n=[];for(var r=0;r<e.length;r++)n.push(r)}else n=t instanceof Array?t:[t];return n},t.prototype.sum=function(t,n){var e=this.getAxes(t);return n=n||!1,this.sum_impl(e,n)},t.prototype.sumSquare=function(t,n){var e=this.getAxes(t);return n=n||!1,this.sumSquare_impl(e,n)},t.prototype.product=function(t,n){var e=this.getAxes(t);return n=n||!1,this.product_impl(e,n)},t.prototype.max=function(t,n){var e=this.getAxes(t);return n=n||!1,this.max_impl(e,n)},t.prototype.min=function(t,n){var e=this.getAxes(t);return n=n||!1,this.min_impl(e,n)},t.prototype.reduceMean=function(t,n){var e=this.getAxes(t);return n=n||!1,this.reduceMean_impl(e,n)},t.prototype.reduceMeanSquare=function(t,n){var e=this.getAxes(t);return n=n||!1,this.reduceMeanSquare_impl(e,n)},t.prototype.conv=function(t,n,e,r,o,i){var a=this.getShape().length-2;return e=e||new Array(a).fill(1),r=r||1,o=o||new Array(2*a).fill(0),i=i||new Array(a).fill(1),this.conv_impl(t,e,r,o,i,n)},t.prototype.pad=function(t,n,e){return void 0===n&&(n="constant"),void 0===e&&(e=0),this.pad_impl(t,n,e)},t.prototype.averagePool=function(t,n,e,r){var o=this.getShape().length-2;return n=n||new Array(2*o).fill(0),e=e||new Array(o).fill(1),r=r||!1,this.averagePool_impl(t,n,e,r)},t.prototype.reshape=function(t,n){for(var e=1,r=-1,o=0;o<t.length;o++)-1===t[o]?r=o:e*=t[o];if(void 0===n&&(n=!0),-1!==r){var i=k(this.getShape()),a=j(t);return a[r]=i/e,this.reshape_impl(a,n)}return this.reshape_impl(t,n)},t.prototype.alignShapes=function(t,n){var e,r;if(P(t,n))return[t,n,t];if(t.length<n.length){t=j(t);var o=n.length-t.length;(e=t).unshift.apply(e,new Array(o).fill(1))}else if(n.length<t.length){n=j(n);o=t.length-n.length;(r=n).unshift.apply(r,new Array(o).fill(1))}for(var i=new Array(t.length).fill(1),a=0;a<t.length;a++)i[a]=Math.max(t[a],n[a]);return[t,n,i]},t.prototype.alignTensor=function(t){var n,e,r=this.getShape(),o=t.getShape();if(P(r,o))return[this,t,r];var i=this;if(r.length<o.length){r=j(r);var a=o.length-r.length;(n=r).unshift.apply(n,new Array(a).fill(1)),i=this.reshape(r,!1)}else if(o.length<r.length){o=j(o);a=r.length-o.length;(e=o).unshift.apply(e,new Array(a).fill(1)),t=t.reshape(o,!1)}for(var u=new Array(r.length).fill(1),s=0;s<r.length;s++)u[s]=Math.max(r[s],o[s]);return[i,t,u]},t.prototype.add=function(t){var n=this.alignTensor(t),e=n[0],r=n[1],o=n[2];return this.add_impl(e,r,o)},t.prototype.subtract=function(t){var n=this.alignTensor(t),e=n[0],r=n[1],o=n[2];return this.subtract_impl(e,r,o)},t.prototype.multiply=function(t){var n=this.alignTensor(t),e=n[0],r=n[1],o=n[2];return this.multiply_impl(e,r,o)},t.prototype.divide=function(t){var n=this.alignTensor(t),e=n[0],r=n[1],o=n[2];return this.divide_impl(e,r,o)},t.prototype.power=function(t){var n=this.alignTensor(t),e=n[0],r=n[1],o=n[2];return this.power_impl(e,r,o)},t.prototype.transpose=function(t){if(void 0===t){var n=this.getShape().length;t=[];for(var e=0;e<n;e++)t.push(n-e-1)}return this.transpose_impl(t)},t.prototype.softmax=function(t){var n=this.max(t,!0),e=this.subtract(n),r=e.exp(),o=r.sum(t,!0),i=r.divide(o);return n.delete(),e.delete(),r.delete(),o.delete(),i},t.prototype.gemm=function(t,n,e,r,o,i){if(n=n||!1,e=e||!1,r=void 0!==r?r:1,i=void 0!==i?i:1,void 0!==o){var a=this.getShape(),u=o.getShape(),s=a.length,c=u.length;u=j(new Array(s-c).fill(1),u),o=o.reshape(u)}return this.gemm_impl(t,n,e,r,i,o)},t.prototype.slice=function(t,n,e){var r=this.getShape(),o=r.length;if(void 0===e){e=[];for(var i=0;i<o;i++)e.push(i)}t=j(t),n=j(n);for(i=0;i<e.length;i++){var a=r[e[i]];t[i]<0?t[i]+=a:t[i]>=a&&(t[i]=a),n[i]<0?n[i]+=a:n[i]>=a&&(n[i]=a)}return this.slice_impl(t,n,e)},t}();function E(t,n,e,r,o,i){var a=o*(n-1)+1;return Math.floor((t+e+r-a)/i+1)}function M(t,n,e,r,o,i){for(var a=[],u=0;u<t.length;u++)a.push(E(t[u],n[u],e[u],r[u],o[u],i[u]));return a}function V(t,n){for(var e=new Q(t.shape),r=0;r<e.size;r+=1)e.set(r,n(t.get(r)));return e}function U(t,n,e,r){if(!function(t,n){if(t.length!==n.length)return!1;for(var e=0;e<t.length;e+=1)if(t[e]!==n[e]&&1!==t[e]&&1!==n[e])return!1;return!0}(t.shape,n.shape))throw new Error("The shapes of the two tensors should be the same for a binary operation");for(var o=new Q(r),i=new Array(r.length).fill(0),a=0;a<o.size;a+=1)o.set(i,e(t.get(i),n.get(i))),S(i,r);return o}var z=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var F=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var G=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function D(t,n,e){for(var r=[],o=[],i=[],a=0;a<t.length;a++)n.includes(a)?(e&&(r.push(1),i.push(a)),o.push(t[a])):(r.push(t[a]),i.push(a));return 0===r.length&&r.push(1),[r,i]}function B(t,n,e,r,o){for(var i=t.getShape(),a=k(i),u=D(i,n,r),s=u[0],c=u[1],l=k(s),f=O(s),p=new Q(s),h=new Array(l).fill(!1),y=new Array(i.length).fill(0),d=new Array(s.length).fill(0),v=0;v<a;v++){for(var w=0;w<c.length;w++)d[w]=y[c[w]];var b=A(d,f);h[b]?p.set(d,e(t.get(v),p.get(d))):(h[b]=!0,p.set(d,e(t.get(v)))),S(y,i)}if(o)for(v=0;v<p.size;v++)p.set(v,o(p.get(v)));return p}var K=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var N=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function R(t,n,e,r,o){if(o)return t.get(n);var i=t.shape.length;if("constant"===e)return r;if("edge"===e)for(var a=0;a<i;a++)n[a]<0?n[a]=0:n[a]>=t.shape[a]&&(n[a]=t.shape[a]-1);else for(a=0;a<i;a++)n[a]<0?n[a]=-n[a]:n[a]>=t.shape[a]&&(n[a]=2*t.shape[a]-n[a]-2);return t.get(n)}var q=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var W=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};var L=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),H=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},J=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Y=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Q=function(t){function n(n,e,r){var o=t.call(this)||this;return o.deleted=!1,o.shape=n,o.strides=O(n),o.size=k(n),void 0!==e?e instanceof Float32Array||e instanceof Int32Array?(o.values=e,o.type=e instanceof Float32Array?"float":"int"):"int"===r?(o.values=Int32Array.from(e),o.type="int"):(o.values=Float32Array.from(e),o.type="float"):"int"===r?(o.values=new Int32Array(o.size),o.type="int"):(o.values=new Float32Array(o.size),o.type="float"),o}return L(n,t),n.prototype.getValues=function(){return Promise.resolve(this.values)},n.prototype.getShape=function(){return this.shape},n.prototype.cpu=function(){return H(this,void 0,void 0,(function(){return J(this,(function(t){return[2,this]}))}))},n.prototype.delete=function(){this.values=void 0,this.deleted=!0},n.prototype.copy=function(t){void 0===t&&(t=Y(this.shape));for(var e=new Float32Array(this.size),r=0;r<this.size;r++)e[r]=this.values[r];return new n(t,e)},n.prototype.get=function(t){var n;return n=Array.isArray(t)?A(t,this.strides,this.shape):t,this.values[n]},n.prototype.set=function(t,n){var e;e=Array.isArray(t)?A(t,this.strides):t,this.values[e]=n},n.prototype.exp=function(){return V(this,(function(t){return Math.exp(t)}))},n.prototype.log=function(){return V(this,(function(t){return Math.log(t)}))},n.prototype.sqrt=function(){return V(this,(function(t){return Math.sqrt(t)}))},n.prototype.abs=function(){return V(this,(function(t){return Math.abs(t)}))},n.prototype.floor=function(){return V(this,(function(t){return Math.floor(t)}))},n.prototype.ceil=function(){return V(this,(function(t){return Math.ceil(t)}))},n.prototype.clip=function(t,n){return function(t,n,e){var r=function(t){return t};return void 0!==n&&void 0!==e?r=function(t){return Math.min(e,Math.max(n,t))}:void 0!==e?r=function(t){return Math.min(e,t)}:void 0!==n&&(r=function(t){return Math.max(n,t)}),V(t,r)}(this,t,n)},n.prototype.add_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,n,e){return U(t,n,(function(t,n){return t+n}),e)}(t,e,r)},n.prototype.subtract_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only subtract CPU tensor to CPU tensor");return function(t,n,e){return U(t,n,(function(t,n){return t-n}),e)}(t,e,r)},n.prototype.multiply_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,n,e){return U(t,n,(function(t,n){return t*n}),e)}(t,e,r)},n.prototype.divide_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,n,e){return U(t,n,(function(t,n){return t/n}),e)}(t,e,r)},n.prototype.power_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only take CPU tensor to power of CPU tensor");return function(t,n,e){return U(t,n,(function(t,n){return Math.pow(t,n)}),e)}(t,e,r)},n.prototype.matMul=function(t){if(!(t instanceof n))throw new Error("Can only add CPU tensor to CPU tensor");return function(t,n){if(2!==t.shape.length||2!==n.shape.length)throw new Error("Matmul expects both operands to have rank 2");if(t.shape[1]!==n.shape[0])throw new Error("Matmul expects dimension 1 of operand 1 to equal dimension 0 of operand 2");for(var e=t.shape[0],r=t.shape[1],o=n.shape[1],i=new Q([e,o]),a=0;a<e;a+=1)for(var u=0;u<o;u+=1){for(var s=0,c=0;c<r;c+=1)s+=t.get([a,c])*n.get([c,u]);i.set([a,u],s)}return i}(this,t)},n.prototype.gemm_impl=function(t,e,r,o,i,a){if(!(t instanceof n&&(void 0===a||a instanceof n)))throw new Error("Can only do gemm with CPU tensors");return function(t,n,e,r,o,i,a){var u=t.shape.length,s=e?t.shape[u-1]:t.shape[u-2],c=e?t.shape[u-2]:t.shape[u-1],l=r?n.shape[u-2]:n.shape[u-1],f=s*c,p=c*l,h=s*l,y=e?s:1,d=e?1:c,v=r?1:l,w=r?c:1,b=0,g=0,m=0;void 0!==a&&(b=a.strides[u-2],g=a.strides[u-1],k(a.shape.slice(0,u-2))>1?1===(m=a.shape[u-2]*a.shape[u-1])&&(m=0):m=0);var x=t.shape.slice(0,u-2),_=k(x);0===_&&(_=1);for(var O=G(x,[s,l]),A=new Q(O),P=0;P<_;P++)for(var S=P*f,T=P*p,I=P*h,j=P*m,C=0;C<s;C++)for(var E=0;E<l;E++){for(var M=0,V=0;V<c;V++)M+=t.get(S+C*d+V*y)*n.get(T+V*v+E*w);M*=o,void 0!==a&&(M+=i*a.get(j+C*b+E*g)),A.set(I+C*l+E,M)}return A}(this,t,e,r,o,i,a)},n.prototype.sum_impl=function(t,n){return function(t,n,e){return B(t,n,(function(t,n){return t+(void 0!==n?n:0)}),e)}(this,t,n)},n.prototype.sumSquare_impl=function(t,n){return function(t,n,e){return B(t,n,(function(t,n){return t*t+(void 0!==n?n:0)}),e)}(this,t,n)},n.prototype.product_impl=function(t,n){return function(t,n,e){return B(t,n,(function(t,n){return t*(void 0!==n?n:1)}),e)}(this,t,n)},n.prototype.max_impl=function(t,n){return function(t,n,e){return B(t,n,(function(t,n){return Math.max(t,void 0!==n?n:t)}),e)}(this,t,n)},n.prototype.min_impl=function(t,n){return function(t,n,e){return B(t,n,(function(t,n){return Math.min(t,void 0!==n?n:t)}),e)}(this,t,n)},n.prototype.reduceMean_impl=function(t,n){return function(t,n,e){for(var r=1,o=0;o<n.length;o++)r*=t.shape[n[o]];return B(t,n,(function(t,n){return t+(void 0!==n?n:0)}),e,(function(t){return t/r}))}(this,t,n)},n.prototype.reduceMeanSquare_impl=function(t,n){return function(t,n,e){for(var r=1,o=0;o<n.length;o++)r*=t.shape[n[o]];return B(t,n,(function(t,n){return t*t+(void 0!==n?n:0)}),e,(function(t){return t/r}))}(this,t,n)},n.prototype.conv_impl=function(t,e,r,o,i,a){if(!(t instanceof n)||void 0!==a&&!(a instanceof n))throw new Error("Can only do convolution of CPU tensor with CPU tensor");return function(t,n,e,r,o,i,a){var u=t.shape[0],s=t.shape[1],c=t.shape.slice(2),l=n.shape.slice(2),f=n.shape[0],p=s/r,h=k(l),y=M(c,l,o.slice(0,o.length/2),o.slice(o.length/2),e,i),d=k(y),v=[u,f];v=v.concat(y);for(var w=new Q(v),b=y.length,g=0;g<u;g++)for(var m=0;m<f;m++){if(a){var x=a?a.get([m]):0;(A=new Array(y.length).fill(0)).unshift(g,m);for(var _=0;_<d;_++)w.set(A,x),S(A,w.shape)}for(var O=0;O<p;O++){var A,P=(m*p+O)%s;for((A=new Array(y.length).fill(0)).unshift(g,m),_=0;_<d;_++){var T=w.get(A),I=new Array(y.length).fill(0);I.unshift(m,O);for(var j=0;j<h;j++){for(var C=[g,P],E=!1,V=0;V<b;V++){var U=0===i.length?1:i[V],z=0===o.length?0:o[V],F=0===e.length?1:e[V],G=A[V+2]*U-z+I[V+2]*F;if(G<0||G>=c[V]){E=!0;break}C.push(G)}E||(T+=n.get(I)*t.get(C)),S(I,n.shape)}w.set(A,T),S(A,w.shape)}}}return w}(this,t,e,r,o,i,a)},n.prototype.pad_impl=function(t,n,e){return function(t,n,e,r){for(var o=t.shape.length,i=N(t.shape),a=0;a<o;a++)i[a]+=n[a]+n[a+o];var u=new Q(i),s=new Array(o).fill(0),c=new Array(o).fill(0);for(a=0;a<u.size;a++){for(var l=!0,f=0;f<o;f++)c[f]=s[f]-n[f],(c[f]<0||c[f]>=t.shape[f])&&(l=!1);u.set(a,R(t,c,e,r,l)),S(s,i)}return u}(this,t,n,e)},n.prototype.averagePool_impl=function(t,n,e,r){return function(t,n,e,r,o){var i=t.shape[0],a=t.shape[1],u=t.shape.slice(2),s=u.length,c=k(n),l=M(u,n,e.slice(0,e.length/2),e.slice(e.length/2),new Array(s).fill(1),r),f=k(l),p=[i,a];p=p.concat(l);for(var h=new Q(p),y=0;y<i;y++)for(var d=0;d<a;d++){var v=new Array(l.length).fill(0);v.unshift(y,d);for(var w=0;w<f;w++){for(var b=0,g=new Array(l.length).fill(0),m=0,x=0;x<c;x++){for(var _=[y,d],O=!1,A=0;A<s;A++){var P=0===r.length?1:r[A],T=0===e.length?0:e[A],I=v[A+2]*P-T+g[A];if(I<0||I>=u[A]){O=!0;break}_.push(I)}O||(b+=t.get(_)),O&&!o||(m+=1),S(g,n)}b/=m,h.set(v,b),S(v,h.shape)}}return h}(this,t,n,e,r)},n.prototype.reshape_impl=function(t,e){return e?this.copy(t):new n(t,this.values,this.type)},n.prototype.concat=function(t,e){if(!(t instanceof n))throw new Error("Can only concat CPU tensor to CPU tensor");return function(t,n,e){var r=z(t.shape);r[e]+=n.shape[e];for(var o=new Q(r),i=0,a=0,u=0,s=o.strides[e]*t.shape[e],c=o.strides[e]*n.shape[e],l=o.size/(e>0?o.strides[e-1]:o.size),f=0;f<l;f++){for(var p=0;p<s;p++)o.set(u,t.get(i)),u++,i++;for(p=0;p<c;p++)o.set(u,n.get(a)),u++,a++}return o}(this,t,e)},n.prototype.transpose_impl=function(t){return function(t,n){for(var e=t.shape.length,r=new Array(e),o=new Array(e),i=0;i<e;i++)r[i]=t.shape[n[i]],o[n[i]]=i;var a=new Q(r),u=a.strides,s=new Array(e);for(i=0;i<e;i++)s[i]=u[o[i]];var c=new Array(e).fill(0);for(i=0;i<t.size;i++){for(var l=0,f=0;f<e;f++)l+=c[f]*s[f];a.set(l,t.get(i)),S(c,t.shape)}return a}(this,t)},n.prototype.repeat=function(t){return function(t,n){for(var e=t.shape.length,r=new Array(e),o=0;o<e;o++)r[o]=t.shape[o]*n[o];var i=new Q(r),a=new Array(e).fill(0);for(o=0;o<i.size;o++){for(var u=new Array(e),s=0;s<e;s++)u[s]=a[s]%t.shape[s];i.set(o,t.get(u)),S(a,i.shape)}return i}(this,t)},n.prototype.expand=function(t){var n=this.alignShapes(this.shape,t),e=n[0],r=(n[1],n[2]);return P(this.shape,r)?this.copy():function(t,n){for(var e=t.shape.length,r=new Q(n),o=new Array(e).fill(0),i=0;i<r.size;i++)r.set(i,t.get(o)),S(o,r.shape);return r}(this.reshape(e,!1),r)},n.prototype.gather=function(t,n){return function(t,n,e){for(var r=t.shape.length,o=e.shape.length,i=r+o-1,a=new Array(i),u=0;u<n;u++)a[u]=t.shape[u];for(u=0;u<o;u++)a[u+n]=e.shape[u];for(u=n+1;u<r;u++)a[u+o-1]=t.shape[u];var s,c,l=new Q(a,void 0,t.type),f=new Array(i).fill(0);for(u=0;u<l.size;u++){s=f.slice(n,n+o);var p=e.get(s);c=F(f.slice(0,n),[p],f.slice(n+o)),l.set(u,t.get(c)),S(f,a)}return l}(this,t,n)},n.prototype.slice_impl=function(t,n,e){return function(t,n,e,r){for(var o=t.shape.length,i=q(t.shape),a=0,u=0;u<o&&a<r.length;u++)u==r[a]&&(i[u]=e[a]-n[a],a++);var s,c=new Q(i,void 0,t.type),l=new Array(o).fill(0);for(u=0;u<c.size;u++){s=q(l);for(var f=0;f<r.length;f++)s[r[f]]+=n[f];c.set(u,t.get(s)),S(l,i)}return c}(this,t,n,e)},n.prototype.upsample=function(t){return function(t,n){for(var e=t.shape.length,r=W(t.shape),o=0;o<e;o++)r[o]=Math.floor(r[o]*n[o]);var i=new Q(r,void 0,t.type),a=new Array(e).fill(0),u=new Array(e);for(o=0;o<i.size;o++){for(var s=0;s<e;s++)u[s]=Math.floor(a[s]/n[s]);i.set(o,t.get(u)),S(a,r)}return i}(this,t)},n.prototype.normalize=function(t,e,r,o,i){if(!(t instanceof n)||!(e instanceof n)||!(o instanceof n)||!(i instanceof n))throw new Error("Can only normalize with CPU tensors");return function(t,n,e,r,o,i){for(var a=t.shape.length,u=K(t.shape),s=new Q(u,void 0,t.type),c=new Array(a).fill(0),l=0;l<s.size;l++){var f=(t.get(c)-n.get(c))/Math.sqrt(e.get(c)+r);f=f*o.get(c)+i.get(c),s.set(l,f),S(c,u)}return s}(this,t,e,r,o,i)},n}(C),X=e(13),Z=e.n(X);function $(t,n){if(t<n)return-1;if(t>n)return 1;if(t===n)return 0;throw new Error("Couldn't compare elements")}function tt(t,n){for(var e=0;e<n.length;e++)t.push(n[e])}var nt=function(){function t(t){t=t||{},this.left=null,this.right=null,this.parent=void 0!==t.parent?t.parent:null,t.hasOwnProperty("key")&&(this.key=t.key),this.value=t.hasOwnProperty("value")?[t.value]:[],this.unique=t.unique||!1,this.compareKeys=t.compareKeys||$,this.compareValues=t.compareValues||function(t,n){return t===n}}return t.prototype.getMaxKeyDescendant=function(){return this.right?this.right.getMaxKeyDescendant():this},t.prototype.getMaxKey=function(){return this.getMaxKeyDescendant().key},t.prototype.getMinKeyDescendant=function(){return this.left?this.left.getMinKeyDescendant():this},t.prototype.getMinKey=function(){return this.getMinKeyDescendant().key},t.prototype.checkAllNodesFullfillCondition=function(t){this.hasOwnProperty("key")&&(t(this.key,this.value),this.left&&this.left.checkAllNodesFullfillCondition(t),this.right&&this.right.checkAllNodesFullfillCondition(t))},t.prototype.checkNodeOrdering=function(){var t=this;this.hasOwnProperty("key")&&(this.left&&(this.left.checkAllNodesFullfillCondition((function(n,e){if(t.compareKeys(n,t.key)>=0)throw new Error("Tree with root "+t.key+" is not a binary search tree");return!0})),this.left.checkNodeOrdering()),this.right&&(this.right.checkAllNodesFullfillCondition((function(n,e){if(t.compareKeys(n,t.key)<=0)throw new Error("Tree with root "+t.key+" is not a binary search tree");return!0})),this.right.checkNodeOrdering()))},t.prototype.checkInternalPointers=function(){if(this.left){if(this.left.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.left.checkInternalPointers()}if(this.right){if(this.right.parent!==this)throw new Error("Parent pointer broken for key "+this.key);this.right.checkInternalPointers()}},t.prototype.checkIsBST=function(){if(this.checkNodeOrdering(),this.checkInternalPointers(),this.parent)throw new Error("The root shouldn't have a parent")},t.prototype.getNumberOfKeys=function(){var t;return this.hasOwnProperty("key")?(t=1,this.left&&(t+=this.left.getNumberOfKeys()),this.right&&(t+=this.right.getNumberOfKeys()),t):0},t.prototype.createSimilar=function(n){return(n=n||{}).unique=this.unique,n.compareKeys=this.compareKeys,new t(n)},t.prototype.createLeftChild=function(t){var n=this.createSimilar(t);return n.parent=this,this.left=n,n},t.prototype.createRightChild=function(t){var n=this.createSimilar(t);return n.parent=this,this.right=n,n},t.prototype.insert=function(t,n){if(!this.hasOwnProperty("key"))return this.key=t,void this.value.push(n);if(0!==this.compareKeys(this.key,t))this.compareKeys(t,this.key)<0?this.left?this.left.insert(t,n):this.createLeftChild({key:t,value:n}):this.right?this.right.insert(t,n):this.createRightChild({key:t,value:n});else{if(this.unique)throw new Error("Can't insert key "+t+", it violates the unique constraint");this.value.push(n)}},t.prototype.search=function(t){return this.hasOwnProperty("key")?0===this.compareKeys(this.key,t)?this.value:this.compareKeys(t,this.key)<0?this.left?this.left.search(t):[]:this.right?this.right.search(t):[]:[]},t.prototype.getLowerBoundMatcher=function(t){var n=this;return t.hasOwnProperty("gt")||t.hasOwnProperty("gte")?t.hasOwnProperty("gt")&&t.hasOwnProperty("gte")?0===this.compareKeys(t.gte,t.gt)?function(e){return n.compareKeys(e,t.gt)>0}:this.compareKeys(t.gte,t.gt)>0?function(e){return n.compareKeys(e,t.gte)>=0}:function(e){return n.compareKeys(e,t.gt)>0}:t.hasOwnProperty("gt")?function(e){return n.compareKeys(e,t.gt)>0}:function(e){return n.compareKeys(e,t.gte)>=0}:function(){return!0}},t.prototype.getUpperBoundMatcher=function(t){var n=this;return t.hasOwnProperty("lt")||t.hasOwnProperty("lte")?t.hasOwnProperty("lt")&&t.hasOwnProperty("lte")?0===this.compareKeys(t.lte,t.lt)?function(e){return n.compareKeys(e,t.lt)<0}:this.compareKeys(t.lte,t.lt)<0?function(e){return n.compareKeys(e,t.lte)<=0}:function(e){return n.compareKeys(e,t.lt)<0}:t.hasOwnProperty("lt")?function(e){return n.compareKeys(e,t.lt)<0}:function(e){return n.compareKeys(e,t.lte)<=0}:function(){return!0}},t.prototype.betweenBounds=function(t,n,e){var r=[];if(!this.hasOwnProperty("key"))return[];if(n=n||this.getLowerBoundMatcher(t),e=e||this.getUpperBoundMatcher(t),n(this.key)&&this.left&&tt(r,this.left.betweenBounds(t,n,e)),n(this.key)&&e(this.key))for(var o=0;o<this.value.length;o++)r.push({key:this.key,value:this.value[o]});return e(this.key)&&this.right&&tt(r,this.right.betweenBounds(t,n,e)),r},t.prototype.betweenBoundsFirst=function(t,n,e){if(!this.hasOwnProperty("key"))return[];if(n=n||this.getLowerBoundMatcher(t),e=e||this.getUpperBoundMatcher(t),n(this.key)&&this.left){var r=this.left.betweenBoundsFirst(t,n,e);if(r.length>0)return r}return n(this.key)&&e(this.key)&&this.value.length>0?[{key:this.key,value:this.value[0]}]:e(this.key)&&this.right?this.right.betweenBoundsFirst(t,n,e):[]},t.prototype.deleteIfLeaf=function(){return!this.left&&!this.right&&(this.parent?(this.parent.left===this?this.parent.left=null:this.parent.right=null,!0):(delete this.key,this.value=[],!0))},t.prototype.deleteIfOnlyOneChild=function(){var t;return this.left&&!this.right&&(t=this.left),!this.left&&this.right&&(t=this.right),!!t&&(this.parent?(this.parent.left===this?(this.parent.left=t,t.parent=this.parent):(this.parent.right=t,t.parent=this.parent),!0):(this.key=t.key,this.value=t.value,this.left=null,t.left&&(this.left=t.left,t.left.parent=this),this.right=null,t.right&&(this.right=t.right,t.right.parent=this),!0))},t.prototype.delete=function(t,n){var e,r=this,o=[];if(this.hasOwnProperty("key"))if(this.compareKeys(t,this.key)<0)this.left&&this.left.delete(t,n);else if(this.compareKeys(t,this.key)>0)this.right&&this.right.delete(t,n);else if(0===this.compareKeys(t,this.key))return this.value.length>1&&void 0!==n?(this.value.forEach((function(t){r.compareValues(t,n)||o.push(t)})),void(this.value=o)):void(this.deleteIfLeaf()||this.deleteIfOnlyOneChild()||(Math.random()>=.5?(e=this.left.getMaxKeyDescendant(),this.key=e.key,this.value=e.value,this===e.parent?(this.left=e.left,e.left&&(e.left.parent=e.parent)):(e.parent.right=e.left,e.left&&(e.left.parent=e.parent))):(e=this.right.getMinKeyDescendant(),this.key=e.key,this.value=e.value,this===e.parent?(this.right=e.right,e.right&&(e.right.parent=e.parent)):(e.parent.left=e.right,e.right&&(e.right.parent=e.parent)))))},t.prototype.executeOnEveryNode=function(t){this.left&&this.left.executeOnEveryNode(t),t(this),this.right&&this.right.executeOnEveryNode(t)},t.prototype.prettyPrint=function(t,n){n=n||"",console.log(n+"* "+this.key),t&&console.log(n+"* "+this.value),(this.left||this.right)&&(this.left?this.left.prettyPrint(t,n+"  "):console.log(n+"  *"),this.right?this.right.prettyPrint(t,n+"  "):console.log(n+"  *"))},t}(),et=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),rt=function(){function t(t){this.tree=new ot(t)}return t.prototype.checkIsAVLT=function(){this.tree.checkIsAVLT()},t.prototype.insert=function(t,n){var e=this.tree.insert(t,n);e&&(this.tree=e)},t.prototype.delete=function(t,n){var e=this.tree.delete(t,n);e&&(this.tree=e)},t.prototype.deleteFirst=function(t){var n=this.tree.deleteFirst(t);n&&(this.tree=n)},t.prototype.getNumberOfKeys=function(){return this.tree.getNumberOfKeys()},t.prototype.search=function(t){return this.tree.search(t)},t.prototype.betweenBounds=function(t){return this.tree.betweenBounds(t)},t.prototype.betweenBoundsFirst=function(t){return this.tree.betweenBoundsFirst(t)},t.prototype.prettyPrint=function(t,n){this.tree.prettyPrint(t,n)},t.prototype.executeOnEveryNode=function(t){this.tree.executeOnEveryNode(t)},t}(),ot=function(t){function n(n){var e=t.call(this,n)||this;return e.leftRotation=function(){var t,n,e,r,o=this,i=this.right;return i?(t=i.left,o.parent?(i.parent=o.parent,o.parent.left===o?o.parent.left=i:o.parent.right=i):i.parent=null,i.left=o,o.parent=i,o.right=t,t&&(t.parent=o),n=o.left?o.left.height:0,e=t?t.height:0,r=i.right?i.right.height:0,o.height=Math.max(n,e)+1,i.height=Math.max(r,o.height)+1,i):this},e}return et(n,t),n.prototype.checkHeightCorrect=function(){var t,n;if(this.hasOwnProperty("key")){if(this.left&&void 0===this.left.height)throw new Error("Undefined height for node "+this.left.key);if(this.right&&void 0===this.right.height)throw new Error("Undefined height for node "+this.right.key);if(void 0===this.height)throw new Error("Undefined height for node "+this.key);if(t=this.left?this.left.height:0,n=this.right?this.right.height:0,this.height!==1+Math.max(t,n))throw new Error("Height constraint failed for node "+this.key);this.left&&this.left.checkHeightCorrect(),this.right&&this.right.checkHeightCorrect()}},n.prototype.balanceFactor=function(){return(this.left?this.left.height:0)-(this.right?this.right.height:0)},n.prototype.checkBalanceFactors=function(){if(Math.abs(this.balanceFactor())>1)throw new Error("Tree is unbalanced at node "+this.key);this.left&&this.left.checkBalanceFactors(),this.right&&this.right.checkBalanceFactors()},n.prototype.checkIsAVLT=function(){t.prototype.checkIsBST.call(this),this.checkHeightCorrect(),this.checkBalanceFactors()},n.prototype.rightRotation=function(){var t,n,e,r,o=this,i=this.left;return i?(t=i.right,o.parent?(i.parent=o.parent,o.parent.left===o?o.parent.left=i:o.parent.right=i):i.parent=null,i.right=o,o.parent=i,o.left=t,t&&(t.parent=o),n=i.left?i.left.height:0,e=t?t.height:0,r=o.right?o.right.height:0,o.height=Math.max(e,r)+1,i.height=Math.max(n,o.height)+1,i):this},n.prototype.rightTooSmall=function(){return this.balanceFactor()<=1?this:(this.left.balanceFactor()<0&&this.left.leftRotation(),this.rightRotation())},n.prototype.leftTooSmall=function(){return this.balanceFactor()>=-1?this:(this.right.balanceFactor()>0&&this.right.rightRotation(),this.leftRotation())},n.prototype.rebalanceAlongPath=function(t){var n,e,r=this;if(!this.hasOwnProperty("key"))return delete this.height,this;for(e=t.length-1;e>=0;e-=1)t[e].height=1+Math.max(t[e].left?t[e].left.height:0,t[e].right?t[e].right.height:0),t[e].balanceFactor()>1&&(n=t[e].rightTooSmall(),0===e&&(r=n)),t[e].balanceFactor()<-1&&(n=t[e].leftTooSmall(),0===e&&(r=n));return r},n.prototype.insert=function(t,n){var e=[],r=this;if(!this.hasOwnProperty("key"))return this.key=t,this.value.push(n),this.height=1,this;for(;;){if(0===r.compareKeys(r.key,t)){if(r.unique)throw new Error("Can't insert key "+t+", it violates the unique constraint");return r.value.push(n),this}if(e.push(r),r.compareKeys(t,r.key)<0){if(!r.left){e.push(r.createLeftChild({key:t,value:n}));break}r=r.left}else{if(!r.right){e.push(r.createRightChild({key:t,value:n}));break}r=r.right}}return this.rebalanceAlongPath(e)},n.prototype.createSimilar=function(t){return(t=t||{}).unique=this.unique,t.compareKeys=this.compareKeys,new n(t)},n.prototype.delete=function(t,n){var e,r=[],o=this,i=[];if(!this.hasOwnProperty("key"))return this;for(;0!==o.compareKeys(t,o.key);)if(i.push(o),o.compareKeys(t,o.key)<0){if(!o.left)return this;o=o.left}else{if(!o.right)return this;o=o.right}if(o.value.length>1&&void 0!==n)return o.value.forEach((function(t){o.compareValues(t,n)||r.push(t)})),o.value=r,this;if(!o.left&&!o.right)return o===this?(delete o.key,o.value=[],delete o.height,this):(o.parent.left===o?o.parent.left=null:o.parent.right=null,this.rebalanceAlongPath(i));if(!o.left||!o.right)return e=o.left?o.left:o.right,o===this?(e.parent=null,e):(o.parent.left===o?(o.parent.left=e,e.parent=o.parent):(o.parent.right=e,e.parent=o.parent),this.rebalanceAlongPath(i));if(i.push(o),!(e=o.left).right)return o.key=e.key,o.value=e.value,o.left=e.left,e.left&&(e.left.parent=o),this.rebalanceAlongPath(i);for(;e.right;)i.push(e),e=e.right;return o.key=e.key,o.value=e.value,e.parent.right=e.left,e.left&&(e.left.parent=e.parent),this.rebalanceAlongPath(i)},n.prototype.deleteFirst=function(t){var n,e=this,r=[];if(!this.hasOwnProperty("key"))return this;for(;0!==e.compareKeys(t,e.key);)if(r.push(e),e.compareKeys(t,e.key)<0){if(!e.left)return this;e=e.left}else{if(!e.right)return this;e=e.right}if(e.value.length>1)return e.value=e.value.slice(1),this;if(!e.left&&!e.right)return e===this?(delete e.key,e.value=[],delete e.height,this):(e.parent.left===e?e.parent.left=null:e.parent.right=null,this.rebalanceAlongPath(r));if(!e.left||!e.right)return n=e.left?e.left:e.right,e===this?(n.parent=null,n):(e.parent.left===e?(e.parent.left=n,n.parent=e.parent):(e.parent.right=n,n.parent=e.parent),this.rebalanceAlongPath(r));if(r.push(e),!(n=e.left).right)return e.key=n.key,e.value=n.value,e.left=n.left,n.left&&(n.left.parent=e),this.rebalanceAlongPath(r);for(;n.right;)r.push(n),n=n.right;return e.key=n.key,e.value=n.value,n.parent.right=n.left,n.left&&(n.left.parent=n.parent),this.rebalanceAlongPath(r)},n}(nt);function it(t){return at(t)}function at(t,n,e){if(void 0===n&&(n=[]),void 0===e&&(e=!0),!Number.isInteger(t))return n;var r=Math.abs(t);if(r<2)return n;var o=Math.sqrt(r),i=2;if(r%i&&r%(i=3)){i=5;for(var a=2;r%i&&i<o;)i+=a,a=6-a}(i=i<=o?i:r,e)?n.push(i):n.indexOf(i)<0&&n.push(i);return i===r?n:at(r/i,n,e)}var ut,st,ct,lt=function(){function t(t,n){this.tree=new rt({compareValues:function(t,n){return t.id===n.id}}),this.regl=t,this.entryId=0,this.maxSizeFactor=n||2}return t.prototype.allocate=function(t){var n=t*this.maxSizeFactor,e=4*Math.ceil(t/4);e<n&&(n=e);var r=this.tree.betweenBoundsFirst({gte:t,lte:n});if(0===r.length){var o=Math.ceil(t/4),i=this.getTextureDims(o),a=i.width,u=i.height;return{width:a,height:u,size:a*u*4,frameBuffer:this.regl.framebuffer({width:a,height:u,depthStencil:!1,colorFormat:"rgba",colorType:"float"}),id:this.entryId++}}var s=r[0];return this.tree.deleteFirst(s.key),s.value},t.prototype.deallocate=function(t){this.tree.insert(t.size,t)},t.prototype.allocateTexture=function(t){for(var n=Math.ceil(t.length/4),e=this.getTextureDims(n),r=e.width,o=e.height,i=r*o*4,a=new Float32Array(i),u=0;u<t.length;u++)a[u]=t[u];for(u=t.length;u<i;u++)a[u]=0;var s=this.regl.texture({width:r,height:o,format:"rgba",type:"float",data:a});return{width:r,height:o,size:i,frameBuffer:this.regl.framebuffer({color:s,width:r,height:o,depthStencil:!1}),id:this.entryId++}},t.prototype.allocateOfDimensions=function(t,n){var e=t*n*4,r=this.regl.texture({width:t,height:n,format:"rgba",type:"float"});return{width:t,height:n,size:e,frameBuffer:this.regl.framebuffer({color:r,width:t,height:n,depthStencil:!1}),id:this.entryId++}},t.prototype.allocateFramebuffer=function(t){var n=this.regl.framebuffer({color:t,width:t.width,height:t.height,depthStencil:!1});return{width:t.width,height:t.height,size:t.width*t.height*4,frameBuffer:n,id:this.entryId++}},t.prototype.getTextureDims=function(t){for(var n=it(t),e=1,r=1,o=0;o<n.length;o+=2)e*=n[o],o+1<n.length&&(r*=n[o+1]);return{width:e,height:r}},t}(),ft=document.createElement("canvas");ut=ft.getContext("webgl",{failIfMajorPerformanceCaveat:!1}),st=Z()({gl:ut,extensions:["OES_texture_float","WEBGL_color_buffer_float"]}),ct=new lt(st);var pt=function(){return(pt=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},ht=10;function yt(t,n){for(void 0===n&&(n=ht);t.length<n;)t.push(-1);return t}function dt(t,n){void 0===n&&(n=ht);for(var e=Array.from(t);e.length<n;)e.push(-1);return e}var vt=0;function wt(t,n,e){var r=e+"_"+vt++;return"\n  int "+r+" = "+e+";\n  for (int i = 0; i < "+"10; i++) {\n    if ("+t+"[i] == -1) {\n      "+n+"[i] = -1;\n    } else {\n      if ("+t+"[i] == 0) {\n        "+n+"[i] = 0;\n      } else {\n        "+n+"[i] = "+r+"/"+t+"[i];\n        "+r+" = "+r+" - "+t+"[i]*"+n+"[i]; // Stupid modulo hack\n      }\n    }\n  }"}function bt(t,n){return void 0===n?"\n      for (int i = 0; i < 10; i++) {\n        "+t+"[i] = -1;\n      }":"\n      for (int i = 0; i < 10; i++) {\n        if (i < "+n+") {\n          "+t+"[i] = 0;\n        } else {\n          "+t+"[i] = -1;\n        }\n      }"}function gt(t,n){return"\n  for (int i = 10 - 1; i >= 0; i--) {\n    if ("+n+"[i] != -1) {\n      "+t+"[i] += 1;\n      if ("+t+"[i] >= "+n+"[i]) {\n        "+t+"[i] = 0;\n      } else {\n        break;\n      }\n    }\n  }\n  "}var mt,xt="\nvoid main() {\n  int pos = coordinateToPos(uv, widthOutput, heightOutput);\n\n  vec4 result = vec4(0,0,0,0);\n\n  if (pos < sizeOutput) {\n    int index[10];\n    "+wt("stridesOutput","index","pos")+"\n    result.r = process(index);\n\n    pos += 1;\n\n    if (pos < sizeOutput) {\n      "+wt("stridesOutput","index","pos")+"\n      result.g = process(index);\n\n      pos += 1;\n\n      if (pos < sizeOutput) {\n        "+wt("stridesOutput","index","pos")+"\n        result.b = process(index);\n\n        pos += 1;\n\n        if (pos < sizeOutput) {\n          "+wt("stridesOutput","index","pos")+"\n          result.a = process(index);\n        }\n      }\n    }\n  }\n\n  gl_FragColor = result;\n}";function _t(t,n){return"\n  precision highp float;\n  "+n.map((function(t){return"\n    uniform sampler2D "+t+";\n    uniform int size"+t+";\n    uniform int width"+t+";\n    uniform int height"+t+";\n    uniform int strides"+t+"["+"10];\n    uniform int shape"+t+"["+"10];\n    uniform int rank"+t+";\n    "})).join("\n")+"\n  uniform int sizeOutput;\n  uniform int widthOutput;\n  uniform int heightOutput;\n  uniform int stridesOutput["+"10];\n  uniform int shapeOutput["+"10];\n  uniform int rankOutput;\n  varying vec2 uv;\n\n  \nint fromFloat(float f) {\n  return int(floor(f+0.5));\n}\n\nint coordinateToPos(vec2 coordinate, int textureWidth, int textureHeight) {\n  int x = (fromFloat(coordinate.x*float(textureWidth*2))-1)/2;\n  int y = (fromFloat(coordinate.y*float(textureHeight*2))-1)/2;\n\n  int pos = x + y*textureWidth;\n\n  return pos*4;\n}\n\nvec2 posToCoordinate(int pos, int textureWidth, int textureHeight) {\n  // 4 positions map to the same coordinate\n  pos = pos/4;\n\n  int y = pos/textureWidth;\n  int x = pos - y*textureWidth;\n\n  return vec2(float(x*2+1)/float(textureWidth*2), float(y*2+1)/float(textureHeight*2));\n}\n\nint indexToPos(int index[10], int strides[10]) {\n  int pos = 0;\n  for (int i = 0; i < 10; i++) {\n    if (strides[i] == -1) {\n      break;\n    }\n    pos += index[i]*strides[i];\n  }\n  return pos;\n}\n\nfloat getValueAtPos(int pos, int textureWidth, int textureHeight, sampler2D tex) {\n  vec2 coord = posToCoordinate(pos, textureWidth, textureHeight);\n  int res = pos - (pos/4)*4;\n  vec4 val = texture2D(tex, coord);\n  if (res == 0) {\n    return val.r;\n  } else if (res == 1) {\n    return val.g;\n  } else if (res == 2) {\n    return val.b;\n  } else {\n    return val.a;\n  }\n}\n\nfloat getValueAt(int index[10], int strides[10], int textureWidth, int textureHeight, sampler2D tex) {\n  int pos = indexToPos(index, strides);\n  return getValueAtPos(pos, textureWidth, textureHeight, tex);\n}\n\n  "+n.map((function(t){return"\n    float _"+t+"(int indices["+"10]) {\n      return getValueAt(indices, strides"+t+", width"+t+", height"+t+", "+t+");\n    }\n    "})).join("\n")+"\n\n  "+t+"\n  "}function kt(t,n,e){void 0===e&&(e=[]);for(var r={},o=0,i=t;o<i.length;o++){var a=i[o];r[a]=st.prop(a),e.push({name:"size"+a}),e.push({name:"width"+a}),e.push({name:"height"+a}),e.push({name:"strides"+a,length:ht}),e.push({name:"shape"+a,length:ht}),e.push({name:"rank"+a})}e.push({name:"sizeOutput"}),e.push({name:"widthOutput"}),e.push({name:"heightOutput"}),e.push({name:"stridesOutput",length:ht}),e.push({name:"shapeOutput",length:ht}),e.push({name:"rankOutput"});for(var u=0,s=e;u<s.length;u++){var c=s[u];if(void 0!==c.length)for(var l=0;l<c.length;l++){var f=c.name+"["+l+"]";r[f]=st.prop(f)}else r[c.name]=st.prop(c.name)}return st({frag:_t(n,t),vert:"\n      precision highp float;\n      attribute vec2 position;\n      varying vec2 uv;\n      void main() {\n        uv = 0.5 * (position + 1.0);\n        gl_Position = vec4(position, 0, 1);\n      }",attributes:{position:[-4,-4,4,-4,0,4]},uniforms:r,framebuffer:st.prop("framebuffer"),depth:{enable:!1},count:3})}function Ot(t,n,e,r){var o=k(n),i=ct.allocate(o),a={};for(var u in e)a[u]=e[u].memory.frameBuffer;for(var s in void 0===r&&(r={}),e)r["size"+s]=e[s].size,r["width"+s]=e[s].memory.width,r["height"+s]=e[s].memory.height,r["strides"+s]=yt(O(e[s].getShape())),r["shape"+s]=dt(e[s].getShape()),r["rank"+s]=e[s].getShape().length;return r.sizeOutput=o,r.widthOutput=i.width,r.heightOutput=i.height,r.stridesOutput=yt(O(n)),r.shapeOutput=dt(n),r.rankOutput=n.length,t(pt(pt({framebuffer:i.frameBuffer},a),r)),new Ke(i,n)}var At;function Pt(t){return void 0===mt&&(mt=kt(["inputTensor"],"\nvoid main() {\n  gl_FragColor = exp(texture2D(inputTensor, uv));\n}")),Ot(mt,t.getShape(),{inputTensor:t})}var St;function Tt(t){return void 0===At&&(At=kt(["inputTensor"],"\nvoid main() {\n  gl_FragColor = log(texture2D(inputTensor, uv));\n}")),Ot(At,t.getShape(),{inputTensor:t})}var It;function jt(t){return void 0===St&&(St=kt(["inputTensor"],"\nvoid main() {\n  gl_FragColor = sqrt(texture2D(inputTensor, uv));\n}")),Ot(St,t.getShape(),{inputTensor:t})}var Ct,Et="\nfloat process(int index[10]) {\n  return _inputTensor1(index) + _inputTensor2(index);\n}\n\n"+xt+"\n";function Mt(t,n,e){return void 0===It&&(It=kt(["inputTensor1","inputTensor2"],Et)),Ot(It,e,{inputTensor1:t,inputTensor2:n})}var Vt,Ut="\nfloat process(int index[10]) {\n  return _inputTensor1(index) - _inputTensor2(index);\n}\n\n"+xt+"\n";function zt(t,n,e){return void 0===Ct&&(Ct=kt(["inputTensor1","inputTensor2"],Ut)),Ot(Ct,e,{inputTensor1:t,inputTensor2:n})}var Ft,Gt="\nfloat process(int index[10]) {\n  return _inputTensor1(index) * _inputTensor2(index);\n}\n\n"+xt+"\n";function Dt(t,n,e){return void 0===Vt&&(Vt=kt(["inputTensor1","inputTensor2"],Gt)),Ot(Vt,e,{inputTensor1:t,inputTensor2:n})}var Bt,Kt="\nfloat process(int index[10]) {\n  return _inputTensor1(index) / _inputTensor2(index);\n}\n\n"+xt+"\n";function Nt(t,n,e){return void 0===Ft&&(Ft=kt(["inputTensor1","inputTensor2"],Kt)),Ot(Ft,e,{inputTensor1:t,inputTensor2:n})}var Rt,qt="\nuniform int k;\n\nfloat process(int index[10]) {\n  int ix1[10];\n  "+bt("ix1")+"\n  ix1[0] = index[0];\n\n  int ix2["+"10];\n  "+bt("ix2")+"\n  ix2[1] = index[1];\n\n  float res = 0.0;\n\n  for (int i = 0; i < "+"10000000; i++) {\n    if (i >= k) {\n      break;\n    }\n    ix1[1] = i;\n    ix2[0] = i;\n\n    float v1 = _input1(ix1);\n    float v2 = _input2(ix2);\n    res += v1*v2;\n  }\n\n  return res;\n}\n\n"+xt+"\n";function Wt(t,n){void 0===Bt&&(Bt=kt(["input1","input2"],qt,[{name:"k"}]));var e=[t.getShape()[0],n.getShape()[1]];return Ot(Bt,e,{input1:t,input2:n},{k:t.getShape()[1]})}function Lt(t,n,e){return void 0===n&&(n=function(t){return""}),void 0===e&&(e=function(t){return t}),"\nuniform int mappedInputStrides[10];\nuniform int sumDims[10];\nuniform int sumSize;\n\n\nfloat process(int index[10]) {\n  int inputIx[10];\n  "+bt("inputIx")+"\n\n  int inputPos = 0;\n  for (int i = 0; i < "+"10; i++) {\n    if (mappedInputStrides[i] == -1 || index[i] == -1) {\n      break;\n    }\n    inputPos += mappedInputStrides[i]*index[i];\n  }\n\n  "+wt("stridesinput1","inputIx","inputPos")+"\n\n  float res = 0.0;\n\n  for (int i = 0; i < "+"10000000; i++) {\n    if (i >= sumSize) {\n      break;\n    }\n    float curr = _input1(inputIx);\n    if (i == 0) {\n      res = "+e("curr")+";\n    } else {\n      res = "+t("curr","res")+";\n    }\n\n    "+("\n  for (int i = 0; i < 10; i++) {\n    if ("+(o="sumDims")+"[i] == 1) {\n      "+(r="inputIx")+"[i] += 1;\n      if ("+r+"[i] >= "+"shapeinput1"+"[i]) {\n        "+r+"[i] = 0;\n      } else {\n        break;\n      }\n    } else if ("+o+"[i] == -1) {\n      break;\n    }\n  }\n  \n  }\n\n  ")+n("res")+"\n\n  return res;\n}\n\n"+xt+"\n";var r,o}function Ht(t){return kt(["input1"],t,[{name:"mappedInputStrides",length:ht},{name:"sumDims",length:ht},{name:"sumSize"}])}function Jt(t,n,e,r){for(var o=D(t.getShape(),n,e),i=o[0],a=o[1],u=O(t.shape),s=[],c=0,l=a;c<l.length;c++){var f=l[c];s.push(u[f])}var p=1,h=new Array(t.shape.length).fill(0);for(f=0;f<n.length;f++)h[n[f]]=1,p*=t.shape[n[f]];return Ot(r,i,{input1:t},{mappedInputStrides:yt(s),sumDims:yt(h),sumSize:p})}var Yt,Qt=Lt((function(t,n){return t+" + "+n}));function Xt(t,n,e){return void 0===Rt&&(Rt=Ht(Qt)),Jt(t,n,e,Rt)}var Zt,$t=Lt((function(t,n){return t+" * "+n}));function tn(t,n,e){return void 0===Yt&&(Yt=Ht($t)),Jt(t,n,e,Yt)}var nn,en=Lt((function(t,n){return"max("+t+", "+n+")"}));function rn(t,n,e){return void 0===Zt&&(Zt=Ht(en)),Jt(t,n,e,Zt)}var on,an,un=Lt((function(t,n){return"min("+t+", "+n+")"}));function sn(t,n,e){return void 0===nn&&(nn=Ht(un)),Jt(t,n,e,nn)}var cn="\nuniform int CG;\nuniform int kernelSize;\nuniform int dataRank;\nuniform int C;\nuniform int dilations[10];\nuniform int pads[10];\nuniform int strides[10];\n",ln="\n  int n = index[0];\n  int m = index[1];\n\n  int kernelIx[10];\n  "+bt("kernelIx")+"\n  for (int i = 0; i < "+"10; i++) {\n    if (i >= dataRank) {\n      break;\n    }\n    kernelIx[i+2] = 0;\n  }\n  kernelIx[0] = m;\n  int inputIx["+"10];\n  "+bt("inputIx")+"\n  inputIx[0] = n;\n\n  for (int cg = 0; cg < "+"10000000; cg++) {\n    if (cg >= CG) {\n      break;\n    }\n    int c = m * CG + cg;\n    int d = c/C;\n    c = c - d*C;\n    inputIx[1] = c;\n    kernelIx[1] = cg;\n    for (int kIx = 0; kIx < "+"10000000; kIx++) {\n      if (kIx >= kernelSize) {\n        break;\n      }\n\n      bool skip = false;\n\n      \nfor (int d = 0; d < 8; d++) {\n  int stride = strides[d];\n  int pad = pads[d];\n  int dilation = dilations[d];\n  if (stride == -1) {\n    break;\n  }\n\n  inputIx[d+2] = index[d+2]*stride - pad + kernelIx[d+2]*dilation;\n  if (inputIx[d+2] < 0 || inputIx[d+2] >= shapex[d+2]) {\n    skip = true;\n    break;\n  }\n}\n\n\n      if (!skip) {\n        res += _x(inputIx) * _kernel(kernelIx);\n      }\n\n      "+gt("kernelIx","shapekernel")+"\n    }\n  }\n",fn="\n"+cn+"\n\nfloat process(int index["+"10]) {\n  int biasIndex["+"10];\n  "+bt("biasIndex")+"\n  biasIndex[0] = index[1];\n  float res = _bias(biasIndex);\n\n  "+ln+"\n\n  return res;\n}\n\n"+xt+"\n",pn="\n"+cn+"\n\nfloat process(int index["+"10]) {\n  float res = 0.0;\n\n  "+ln+"\n\n  return res;\n}\n\n"+xt+"\n";function hn(t,n,e,r,o,i,a){void 0===on&&function(){var t=[{name:"CG"},{name:"kernelSize"},{name:"dataRank"},{name:"C"},{name:"dilations",length:ht},{name:"pads",length:ht},{name:"strides",length:ht}];an=kt(["x","kernel","bias"],fn,t),on=kt(["x","kernel"],pn,t)}();var u=t.shape[0],s=t.shape[1],c=t.shape.slice(2),l=n.shape.slice(2),f=n.shape[0],p=n.shape[1],h=k(l),y=M(c,l,o.slice(0,o.length/2),o.slice(o.length/2),e,i),d=[u,f];d=d.concat(y);var v={x:t,kernel:n};return a&&(v.bias=a),Ot(a?an:on,d,v,{kernelSize:h,CG:p,dataRank:c.length,C:s,dilations:yt(e),pads:yt(o.slice(0,o.length/2)),strides:yt(i)})}var yn,dn=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},vn="\nuniform int axis;\n\nfloat process(int index[10]) {\n  float res = 0.0;\n  for (int i = 0; i < 10; i++) {\n    if (i == axis) {\n      if (index[i] >= shapeinputTensor1[i]) {\n        index[i] = index[i] - shapeinputTensor1[i];\n        res += _inputTensor2(index);\n      } else {\n        res += _inputTensor1(index);\n      }\n      break;\n    }\n  }\n  return res;\n}\n\n"+xt+"\n";function wn(t,n,e){void 0===yn&&(yn=kt(["inputTensor1","inputTensor2"],vn,[{name:"axis"}]));var r=dn(t.shape);return r[e]+=n.shape[e],Ot(yn,r,{inputTensor1:t,inputTensor2:n},{axis:e})}var bn,gn,mn,xn=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},_n="\nuniform int M;\nuniform int N;\nuniform int O;\nuniform int rank;\nuniform int aTranspose;\nuniform int bTranspose;\nuniform float alpha;\nuniform float beta;\n",kn="\nint ixA[10];\n  "+bt("ixA")+"\n  int ixB["+"10];\n  "+bt("ixA")+"\n  for (int i = 0; i < "+"10; i++) {\n    if (i >= rank - 2) {\n      break;\n    }\n    ixA[i] = index[i];\n    ixB[i] = index[i];\n  }\n\n  int m = 0;\n  int o = 0;\n  for (int i = 0; i < "+"10; i++) {\n    if (i == rank-2) {\n      m = index[i];\n      o = index[i+1];\n\n      if (aTranspose == 0) {\n        ixA[i] = m;\n      } else {\n        ixA[i+1] = m;\n      }\n\n      if (bTranspose == 0) {\n        ixB[i+1] = o;\n      } else {\n        ixB[i] = o;\n      }\n\n      break;\n    }\n  }\n\n  float res = 0.0;\n\n  for (int n = 0; n < "+"10000000; n++) {\n    if (n >= N) {\n      break;\n    }\n    for (int i = 0; i < "+"10; i++) {\n      if (i == rank-2) {\n        if (aTranspose == 0) {\n          ixA[i+1] = n;\n        } else {\n          ixA[i] = n;\n        }\n\n        if (bTranspose == 0) {\n          ixB[i] = n;\n        } else {\n          ixB[i+1] = n;\n        }\n\n        break;\n      }\n    }\n    res += _a(ixA) * _b(ixB);\n  }\n\n  res = res*alpha;\n",On="\n"+_n+"\n\nfloat process(int index["+"10]) {\n  "+kn+"\n\n  return res;\n}\n\n"+xt+"\n",An="\n"+_n+"\n\nfloat process(int index["+"10]) {\n  "+kn+"\n\n  res += beta*_c(index);\n\n  return res;\n}\n\n"+xt+"\n";function Pn(t,n,e,r,o,i,a){void 0===bn&&function(){var t=[{name:"M"},{name:"N"},{name:"O"},{name:"rank"},{name:"aTranspose"},{name:"bTranspose"},{name:"alpha"},{name:"beta"}];bn=kt(["a","b"],On,t),gn=kt(["a","b","c"],An,t)}();var u=t.shape.length,s=e?t.shape[u-1]:t.shape[u-2],c=e?t.shape[u-2]:t.shape[u-1],l=r?n.shape[u-2]:n.shape[u-1],f=t.shape.slice(0,u-2),p=xn(f,[s,l]),h={M:s,N:c,O:l,rank:u,aTranspose:e?1:0,bTranspose:r?1:0,alpha:o,beta:i};return void 0!==a?Ot(gn,p,{a:t,b:n,c:a},h):Ot(bn,p,{a:t,b:n},h)}var Sn;function Tn(t){return void 0===mn&&(mn=kt(["inputTensor"],"\nvoid main() {\n  gl_FragColor = abs(texture2D(inputTensor, uv));\n}")),Ot(mn,t.getShape(),{inputTensor:t})}var In,jn="\nuniform int mappedStrides[10];\n\nfloat process(int index[10]) {\n  return getValueAt(index, mappedStrides, widthx, heightx, x);\n}\n\n"+xt+"\n";function Cn(t,n){void 0===Sn&&(Sn=kt(["x"],jn,[{name:"mappedStrides",length:ht}]));for(var e=t.shape.length,r=new Array(e),o=0;o<e;o++)r[o]=t.shape[n[o]];var i=O(t.shape),a=new Array(e);for(o=0;o<e;o++)a[o]=i[n[o]];return Ot(Sn,r,{x:t},{mappedStrides:yt(a)})}var En,Mn="\nfloat process(int index[10]) {\n  return pow(_inputTensor1(index), _inputTensor2(index));\n}\n\n"+xt+"\n";function Vn(t,n,e){return void 0===In&&(In=kt(["inputTensor1","inputTensor2"],Mn)),Ot(In,e,{inputTensor1:t,inputTensor2:n})}var Un,zn,Fn,Gn="\n\nuniform int kernelSize;\nuniform int dataRank;\nuniform int includePad;\nuniform int kernelShape[10];\nuniform int pads[10];\nuniform int strides[10];\n\n\nfloat process(int index[10]) {\n  float res = 0.0;\n  int count = 0;\n\n  int n = index[0];\n  int c = index[1];\n\n  int kernelIx[10];\n  "+bt("kernelIx")+"\n  for (int i = 0; i < "+"10; i++) {\n    if (i >= dataRank) {\n      break;\n    }\n    kernelIx[i] = 0;\n  }\n  int inputIx["+"10];\n  "+bt("inputIx")+"\n  inputIx[0] = n;\n  inputIx[1] = c;\n\n  for (int kIx = 0; kIx < "+"10000000; kIx++) {\n    if (kIx >= kernelSize) {\n      break;\n    }\n\n    bool skip = false;\n\n    \nfor (int d = 0; d < 8; d++) {\n  int stride = strides[d];\n  int pad = pads[d];\n  if (stride == -1) {\n    break;\n  }\n\n  inputIx[d+2] = index[d+2]*stride - pad + kernelIx[d];\n  if (inputIx[d+2] < 0 || inputIx[d+2] >= shapex[d+2]) {\n    skip = true;\n    break;\n  }\n}\n\n\n    if (!skip) {\n      res += _x(inputIx);\n    }\n\n    if (!skip || includePad == 1) {\n      count += 1;\n    }\n\n    "+gt("kernelIx","kernelShape")+"\n  }\n\n  res = res / float(count);\n\n  return res;\n}\n\n"+xt+"\n";function Dn(t,n,e,r,o){void 0===En&&(En=kt(["x"],Gn,[{name:"kernelSize"},{name:"dataRank"},{name:"includePad"},{name:"pads",length:ht},{name:"strides",length:ht},{name:"kernelShape",length:ht}]));var i=t.shape.length-2,a=t.shape[0],u=t.shape[1],s=t.shape.slice(2),c=k(n),l=M(s,n,e.slice(0,e.length/2),e.slice(e.length/2),new Array(i).fill(1),r),f=[a,u];return f=f.concat(l),Ot(En,f,{x:t},{kernelSize:c,kernelShape:yt(n),dataRank:s.length,pads:yt(e.slice(0,e.length/2)),strides:yt(r),includePad:o?1:0})}var Bn;function Kn(t,n,e){return void 0===Un&&(Un=kt(["inputTensor"],"\nuniform float minVal;\nuniform float maxVal;\n\nvoid main() {\n  vec4 maxVec = vec4(maxVal,maxVal,maxVal,maxVal);\n  vec4 minVec = vec4(minVal,minVal,minVal,minVal);\n\n  gl_FragColor = min(maxVec, max(minVec, texture2D(inputTensor, uv)));\n}",[{name:"minVal"},{name:"maxVal"}]),zn=kt(["inputTensor"],"\nuniform float minVal;\n\nvoid main() {\n  vec4 minVec = vec4(minVal,minVal,minVal,minVal);\n\n  gl_FragColor = max(minVec, texture2D(inputTensor, uv));\n}",[{name:"minVal"}]),Fn=kt(["inputTensor"],"\nuniform float maxVal;\n\nvoid main() {\n  vec4 maxVec = vec4(maxVal,maxVal,maxVal,maxVal);\n\n  gl_FragColor = min(maxVec, texture2D(inputTensor, uv));\n}",[{name:"maxVal"}])),void 0!==n&&void 0!==e?Ot(Un,t.getShape(),{inputTensor:t},{minVal:n,maxVal:e}):void 0!==n?Ot(zn,t.getShape(),{inputTensor:t},{minVal:n}):void 0!==e?Ot(Fn,t.getShape(),{inputTensor:t},{maxVal:e}):t.copy()}var Nn,Rn=Lt((function(t,n){return t+" + "+n}),(function(t){return t+" = "+t+"/float(sumSize);"}));function qn(t,n,e){return void 0===Bn&&(Bn=Ht(Rn)),Jt(t,n,e,Bn)}var Wn,Ln="\nuniform int repeats[10];\n\nfloat process(int index[10]) {\n  int inIndex[10];\n  "+bt("inIndex")+"\n  for (int i = 0; i < "+"10; i++) {\n    if (repeats[i] == -1) {\n      break;\n    }\n    int d = index[i] / shapex[i];\n    inIndex[i] = index[i] - d*shapex[i];\n  }\n\n  return _x(inIndex);\n}\n\n"+xt+"\n";function Hn(t,n){void 0===Nn&&(Nn=kt(["x"],Ln,[{name:"repeats",length:ht}]));for(var e=t.shape.length,r=new Array(e),o=0;o<e;o++)r[o]=t.shape[o]*n[o];return Ot(Nn,r,{x:t},{repeats:dt(n)})}var Jn="\nfloat process(int index[10]) {\n  return _x(index);\n}\n\n"+xt+"\n";function Yn(t,n){return void 0===Wn&&(Wn=kt(["x"],Jn)),Ot(Wn,n,{x:t})}var Qn,Xn,Zn=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function $n(t,n){return void 0===Qn&&(Qn=kt(["inputTensor"],"\nvoid main() {\n  gl_FragColor = texture2D(inputTensor, uv);\n}")),void 0===n&&(n=Zn(t.getShape())),Ot(Qn,n,{inputTensor:t})}var te,ne=Lt((function(t,n){return"("+t+"*"+t+") + "+n}),(function(t){return t+" = "+t+"/float(sumSize);"}),(function(t){return t+"*"+t}));function ee(t,n,e){return void 0===Xn&&(Xn=Ht(ne)),Jt(t,n,e,Xn)}var re=Lt((function(t,n){return"("+t+"*"+t+") + "+n}),void 0,(function(t){return t+"*"+t}));function oe(t,n,e){return void 0===te&&(te=Ht(re)),Jt(t,n,e,te)}var ie,ae,ue,se,ce=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},le="\nuniform int pads[20];\nuniform float value;\n\nfloat process(int index[10]) {\n  float res = value;\n  int inputIx[10];\n  "+bt("inputIx")+"\n  int outOfBounds = 0;\n  for (int i = 0; i < "+"10; i++) {\n    if (index[i] == -1) {\n      break;\n    }\n    inputIx[i] = index[i] - pads[i];\n    if (inputIx[i] < 0 || inputIx[i] >= shapex[i]) {\n      outOfBounds = 1;\n      break;\n    }\n  }\n\n  if (outOfBounds == 0) {\n    res = _x(inputIx);\n  }\n\n  return res;\n}\n\n"+xt+"\n",fe="\nuniform int pads[20];\n\nfloat process(int index[10]) {\n  int inputIx[10];\n  "+bt("inputIx")+"\n  for (int i = 0; i < "+"10; i++) {\n    if (index[i] == -1) {\n      break;\n    }\n    inputIx[i] = index[i] - pads[i];\n    if (inputIx[i] < 0) {\n      inputIx[i] = -inputIx[i];\n    } else if (inputIx[i] >= shapex[i]) {\n      inputIx[i] = 2*shapex[i] - inputIx[i] - 2;\n    }\n  }\n\n  return _x(inputIx);\n}\n\n"+xt+"\n",pe="\nuniform int pads[20];\n\nfloat process(int index[10]) {\n  int inputIx[10];\n  "+bt("inputIx")+"\n  for (int i = 0; i < "+"10; i++) {\n    if (index[i] == -1) {\n      break;\n    }\n    inputIx[i] = index[i] - pads[i];\n    if (inputIx[i] < 0) {\n      inputIx[i] = 0;\n    } else if (inputIx[i] >= shapex[i]) {\n      inputIx[i] = shapex[i] - 1;\n    }\n  }\n\n  return _x(inputIx);\n}\n\n"+xt+"\n";function he(t,n,e,r){void 0===ie&&(ie=kt(["x"],le,[{name:"pads",length:20},{name:"value"}]),ae=kt(["x"],fe,[{name:"pads",length:20}]),ue=kt(["x"],pe,[{name:"pads",length:20}]));for(var o=t.shape.length,i=ce(t.shape),a=0;a<o;a++)i[a]+=n[a]+n[a+o];return"constant"===e?Ot(ie,i,{x:t},{pads:dt(n,20),value:r}):Ot("reflect"===e?ae:ue,i,{x:t},{pads:dt(n,20)})}var ye,de=10,ve="\nuniform int axis;\nuniform int indexValues[10];\n\nuniform int mappedIndexStrides[10];\nuniform int mappedInputStrides[10];\n\nfloat process(int index[10]) {\n  int inputPos = 0;\n  int indexPos = 0;\n\n  int strideAxis = 0;\n  for (int i = 0; i < 10; i++) {\n    if (index[i] == -1) {\n      break;\n    }\n    if (i == axis) {\n      strideAxis = stridesx[i];\n    }\n    inputPos += mappedInputStrides[i]*index[i];\n    indexPos += mappedIndexStrides[i]*index[i];\n  }\n\n  for (int i = 0; i < 10; i++) {\n    if (i == indexPos) {\n      inputPos += indexValues[i]*strideAxis;\n      break;\n    }\n  }\n\n  return getValueAtPos(inputPos, widthx, heightx, x);\n}\n\n"+xt+"\n";function we(t,n,e){if(e.size>de)throw new Error("Gather on GPU can deal with at most 10 indices, input had "+e.size);void 0===se&&(se=kt(["x"],ve,[{name:"axis"},{name:"indexValues",length:de},{name:"mappedInputStrides",length:ht},{name:"mappedIndexStrides",length:ht}]));for(var r=t.shape.length,o=e.shape.length,i=O(t.shape),a=O(e.shape),u=r+o-1,s=new Array(u),c=new Array(u).fill(0),l=new Array(u).fill(0),f=0;f<n;f++)s[f]=t.shape[f],c[f]=i[f],l[f]=0;for(f=0;f<o;f++)s[f+n]=e.shape[f],l[f+n]=a[f],c[f+n]=0;for(f=n+1;f<r;f++)s[f+o-1]=t.shape[f],c[f+o-1]=i[f],l[f+o-1]=0;return Ot(se,s,{x:t},{axis:n,indexValues:yt(Array.from(e.values),de),mappedInputStrides:yt(c),mappedIndexStrides:yt(l)})}var be;function ge(t){return void 0===ye&&(ye=kt(["inputTensor"],"\nvoid main() {\n  gl_FragColor = floor(texture2D(inputTensor, uv));\n}")),Ot(ye,t.getShape(),{inputTensor:t})}function me(t){return void 0===be&&(be=kt(["inputTensor"],"\nvoid main() {\n  gl_FragColor = ceil(texture2D(inputTensor, uv));\n}")),Ot(be,t.getShape(),{inputTensor:t})}var xe,_e=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},ke="\nuniform int offsets[10];\n\nfloat process(int index[10]) {\n  int inIx[10];\n  "+bt("inIx")+"\n  for (int i = 0; i < "+"10; i++) {\n    if (index[i] == -1) {\n      break;\n    }\n\n    inIx[i] = index[i] + offsets[i];\n  }\n\n  return _x(inIx);\n}\n\n"+xt+"\n";function Oe(t,n,e,r){void 0===xe&&(xe=kt(["x"],ke,[{name:"offsets",length:ht}]));for(var o=t.shape.length,i=_e(t.shape),a=new Array(o).fill(0),u=0,s=0;s<o&&u<r.length;s++)s==r[u]&&(i[s]=e[u]-n[u],a[s]=n[u],u++);return Ot(xe,i,{x:t},{offsets:yt(a)})}var Ae,Pe=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Se="\nuniform float scales[10];\n\nfloat process(int index[10]) {\n  int inIx[10];\n  "+bt("inIx")+"\n\n  for (int i = 0; i < "+"10; i++) {\n    if (index[i] == -1) {\n      break;\n    }\n\n    inIx[i] = int(floor(float(index[i]) / scales[i]));\n  }\n\n  return _x(inIx);\n}\n\n"+xt+"\n";function Te(t,n){void 0===Ae&&(Ae=kt(["x"],Se,[{name:"scales",length:ht}]));for(var e=t.shape.length,r=Pe(t.shape),o=0;o<e;o++)r[o]=Math.floor(r[o]*n[o]);return Ot(Ae,r,{x:t},{scales:dt(n)})}var Ie,je=function(){return(je=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},Ce="\nuniform int nChannels;\nvoid main() {\n  int x = (fromFloat(uv.x*float(widthOutput*2))-1)/2;\n  int y = (fromFloat(uv.y*float(heightOutput*2))-1)/2;\n\n  int inIx[10];\n  "+bt("inIx")+"\n\n  inIx[0] = y;\n  inIx[1] = x;\n  inIx[2] = 0;\n\n  float a = _inputTensor(inIx);\n  float b = 0.0;\n  float c = 0.0;\n  float d = 255.0;\n\n  if (nChannels >= 2) {\n    inIx[2] = 1;\n    b = _inputTensor(inIx);\n  }\n  if (nChannels >= 3) {\n    inIx[2] = 2;\n    c = _inputTensor(inIx);\n  }\n  if (nChannels >= 4) {\n    inIx[2] = 3;\n    d = _inputTensor(inIx);\n  }\n\n  gl_FragColor = vec4(a,b,c,d);\n}";function Ee(t){return void 0===Ie&&(Ie=kt(["inputTensor"],Ce,[{name:"nChannels"}])),function(t){var n=ct.allocateOfDimensions(t.shape[1],t.shape[0]),e={};e.sizeinputTensor=t.size,e.widthinputTensor=t.memory.width,e.heightinputTensor=t.memory.height,e.stridesinputTensor=yt(O(t.shape)),e.shapeinputTensor=dt(t.shape),e.rankinputTensor=t.shape.length;var r=[t.shape[0],t.shape[1],4];return e.sizeOutput=n.size,e.widthOutput=n.width,e.heightOutput=n.height,e.stridesOutput=yt(O(r)),e.shapeOutput=dt(r),e.rankOutput=r.length,Ie(je({framebuffer:n.frameBuffer,inputTensor:t.memory.frameBuffer,nChannels:t.shape[2]},e)),new Ke(n,r)}(t)}var Me,Ve=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Ue="\nuniform float epsilon;\n\nfloat process(int index[10]) {\n  float result = _x(index) - _mean(index);\n  result = result / sqrt(_variance(index) + epsilon);\n  result = result * _scale(index) + _bias(index);\n  return result;\n}\n\n"+xt+"\n";function ze(t,n,e,r,o,i){void 0===Me&&(Me=kt(["x","mean","variance","scale","bias"],Ue,[{name:"epsilon"}]));var a=Ve(t.shape);return Ot(Me,a,{x:t,mean:n,variance:e,scale:o,bias:i},{epsilon:r})}var Fe,Ge=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),De=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Be=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ke=function(t){function n(n,e){var r=t.call(this)||this;return r.deleted=!1,r.size=k(e),r.shape=e,n instanceof Float32Array?r.memory=ct.allocateTexture(n):r.memory=n,r}return Ge(n,t),n.fromData=function(t){var e=st.texture({data:t,format:"rgba",type:"float"}),r=ct.allocateFramebuffer(e),o=e.width;return new n(r,[e.height,o,4])},n.prototype.toTexture=function(){return Ee(this)},n.prototype.getValues=function(){var t=this;return new Promise((function(n,e){st({framebuffer:t.memory.frameBuffer})((function(){var e=new Float32Array(t.memory.size);e=st.read(e),n(e.subarray(0,t.size))}))}))},n.prototype.getShape=function(){return this.shape},n.prototype.gpu=function(){return De(this,void 0,void 0,(function(){return Be(this,(function(t){return[2,this]}))}))},n.prototype.delete=function(){this.deleted=!0,ct.deallocate(this.memory),this.memory=void 0},n.prototype.copy=function(){return $n(this)},n.prototype.exp=function(){return Pt(this)},n.prototype.log=function(){return Tt(this)},n.prototype.sqrt=function(){return jt(this)},n.prototype.abs=function(){return Tn(this)},n.prototype.floor=function(){return ge(this)},n.prototype.ceil=function(){return me(this)},n.prototype.add_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only add GPU tensor to GPU tensor");return Mt(t,e,r)},n.prototype.subtract_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only subtract GPU tensor from GPU tensor");return zt(t,e,r)},n.prototype.multiply_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only multiply GPU tensor with GPU tensor");return Dt(t,e,r)},n.prototype.divide_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only divide GPU tensor by GPU tensor");return Nt(t,e,r)},n.prototype.power_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only take GPU tensor to power of GPU tensor");return Vn(t,e,r)},n.prototype.matMul=function(t){if(!(t instanceof n))throw new Error("Can only matrix multiply GPU tensor to GPU tensor");return Wt(this,t)},n.prototype.gemm_impl=function(t,e,r,o,i,a){if(!(t instanceof n&&(void 0===a||a instanceof n)))throw new Error("Can only do gemm with CPU tensors");return Pn(this,t,e,r,o,i,a)},n.prototype.sum_impl=function(t,n){return Xt(this,t,n)},n.prototype.sumSquare_impl=function(t,n){return oe(this,t,n)},n.prototype.reduceMean_impl=function(t,n){return qn(this,t,n)},n.prototype.reduceMeanSquare_impl=function(t,n){return ee(this,t,n)},n.prototype.product_impl=function(t,n){return tn(this,t,n)},n.prototype.max_impl=function(t,n){return rn(this,t,n)},n.prototype.min_impl=function(t,n){return sn(this,t,n)},n.prototype.conv_impl=function(t,e,r,o,i,a){if(!(t instanceof n)||void 0!==a&&!(a instanceof n))throw new Error("Can only do convolution of GPU tensor with GPU tensor");return hn(this,t,e,0,o,i,a)},n.prototype.averagePool_impl=function(t,n,e,r){return Dn(this,t,n,e,r)},n.prototype.reshape_impl=function(t,e){return e?$n(this,t):new n(this.memory,t)},n.prototype.concat=function(t,e){if(!(t instanceof n))throw new Error("Can only concat GPU tensor to GPU tensor");return wn(this,t,e)},n.prototype.transpose_impl=function(t){return Cn(this,t)},n.prototype.clip=function(t,n){return Kn(this,t,n)},n.prototype.repeat=function(t){return Hn(this,t)},n.prototype.expand=function(t){var n=this.alignShapes(this.shape,t),e=n[0],r=(n[1],n[2]);return P(this.shape,r)?this.copy():Yn(this.reshape(e,!1),r)},n.prototype.pad_impl=function(t,n,e){return he(this,t,n,e)},n.prototype.gather=function(t,n){return we(this,t,n)},n.prototype.slice_impl=function(t,n,e){return Oe(this,t,n,e)},n.prototype.upsample=function(t){return Te(this,t)},n.prototype.normalize=function(t,e,r,o,i){if(!(t instanceof n)||!(e instanceof n)||!(o instanceof n)||!(i instanceof n))throw new Error("Can only normalize with CPU tensors");return ze(this,t,e,r,o,i)},n}(C),Ne=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Re=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},qe=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},We=new Promise((function(t,n){e.e(3).then(e.bind(null,46)).then((function(n){Fe=n.Tensor,t()}))})),Le=function(t){function n(n,e){var r=t.call(this)||this;if(n instanceof Float32Array){if(void 0===e)throw new Error("Need the shape when creating a Wasm tensor from values");r.wasmTensor=Fe.create(e,n)}else r.wasmTensor=n;return r}return Ne(n,t),n.prototype.getValues=function(){return Promise.resolve(this.wasmTensor.get_vals())},n.prototype.getShape=function(){return Array.from(this.wasmTensor.get_shape())},n.prototype.wasm=function(){return Re(this,void 0,void 0,(function(){return qe(this,(function(t){return[2,this]}))}))},n.prototype.delete=function(){this.wasmTensor.free(),this.wasmTensor=void 0},n.prototype.copy=function(){return new n(this.wasmTensor.copy())},n.prototype.exp=function(){return new n(this.wasmTensor.exp())},n.prototype.log=function(){return new n(this.wasmTensor.log())},n.prototype.sqrt=function(){return new n(this.wasmTensor.sqrt())},n.prototype.abs=function(){return new n(this.wasmTensor.abs())},n.prototype.add_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only add WASM tensor to WASM tensor");return new n(t.wasmTensor.addition(e.wasmTensor))},n.prototype.subtract_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only subtract WASM tensor from WASM tensor");return new n(t.wasmTensor.subtraction(e.wasmTensor))},n.prototype.multiply_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only multiply WASM tensor with WASM tensor");return new n(t.wasmTensor.multiply(e.wasmTensor))},n.prototype.divide_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only divide WASM tensor by WASM tensor");return new n(t.wasmTensor.divide(e.wasmTensor))},n.prototype.power_impl=function(t,e,r){if(!(e instanceof n)||!(t instanceof n))throw new Error("Can only take WASM tensor to power of WASM tensor");return new n(t.wasmTensor.power(e.wasmTensor))},n.prototype.matMul=function(t){if(!(t instanceof n))throw new Error("Can only add WASM tensor to WASM tensor");return new n(this.wasmTensor.matmul(t.wasmTensor))},n.prototype.gemm_impl=function(t,e,r,o,i,a){if(!(t instanceof n&&(void 0===a||a instanceof n)))throw new Error("Can only do gemm with CPU tensors");return new n(void 0!==a?this.wasmTensor.gemm_with_c(t.wasmTensor,e,r,o,a.wasmTensor,i):this.wasmTensor.gemm(t.wasmTensor,e,r,o))},n.prototype.sum_impl=function(t,e){return new n(this.wasmTensor.sum(new Uint32Array(t),e))},n.prototype.sumSquare_impl=function(t,e){return new n(this.wasmTensor.sum_square(new Uint32Array(t),e))},n.prototype.product_impl=function(t,e){return new n(this.wasmTensor.product(new Uint32Array(t),e))},n.prototype.max_impl=function(t,e){return new n(this.wasmTensor.max(new Uint32Array(t),e))},n.prototype.min_impl=function(t,e){return new n(this.wasmTensor.min(new Uint32Array(t),e))},n.prototype.reduceMean_impl=function(t,e){return new n(this.wasmTensor.reduce_mean(new Uint32Array(t),e))},n.prototype.reduceMeanSquare_impl=function(t,e){return new n(this.wasmTensor.reduce_mean_square(new Uint32Array(t),e))},n.prototype.conv_impl=function(t,e,r,o,i,a){if(!(t instanceof n)||void 0!==a&&!(a instanceof n))throw new Error("Can only do convolution of CPU tensor with CPU tensor");return new n(void 0!==a?this.wasmTensor.conv_with_bias(t.wasmTensor,a.wasmTensor,new Uint32Array(e),r,new Uint32Array(o),new Uint32Array(i)):this.wasmTensor.conv(t.wasmTensor,new Uint32Array(e),r,new Uint32Array(o),new Uint32Array(i)))},n.prototype.averagePool_impl=function(t,e,r,o){return new n(this.wasmTensor.average_pool(new Uint32Array(t),new Uint32Array(e),new Uint32Array(r),o))},n.prototype.reshape_impl=function(t){var e=new Uint32Array(t);return new n(this.wasmTensor.reshape(e),e)},n.prototype.concat=function(t,e){if(!(t instanceof n))throw new Error("Can only concat WASM tensor to WASM tensor");return new n(this.wasmTensor.concat(t.wasmTensor,e))},n.prototype.transpose_impl=function(t){return new n(this.wasmTensor.transpose(new Uint32Array(t)))},n.prototype.clip=function(t,e){return void 0!==t&&void 0!==e?new n(this.wasmTensor.clip(t,e)):void 0!==t?new n(this.wasmTensor.clip_min(t)):void 0!==e?new n(this.wasmTensor.clip_max(e)):this.copy()},n.prototype.repeat=function(t){return new n(this.wasmTensor.repeat(new Uint32Array(t)))},n.prototype.expand=function(t){var e=this.getShape(),r=this.alignShapes(e,t),o=r[0],i=(r[1],r[2]);return P(e,i)?this.copy():new n(this.reshape(o,!1).wasmTensor.expand(new Uint32Array(i)))},n.prototype.pad_impl=function(t,e,r){return new n(this.wasmTensor.pad(new Uint32Array(t),n.padModeToInt[e],r))},n.prototype.gather=function(t,e){return new n(this.wasmTensor.gather(t,e.values,new Uint32Array(e.shape)))},n.prototype.floor=function(){return new n(this.wasmTensor.floor())},n.prototype.ceil=function(){return new n(this.wasmTensor.ceil())},n.prototype.slice_impl=function(t,e,r){return new n(this.wasmTensor.slice(new Uint32Array(t),new Uint32Array(e),new Uint32Array(r)))},n.prototype.upsample=function(t){return new n(this.wasmTensor.upsample(new Float32Array(t)))},n.prototype.normalize=function(t,e,r,o,i){if(!(t instanceof n)||!(e instanceof n)||!(o instanceof n)||!(i instanceof n))throw new Error("Can only normalize with CPU tensors");return new n(this.wasmTensor.normalize(t.wasmTensor,e.wasmTensor,r,o.wasmTensor,i.wasmTensor))},n.padModeToInt={constant:0,reflect:1,edge:2},n}(C),He=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Je=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function Ye(t){return He(this,void 0,void 0,(function(){var n;return Je(this,(function(e){switch(e.label){case 0:return t instanceof Q?[2,t]:[4,t.getValues()];case 1:return n=e.sent(),[2,new Q(t.getShape(),n)]}}))}))}function Qe(t){return He(this,void 0,void 0,(function(){var n;return Je(this,(function(e){switch(e.label){case 0:return t instanceof Le?[2,t]:[4,t.getValues()];case 1:return n=e.sent(),t instanceof Q&&n instanceof Int32Array?[2,t]:[2,new Le(n,new Uint32Array(t.getShape()))]}}))}))}function Xe(t){return He(this,void 0,void 0,(function(){var n;return Je(this,(function(e){switch(e.label){case 0:return t instanceof Ke?[2,t]:[4,t.getValues()];case 1:return n=e.sent(),t instanceof Q&&n instanceof Int32Array?[2,t]:[2,new Ke(n,t.getShape())]}}))}))}var Ze=e(2),$e=e.n(Ze),tr=e(14),nr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},er=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},rr=function(){function t(t,n,e,r,o){this.attributes={};for(var i=0;i<t.length;i++)this.attributes[t[i].name]=t[i];this.inputs=n,this.outputs=e,this.onnxVersion=o,this.variableInputs=0;for(i=0;i<this.inputs.length;i++)void 0===r[this.inputs[i]]&&this.variableInputs++}return t.prototype.initialize=function(t){},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getAttributeString=function(t){var n=this.attributes[t];if(void 0!==n){var e=n.s;return void 0!==e?new TextDecoder("utf-8").decode(e):void 0}},t.prototype.getAttributeInts=function(t){if(void 0!==this.attributes[t]){for(var n=this.attributes[t].ints,e=0;e<n.length;e++)$e.a.isLong(n[e])&&(n[e]=n[e].toNumber());return n}},t.prototype.getAttributeInt=function(t){var n=this.attributes[t];if(void 0!==n){var e=n.i;return $e.a.isLong(e)&&(e=e.toNumber()),e}},t.prototype.getAttributeFloat=function(t){var n=this.attributes[t];if(void 0!==n)return n.f},t.prototype.getAttributeTensor=function(t){var n=this.attributes[t];if(void 0!==n)return n.t},t.prototype.toCPU=function(){return nr(this,void 0,void 0,(function(){return er(this,(function(t){return[2]}))}))},t.prototype.toWASM=function(){return nr(this,void 0,void 0,(function(){return er(this,(function(t){return[2]}))}))},t.prototype.toGPU=function(){return nr(this,void 0,void 0,(function(){return er(this,(function(t){return[2]}))}))},t}();function or(t){if(void 0!==t.segment&&null!==t.segment)throw new Error("Handling of tensor proto segment not yet implemented");var n=t.dims;if(void 0===n||null===n)throw new Error("Tensor shape must be specified");for(var e=0;e<n.length;e++)$e.a.isLong(n[e])&&(n[e]=n[e].toNumber());0===n.length&&(n=[1]);var r=k(n);if(1===t.dataType){if(t.floatData&&t.floatData.length>0)return new Q(n,t.floatData);if(t.rawData&&t.rawData.length>0){var o=t.rawData.buffer.slice(t.rawData.byteOffset,t.rawData.byteOffset+t.rawData.byteLength),i=new Float32Array(o);return new Q(n,i)}if(0===r)return new Q(n);throw new Error("Cant process float tensor without float or raw data")}if(7===t.dataType){if(t.rawData&&t.rawData.length>0){for(i=new Int32Array(t.rawData.length/8),e=0;e<t.rawData.length;e+=8){var a=$e.a.fromBytesLE(Array.from(t.rawData.slice(e,e+8))).toNumber();i[e/8]=a}return new Q(n,i,"int")}throw new Error("Cant process int64 tensor without raw data")}throw new Error("Handling of tensor type "+t.dataType+" not yet implemented")}var ir=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ar=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},ur=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},sr=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;if(i<11){var u=a.getAttributeTensor("value");a.tensor=or(u)}return a}return ir(n,t),n.prototype.forward=function(t){return ar(this,void 0,void 0,(function(){return ur(this,(function(t){if(this.onnxVersion<11)return[2,[this.tensor]];throw new Error("Constant with onnx version >= 11 not yet implemented")}))}))},n.prototype.toCPU=function(){return ar(this,void 0,void 0,(function(){var t;return ur(this,(function(n){switch(n.label){case 0:return t=this,[4,Ye(this.tensor)];case 1:return t.tensor=n.sent(),[2]}}))}))},n.prototype.toWASM=function(){return ar(this,void 0,void 0,(function(){var t;return ur(this,(function(n){switch(n.label){case 0:return t=this,[4,Qe(this.tensor)];case 1:return t.tensor=n.sent(),[2]}}))}))},n.prototype.toGPU=function(){return ar(this,void 0,void 0,(function(){var t;return ur(this,(function(n){switch(n.label){case 0:return t=this,[4,Xe(this.tensor)];case 1:return t.tensor=n.sent(),[2]}}))}))},n}(rr),cr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),lr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},fr=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},pr=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return cr(n,t),n.prototype.forward=function(t){return lr(this,void 0,void 0,(function(){var n,e;return fr(this,(function(r){if(this.onnxVersion<13&&this.onnxVersion>=7)return n=t[0],e=t[1],[2,[n.add(e)]];throw new Error("Add not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),hr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),yr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},dr=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},vr=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},wr=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return a.epsilon=a.getAttributeFloat("epsilon")||1e-5,a.momentum=a.getAttributeFloat("momentum")||.9,a.epsTensor=new Q([1],[a.epsilon]),a}return hr(n,t),n.prototype.initialize=function(t){var n=t(this.inputs[1]),e=t(this.inputs[2]),r=t(this.inputs[3]),o=t(this.inputs[4]);if(void 0!==n&&void 0!==e&&void 0!==r&&void 0!==o){var i=o.add(this.epsTensor).sqrt();this.scale=n.divide(i),this.bias=e.subtract(r.multiply(this.scale)),i.delete()}},n.prototype.forward=function(t){return yr(this,void 0,void 0,(function(){var n,e,r,o,i,a,u,s,c;return dr(this,(function(l){return n=t[0],void 0!==this.scale?(e=n.multiply(this.scale),c=e.add(this.bias),e.delete(),[2,[c]]):(r=t[1],o=t[2],i=t[3],a=t[4],u=r.getShape()[0],s=vr([1,u],new Array(n.getShape().length-2).fill(1)),r=r.reshape(s,!1),o=o.reshape(s,!1),i=i.reshape(s,!1),a=a.reshape(s,!1),[2,[c=n.normalize(i,a,this.epsilon,r,o)]])}))}))},n.prototype.toCPU=function(){return yr(this,void 0,void 0,(function(){var t,n;return dr(this,(function(e){switch(e.label){case 0:return void 0===this.scale?[3,3]:(t=this,[4,Ye(this.scale)]);case 1:return t.scale=e.sent(),n=this,[4,Ye(this.bias)];case 2:n.bias=e.sent(),e.label=3;case 3:return[2]}}))}))},n.prototype.toWASM=function(){return yr(this,void 0,void 0,(function(){var t,n;return dr(this,(function(e){switch(e.label){case 0:return void 0===this.scale?[3,3]:(t=this,[4,Qe(this.scale)]);case 1:return t.scale=e.sent(),n=this,[4,Qe(this.bias)];case 2:n.bias=e.sent(),e.label=3;case 3:return[2]}}))}))},n.prototype.toGPU=function(){return yr(this,void 0,void 0,(function(){var t,n;return dr(this,(function(e){switch(e.label){case 0:return void 0===this.scale?[3,3]:(t=this,[4,Xe(this.scale)]);case 1:return t.scale=e.sent(),n=this,[4,Xe(this.bias)];case 2:n.bias=e.sent(),e.label=3;case 3:return[2]}}))}))},n}(rr);function br(t,n){if(t.type===n)return t;if("float"===n){for(var e=new Float32Array(t.size),r=0;r<t.size;r++)e[r]=t.get(r);return new Q(t.shape,e,n)}for(e=new Int32Array(t.size),r=0;r<t.size;r++)e[r]=t.get(r);return new Q(t.shape,e,n)}var gr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),mr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},xr=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},_r=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return a.to=a.getAttributeString("to"),a}return gr(n,t),n.prototype.forward=function(t){return mr(this,void 0,void 0,(function(){var n;return xr(this,(function(e){if((n=t[0])instanceof Q)return[2,[br(n,this.to)]];throw new Error("Can only cast CPU tensors right now")}))}))},n}(rr),kr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Or=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Ar=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Pr=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return kr(n,t),n.prototype.forward=function(t){return Or(this,void 0,void 0,(function(){return Ar(this,(function(n){return[2,[t[0].ceil()]]}))}))},n}(rr),Sr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Tr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Ir=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},jr=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return i<11&&(a.min=a.getAttributeFloat("min"),a.max=a.getAttributeFloat("max")),a}return Sr(n,t),n.prototype.forward=function(t){return Tr(this,void 0,void 0,(function(){var n,e,r;return Ir(this,(function(o){if(n=t[0],this.onnxVersion<11)return[2,[n.clip(this.min,this.max)]];if(e=t.length>1?t[1]:void 0,r=t.length>2?t[2]:void 0,void 0===e&&void 0===r)return[2,[n.copy()]];throw new Error("Clip with onnx version >= 11 not yet implemented")}))}))},n}(rr),Cr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Er=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Mr=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Vr=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return i<13&&(a.axis=a.getAttributeInt("axis")),a}return Cr(n,t),n.prototype.forward=function(t){return Er(this,void 0,void 0,(function(){var n,e,r;return Mr(this,(function(o){for(t.length>2&&console.warn("Concat with more than 2 tensors is currently slow. Doing concat with "+t.length+" tensors"),n=t[0],e=1;e<t.length;e++)r=n.concat(t[e],this.axis),e>1&&n.delete(),n=r;return[2,[n]]}))}))},n}(rr),Ur=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),zr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Fr=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Gr=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;if(i<11){var u=a.getAttributeTensor("value");a.tensor=or(u)}return a}return Ur(n,t),n.prototype.forward=function(t){return zr(this,void 0,void 0,(function(){var n,e,r,o,i;return Fr(this,(function(a){if(!((n=t[0])instanceof Q))throw new Error("ConstantOfShape needs cpu tensor as shape tensor");for(e=new Array(n.size),r=0;r<n.size;r++)e[r]=n.get(r);return o=k(e),i=new Float32Array(o).fill(this.tensor.get(0)),[2,[new Q(e,i,this.tensor.type)]]}))}))},n}(rr),Dr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Br=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Kr=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Nr=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;if(void 0!==a.getAttributeString("autoPad"))throw new Error("Autopad in conv not supported yet");return a.group=a.getAttributeInt("group")||1,a.dilations=a.getAttributeInts("dilations"),a.pads=a.getAttributeInts("pads"),a.strides=a.getAttributeInts("strides"),a}return Dr(n,t),n.prototype.forward=function(t){return Br(this,void 0,void 0,(function(){var n,e,r;return Kr(this,(function(o){return n=t[0],e=t[1],r=t.length>2?t[2]:void 0,[2,[n.conv(e,r,this.dilations,this.group,this.pads,this.strides)]]}))}))},n}(rr),Rr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),qr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Wr=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Lr=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return Rr(n,t),n.prototype.forward=function(t){return qr(this,void 0,void 0,(function(){var n,e;return Wr(this,(function(r){if(this.onnxVersion<13&&this.onnxVersion>=7)return n=t[0],e=t[1],[2,[n.divide(e)]];throw new Error("Add not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),Hr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Jr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Yr=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Qr=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return Hr(n,t),n.prototype.forward=function(t){return Jr(this,void 0,void 0,(function(){return Yr(this,(function(n){return[2,[t[0].exp()]]}))}))},n}(rr),Xr=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zr=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},$r=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},to=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return Xr(n,t),n.prototype.forward=function(t){return Zr(this,void 0,void 0,(function(){var n,e,r,o;return $r(this,(function(i){if(this.onnxVersion<13){if(n=t[0],!((e=t[1])instanceof Q))throw new Error("Expand needs cpu tensor as shape tensor");for(r=new Array(e.size),o=0;o<e.size;o++)r[o]=e.get(o);return[2,[n.expand(r)]]}throw new Error("Expand not yet implemented")}))}))},n}(rr),no=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),eo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},ro=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},oo=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return no(n,t),n.prototype.forward=function(t){return eo(this,void 0,void 0,(function(){return ro(this,(function(n){return[2,[t[0].floor()]]}))}))},n}(rr),io=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ao=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},uo=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},so=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return a.axis=a.getAttributeInt("axis")||0,a}return io(n,t),n.prototype.forward=function(t){return ao(this,void 0,void 0,(function(){var n,e;return uo(this,(function(r){if(n=t[0],!((e=t[1])instanceof Q))throw new Error("Gather requires CPU tensor for the indices");return[2,[n.gather(this.axis,e)]]}))}))},n}(rr),co=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),lo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},fo=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},po=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;a.alpha=a.getAttributeFloat("alpha")||1,a.beta=a.getAttributeFloat("beta")||1;var u=a.getAttributeInt("transA"),s=a.getAttributeInt("transB");return a.transA=1===u,a.transB=1===s,a}return co(n,t),n.prototype.forward=function(t){return lo(this,void 0,void 0,(function(){var n,e,r;return fo(this,(function(o){if(this.onnxVersion>=9&&this.onnxVersion<11)return n=t[0],e=t[1],r=t[2],[2,[n.gemm(e,this.transA,this.transB,this.alpha,r,this.beta)]];throw new Error("Gemm is not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),ho=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),yo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},vo=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},wo=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},bo=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return a.epsilon=a.getAttributeFloat("epsilon")||1e-5,a}return ho(n,t),n.prototype.forward=function(t){return yo(this,void 0,void 0,(function(){var n,e,r,o,i,a,u,s,c,l,f,p;return vo(this,(function(h){for(n=t[0],e=t[1],r=t[2],o=n.getShape().length-2,i=e.getShape()[0],a=wo([1,i],new Array(o).fill(1)),e=e.reshape(a,!1),r=r.reshape(a,!1),u=new Array(n.getShape().length-2),s=0;s<o;s++)u[s]=s+2;return c=n.reduceMean(u,!0),ut.flush(),l=n.subtract(c),ut.flush(),f=l.reduceMeanSquare(u,!0),ut.flush(),p=n.normalize(c,f,this.epsilon,e,r),c.delete(),l.delete(),f.delete(),[2,[p]]}))}))},n}(rr),go=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),mo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},xo=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},_o=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return go(n,t),n.prototype.forward=function(t){return mo(this,void 0,void 0,(function(){var n,e;return xo(this,(function(r){if(n=t[0],e=t[1],this.onnxVersion<13&&this.onnxVersion>=9){if(n.getShape().length!==e.getShape().length)throw new Error("Automatic broadcasting in MatMul not supported yet");return[2,[n.gemm(e)]]}throw new Error("Matmul with onnx version "+this.onnxVersion+" not yet implemented")}))}))},n}(rr),ko=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Oo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Ao=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Po=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return ko(n,t),n.prototype.forward=function(t){return Oo(this,void 0,void 0,(function(){var n,e;return Ao(this,(function(r){if(this.onnxVersion<13&&this.onnxVersion>=7)return n=t[0],e=t[1],[2,[n.multiply(e)]];throw new Error("Add not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),So=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),To=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Io=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},jo=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return a.mode=a.getAttributeString("mode")||"constant",a.pads=a.getAttributeInts("pads"),a.value=a.getAttributeFloat("value"),a}return So(n,t),n.prototype.forward=function(t){return To(this,void 0,void 0,(function(){return Io(this,(function(n){if(this.onnxVersion<11)return[2,[t[0].pad(this.pads,this.mode,this.value)]];throw new Error("Pad not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),Co=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Eo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Mo=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Vo=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;a.axes=a.getAttributeInts("axes");var u=a.getAttributeInt("keepdims");return a.keepDims=1===u||void 0===u,a}return Co(n,t),n.prototype.forward=function(t){return Eo(this,void 0,void 0,(function(){return Mo(this,(function(n){if(this.onnxVersion<11)return[2,[t[0].max(this.axes,this.keepDims)]];throw new Error("Reduce max is not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),Uo=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),zo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Fo=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Go=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;a.axes=a.getAttributeInts("axes");var u=a.getAttributeInt("keepdims");return a.keepDims=1===u||void 0===u,a}return Uo(n,t),n.prototype.forward=function(t){return zo(this,void 0,void 0,(function(){return Fo(this,(function(n){if(this.onnxVersion<11)return[2,[t[0].reduceMean(this.axes,this.keepDims)]];throw new Error("Reduce mean is not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),Do=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Bo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Ko=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},No=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;a.axes=a.getAttributeInts("axes");var u=a.getAttributeInt("keepdims");return a.keepDims=1===u||void 0===u,a}return Do(n,t),n.prototype.forward=function(t){return Bo(this,void 0,void 0,(function(){return Ko(this,(function(n){if(this.onnxVersion<11)return[2,[t[0].sum(this.axes,this.keepDims)]];throw new Error("Reduce mean is not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),Ro=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),qo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Wo=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Lo=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;a.axes=a.getAttributeInts("axes");var u=a.getAttributeInt("keepdims");return a.keepDims=1===u||void 0===u,a}return Ro(n,t),n.prototype.forward=function(t){return qo(this,void 0,void 0,(function(){return Wo(this,(function(n){if(this.onnxVersion<11)return[2,[t[0].sumSquare(this.axes,this.keepDims)]];throw new Error("Reduce mean is not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),Ho=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Jo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Yo=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Qo=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return Ho(n,t),n.prototype.forward=function(t){return Jo(this,void 0,void 0,(function(){return Yo(this,(function(n){return[2,[t[0].clip(0)]]}))}))},n}(rr),Xo=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Zo=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},$o=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ti=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return i<13&&(a.shape=a.getAttributeInts("shape")),a}return Xo(n,t),n.prototype.forward=function(t){return Zo(this,void 0,void 0,(function(){var n,e,r,o;return $o(this,(function(i){if(n=t[0],!((e=t[1])instanceof Q))throw new Error("Reshape only works with CPU tensor as shape tensor");if(this.onnxVersion<13){for(r=new Array(e.size),o=0;o<e.size;o++)r[o]=e.get(o);return[2,[n.reshape(r)]]}throw new Error("Reshape with onnx version "+this.onnxVersion+" not yet implemented")}))}))},n}(rr),ni=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ei=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},ri=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},oi=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},ii=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return ni(n,t),n.prototype.forward=function(t){return ei(this,void 0,void 0,(function(){var n,e;return ri(this,(function(r){if(this.onnxVersion<13)return n=t[0],e=n.getShape(),[2,[new Q([e.length],oi(e),"int")]];throw new Error("Shape not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),ai=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ui=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},si=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ci=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return a.axes=a.getAttributeInts("axes"),a.starts=a.getAttributeInts("starts"),a.ends=a.getAttributeInts("ends"),a}return ai(n,t),n.prototype.forward=function(t){return ui(this,void 0,void 0,(function(){return si(this,(function(n){if(this.onnxVersion<11)return[2,[t[0].slice(this.starts,this.ends,this.axes)]];throw new Error("Slice not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),li=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),fi=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},pi=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},hi=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return a.axis=a.getAttributeInt("axis"),a}return li(n,t),n.prototype.forward=function(t){return fi(this,void 0,void 0,(function(){var n,e,r,o,i,a,u,s,c,l;return pi(this,(function(f){return n=t[0],e=n.getShape(),void 0===(r=this.axis)&&(r=this.onnxVersion<13?1:e.length-1),o=e.slice(0,r).reduce((function(t,n){return t*n}),1),i=n.reshape([o,-1],!1),a=i.max(1,!0),u=i.subtract(a),s=u.exp(),c=s.sum(1,!0),l=s.divide(c),a.delete(),u.delete(),s.delete(),c.delete(),[2,[l.reshape(e,!1)]]}))}))},n}(rr),yi=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),di=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},vi=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},wi=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return yi(n,t),n.prototype.forward=function(t){return di(this,void 0,void 0,(function(){var n,e;return vi(this,(function(r){if(this.onnxVersion<13&&this.onnxVersion>=7)return n=t[0],e=t[1],[2,[n.subtract(e)]];throw new Error("Add not implemented for onnx version "+this.onnxVersion)}))}))},n}(rr),bi=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),gi=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},mi=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},xi=function(t){function n(n,e,r,o,i){return t.call(this,n,e,r,o,i)||this}return bi(n,t),n.prototype.forward=function(t){return gi(this,void 0,void 0,(function(){var n,e,r,o;return mi(this,(function(i){if(n=t[0],!((e=t[1])instanceof Q))throw new Error("Tile only works with CPU tensor as repeats");if(this.onnxVersion<13&&this.onnxVersion>=6){for(r=new Array(e.size),o=0;o<e.size;o++)r[o]=e.get(o);return[2,[n.repeat(r)]]}throw new Error("Tile with onnx version "+this.onnxVersion+" not yet implemented")}))}))},n}(rr),_i=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ki=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Oi=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ai=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return a.permutation=a.getAttributeInts("perm"),a}return _i(n,t),n.prototype.forward=function(t){return ki(this,void 0,void 0,(function(){return Oi(this,(function(n){return[2,[t[0].transpose(this.permutation)]]}))}))},n}(rr),Pi=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Si=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Ti=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ii=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;return i<13&&(a.axes=a.getAttributeInts("axes")),a}return Pi(n,t),n.prototype.forward=function(t){return Si(this,void 0,void 0,(function(){var n,e,r,o,i;return Ti(this,(function(a){if(n=t[0],this.onnxVersion<13){for(e=n.getShape(),r=[],o=0,i=0;i<e.length;i++)o<this.axes.length&&this.axes[o]===i&&(r.push(1),o++),r.push(e[i]);return this.axes[this.axes.length-1]===e.length&&r.push(1),[2,[n.reshape(r)]]}throw new Error("Unsqueeze with onnx version "+this.onnxVersion+" not yet implemented")}))}))},n}(rr),ji=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),Ci=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},Ei=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Mi=function(t){function n(n,e,r,o,i){var a=t.call(this,n,e,r,o,i)||this;if(a.mode=a.getAttributeString("mode"),"nearest"!==a.mode)throw new Error("Upsampling only supported with nearest neighbor sampling");return a}return ji(n,t),n.prototype.forward=function(t){return Ci(this,void 0,void 0,(function(){var n,e,r,o,i;return Ei(this,(function(a){switch(a.label){case 0:return n=t[0],(e=t[1])instanceof Q?[3,2]:(console.warn("Scales tensor for upsample not on CPU, need to transfer!"),[4,Ye(e)]);case 1:e=a.sent(),a.label=2;case 2:for(r=e,o=new Array(r.size),i=0;i<r.size;i++)o[i]=r.get(i);return[2,[n.upsample(o)]]}}))}))},n}(rr),Vi={Conv:function(t,n,e,r,o){return new Nr(t,n,e,r,o)},BatchNormalization:function(t,n,e,r,o){return new wr(t,n,e,r,o)},Clip:function(t,n,e,r,o){return new jr(t,n,e,r,o)},Add:function(t,n,e,r,o){return new pr(t,n,e,r,o)},ReduceMean:function(t,n,e,r,o){return new Go(t,n,e,r,o)},Gemm:function(t,n,e,r,o){return new po(t,n,e,r,o)},Constant:function(t,n,e,r,o){return new sr(t,n,e,r,o)},Reshape:function(t,n,e,r,o){return new ti(t,n,e,r,o)},Tile:function(t,n,e,r,o){return new xi(t,n,e,r,o)},MatMul:function(t,n,e,r,o){return new _o(t,n,e,r,o)},Exp:function(t,n,e,r,o){return new Qr(t,n,e,r,o)},ReduceSum:function(t,n,e,r,o){return new No(t,n,e,r,o)},ReduceMax:function(t,n,e,r,o){return new Vo(t,n,e,r,o)},ReduceSumSquare:function(t,n,e,r,o){return new Lo(t,n,e,r,o)},Sub:function(t,n,e,r,o){return new wi(t,n,e,r,o)},Mul:function(t,n,e,r,o){return new Po(t,n,e,r,o)},Div:function(t,n,e,r,o){return new Lr(t,n,e,r,o)},Unsqueeze:function(t,n,e,r,o){return new Ii(t,n,e,r,o)},Concat:function(t,n,e,r,o){return new Vr(t,n,e,r,o)},ConstantOfShape:function(t,n,e,r,o){return new Gr(t,n,e,r,o)},Expand:function(t,n,e,r,o){return new to(t,n,e,r,o)},InstanceNormalization:function(t,n,e,r,o){return new bo(t,n,e,r,o)},Pad:function(t,n,e,r,o){return new jo(t,n,e,r,o)},Relu:function(t,n,e,r,o){return new Qo(t,n,e,r,o)},Shape:function(t,n,e,r,o){return new ii(t,n,e,r,o)},Gather:function(t,n,e,r,o){return new so(t,n,e,r,o)},Cast:function(t,n,e,r,o){return new _r(t,n,e,r,o)},Floor:function(t,n,e,r,o){return new oo(t,n,e,r,o)},Ceil:function(t,n,e,r,o){return new Pr(t,n,e,r,o)},Slice:function(t,n,e,r,o){return new ci(t,n,e,r,o)},Upsample:function(t,n,e,r,o){return new Mi(t,n,e,r,o)},Transpose:function(t,n,e,r,o){return new Ai(t,n,e,r,o)},Softmax:function(t,n,e,r,o){return new hi(t,n,e,r,o)}},Ui=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function a(t){try{s(r.next(t))}catch(n){i(n)}}function u(t){try{s(r.throw(t))}catch(n){i(n)}}function s(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,u)}s((r=r.apply(t,n||[])).next())}))},zi=function(t,n){var e,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Fi=function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},Gi=function(){function t(t,n){var e;this.inputSet=new Set,this.nodes={},this.nodeIds=[],this.defaultReady=[],this.intermediaries={},this.constants={},e=t instanceof ArrayBuffer?new Uint8Array(t):t;var r=tr.onnx.ModelProto.decode(e),o=r.opsetImport[0].version;$e.a.isLong(o)&&(o=o.toNumber()),this.version=o,this.inputs=r.graph.input;for(var i=0;i<this.inputs.length;i++)this.inputSet.add(this.inputs[i].name);this.outputs=r.graph.output.map((function(t){return t.name})),this.initializer(r.graph.initializer),this.initNodes(r),void 0===n&&(n={}),this.noConvertConstants=new Set(void 0!==n.noConvertConstants?n.noConvertConstants:[]),this.noConvertNodes=new Set(void 0!==n.noConvertNodes?n.noConvertNodes:[])}return t.prototype.initNodes=function(t){for(var n=this,e=0;e<t.graph.node.length;e++){var r=t.graph.node[e],o=Vi[r.opType];if(void 0===o)throw new Error("Node operator "+r.opType+" can not be resolved");var i=r.attribute||[],a=r.input||[],u=o(i,a,r.output||[],this.constants,this.version);this.nodes[e]=u,this.nodeIds.push(e);for(var s=0;s<a.length;s++){var c=a[s];void 0===this.intermediaries[c]&&(this.intermediaries[c]={to:[],deletable:!0}),this.intermediaries[c].to.push(e)}0===u.variableInputs&&this.defaultReady.push(e),"Constant"===r.opType&&(void 0===this.intermediaries[r.output[0]]?this.intermediaries[r.output[0]]={to:[],deletable:!1}:this.intermediaries[r.output[0]].deletable=!1)}for(var l=0,f=this.nodeIds;l<f.length;l++){var p=f[l];this.nodes[p].initialize((function(t){return n.resolveConstant(t)}))}},t.prototype.initializer=function(t){for(var n=0;n<t.length;n++){var e=t[n],r=or(e);this.constants[e.name]=r}},t.prototype.forward=function(t,n){return Ui(this,void 0,void 0,(function(){var e,r,o,i,a,u,s,c,l,f,p,h,y,d,v,w,b,g,m=this;return zi(this,(function(x){switch(x.label){case 0:for(e={},r={},o=0,i=this.nodeIds;o<i.length;o++)g=i[o],r[g]={variableInputs:0};for(a=Fi(this.defaultReady),g=0;g<t.length;g++)for(e[this.inputs[g].name]={value:t[g],used:0},w=this.intermediaries[this.inputs[g].name],d=0;d<w.to.length;d++)v=w.to[d],r[v].variableInputs++,r[v].variableInputs===this.nodes[v].variableInputs&&(a.push(v),delete r[v]);x.label=1;case 1:if(!(a.length>0))return[3,8];for(u=[],s=a.shift(),c=this.nodes[s],l=[],g=0;g<c.inputs.length;g++)f=c.inputs[g],void 0!==this.constants[f]?l.push(this.constants[f]):((w=e[f]).used++,w.used===this.intermediaries[f].to.length&&this.intermediaries[f].deletable&&u.push(f),l.push(w.value));p=void 0,x.label=2;case 2:return x.trys.push([2,4,,5]),[4,c.forward(l)];case 3:return p=x.sent(),[3,5];case 4:throw h=x.sent(),console.error("Error occurred in node "+s+" with inputs "+c.inputs+" from nodes "+c.inputs.map((function(t){return m.getNodeWithOutput(t)}))),h;case 5:for(ut.flush(),g=0;g<c.outputs.length;g++)if(y=c.outputs[g],e[y]={value:p[g],used:0},void 0!==(w=this.intermediaries[y]))for(d=0;d<w.to.length;d++)v=w.to[d],r[v].variableInputs++,r[v].variableInputs===this.nodes[v].variableInputs&&(a.push(v),delete r[v]);for(g=0;g<u.length;g++)this.inputSet.has(u[g])||((w=e[u[g]]).value.delete(),delete e[u[g]]);return void 0===n?[3,7]:[4,new Promise((function(t,e){setTimeout(t,n)}))];case 6:x.sent(),x.label=7;case 7:return[3,1];case 8:for(b=[],g=0;g<this.outputs.length;g++)b.push(e[this.outputs[g]].value);return[2,b]}}))}))},t.prototype.getNodeWithOutput=function(t){for(var n=0,e=this.nodeIds;n<e.length;n++){var r=e[n];if(-1!==this.nodes[r].outputs.findIndex((function(n){return n===t})))return r}},t.prototype.resolveConstant=function(t){if(void 0!==this.constants[t])return this.constants[t];var n=this.getNodeWithOutput(t),e=this.nodes[n];return e instanceof sr?e.tensor:void 0},t.prototype.toCPU=function(){return Ui(this,void 0,void 0,(function(){var t,n,e,r,o,i,a,u;return zi(this,(function(s){switch(s.label){case 0:for(n in t=[],this.constants)t.push(n);e=0,s.label=1;case 1:return e<t.length?(u=t[e],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,Ye(this.constants[u])])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return e++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toCPU()]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},t.prototype.toWASM=function(){return Ui(this,void 0,void 0,(function(){var t,n,e,r,o,i,a,u;return zi(this,(function(s){switch(s.label){case 0:for(n in t=[],this.constants)t.push(n);e=0,s.label=1;case 1:return e<t.length?(u=t[e],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,Qe(this.constants[u])])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return e++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toWASM()]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},t.prototype.toGPU=function(){return Ui(this,void 0,void 0,(function(){var t,n,e,r,o,i,a,u;return zi(this,(function(s){switch(s.label){case 0:for(n in t=[],this.constants)t.push(n);e=0,s.label=1;case 1:return e<t.length?(u=t[e],this.noConvertConstants.has(u)?[3,3]:(r=this.constants,o=u,[4,Xe(this.constants[u])])):[3,4];case 2:r[o]=s.sent(),s.label=3;case 3:return e++,[3,1];case 4:i=0,a=this.nodeIds,s.label=5;case 5:return i<a.length?(u=a[i],this.noConvertNodes.has(u)?[3,7]:[4,this.nodes[u].toGPU()]):[3,8];case 6:s.sent(),s.label=7;case 7:return i++,[3,5];case 8:return[2]}}))}))},t}();function Di(t){return Bi.apply(this,arguments)}function Bi(){return(Bi=Object(v.a)(d.a.mark((function t(n){var e,r,o;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("models/".concat(n,".onnx"));case 2:return e=t.sent,t.next=5,e.arrayBuffer();case 5:return r=t.sent,o=new s.model.OnnxModel(r,{noConvertNodes:[69,98]}),t.next=9,o.toGPU();case 9:return t.abrupt("return",o);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ki=["mosaic","candy","pointilism","udnie","rain-princess"],Ni=function(t){Object(x.a)(e,t);var n=Object(_.a)(e);function e(t){var r;return Object(g.a)(this,e),(r=n.call(this,t)).model=void 0,r.scale=new a.gpu.GPUTensor(new Float32Array([255]),[1]),Di("mosaic").then((function(t){r.model=t})),r.setState({scale:50,model:"mosaic"}),r}return Object(m.a)(e,[{key:"getImageData",value:function(){var t,n=this,e=document.getElementById("img");console.log("Reading pixels");var r=a.gpu.GPUTensor.fromData(e),o=r.shape.slice(0,2),i=Object(b.a)(o,2),u=i[0],s=i[1],c=Math.min(s,u),l=Math.floor(c/2),f=Math.floor(s/2)-l,p=Math.floor(u/2)-l,h=r.slice([p,f,0],[p+c,f+c,3],[0,1,2]);r.delete();var y=this.getImageWidth(this.state.scale)/s,d=h.upsample([y,y,1]);h.delete();var v=d.getShape()[0];this.setState(Object(w.a)(Object(w.a)({},this.state),{},{croppedSize:v}));var g=d.transpose([2,0,1]);d.delete();var m=g.multiply(this.scale);g.delete();var x=m.reshape([1,3,v,v],!1);console.log("Doing forward pass"),null===(t=this.model)||void 0===t||t.forward([x],100).then((function(t){return n.handleResult(t[0])}))}},{key:"handleResult",value:function(t){console.log("Got result",t),this.setState(Object(w.a)(Object(w.a)({},this.state),{},{showResult:!0}));var n=t.getShape(),e=(t=t.reshape(n.slice(1),!1)).transpose([1,2,0]);t.delete();var r=e.toTexture();e.delete(),r.getValues().then((function(t){var n=document.getElementById("canvas").getContext("2d");if(n){for(var e=n.createImageData(r.shape[0],r.shape[1]),o=e.data,i=0;i<t.length;i++)o[i]=Math.round(t[i]);n.putImageData(e,0,0)}r.delete()}))}},{key:"fileSelected",value:function(t){this.setState(Object(w.a)(Object(w.a)({},this.state),{},{scale:50,img:URL.createObjectURL(t.target.files[0]),showResult:!1}))}},{key:"getImageWidth",value:function(t){var n=Math.round(t/50*400+50);return 32*Math.floor(n/32)}},{key:"setModel",value:function(){var t=Object(v.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState(Object(w.a)(Object(w.a)({},this.state),{},{model:n})),t.next=3,Di(n);case 3:this.model=t.sent;case 4:case"end":return t.stop()}}),t,this)})));return function(n){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t,n=this,e=50,r=50,o=!1;this.state&&(t=this.state.img,e=this.state.scale||50,r=this.state.croppedSize,o=this.state.showResult);var i=this.getImageWidth(e);return Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)("h1",{children:"Style transfer"}),Object(c.jsx)("label",{htmlFor:"model",children:"Choose a style:"})," ",Object(c.jsx)("select",{id:"model",onChange:function(t){return n.setModel(t.target.value)},children:Ki.map((function(t){return Object(c.jsx)("option",{value:t,children:t},t)}))}),Object(c.jsx)("br",{}),Object(c.jsx)("label",{htmlFor:"file",children:"Choose an image:"})," ",Object(c.jsx)("input",{type:"file",id:"file",onChange:function(t){return n.fileSelected(t)}}),Object(c.jsx)("br",{}),void 0!==t?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"slidecontainer",children:["Scale: ",Object(c.jsx)("input",{type:"range",min:"1",max:"100",defaultValue:e,className:"slider",id:"myRange",onChange:function(t){return n.setState(Object(w.a)(Object(w.a)({},n.state),{},{showResult:!1,scale:parseInt(t.currentTarget.value)}))}})]}),Object(c.jsx)("img",{id:"img",src:this.state.img,alt:"Your upload",width:i}),Object(c.jsx)("br",{}),Object(c.jsx)("button",{onClick:function(){return n.getImageData()},children:"Run"}),Object(c.jsx)("br",{}),o?Object(c.jsx)("canvas",{id:"canvas",width:r,height:r}):Object(c.jsx)(c.Fragment,{})]}):Object(c.jsx)(c.Fragment,{})]})}}]),e}(f.a.Component),Ri=function(t){t&&t instanceof Function&&e.e(4).then(e.bind(null,47)).then((function(n){var e=n.getCLS,r=n.getFID,o=n.getFCP,i=n.getLCP,a=n.getTTFB;e(t),r(t),o(t),i(t),a(t)}))};h.a.render(Object(c.jsx)(f.a.StrictMode,{children:Object(c.jsx)(Ni,{})}),document.getElementById("root")),Ri()}},[[42,1,2]]]);
//# sourceMappingURL=main.26c72ec3.chunk.js.map